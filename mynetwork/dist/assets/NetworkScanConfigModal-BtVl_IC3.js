import{r as d,j as e}from"./index-D769t3SB.js";import{r as n}from"./vendor-charts-fy94SsLU.js";import{m as D,X as k,_ as F,a0 as U,R as C,al as I,a7 as T,aO as z,J as H}from"./vendor-icons-Wr2_Nvt-.js";const _=({isOpen:f,onClose:m})=>{var y,N,S,w;const[s,c]=n.useState({enabled:!1,fullScan:{enabled:!1,interval:1440,scanType:"full"},refresh:{enabled:!1,interval:10}}),[L,P]=n.useState({enabled:!1,interval:30,scanType:"quick"}),[X,R]=n.useState({enabled:!1,interval:15}),[i,o]=n.useState({defaultRange:"192.168.1.0/24",defaultScanType:"full",defaultAutoDetect:!1}),[A,h]=n.useState(!1),[b,u]=n.useState(!1),[q,p]=n.useState(!1),[$,j]=n.useState(!0);n.useEffect(()=>{f&&v()},[f]);const v=async()=>{h(!0);try{try{const g=await d.get("/api/network-scan/unified-config");g.success&&g.result&&(c(g.result),j(!0))}catch{j(!1)}const[a,l,r]=await Promise.all([d.get("/api/network-scan/config").catch(()=>({success:!1,result:null})),d.get("/api/network-scan/refresh-config").catch(()=>({success:!1,result:null})),d.get("/api/network-scan/default-config")]);a.success&&a.result&&P(a.result),l.success&&l.result&&R(l.result),r.success&&r.result&&o(r.result)}catch(a){console.error("Failed to fetch configs:",a)}finally{h(!1)}},[x,t]=n.useState(null),E=async()=>{var a;u(!0),t(null);try{const l={enabled:s.enabled,fullScan:s.fullScan?{enabled:s.enabled&&s.fullScan.enabled||!1,interval:s.fullScan.interval||1440,scanType:s.fullScan.scanType||"full"}:{enabled:!1,interval:1440,scanType:"full"},refresh:s.refresh?{enabled:s.enabled&&s.refresh.enabled||!1,interval:s.refresh.interval||10}:{enabled:!1,interval:10}};console.log("Saving unified config:",l);const r=await d.post("/api/network-scan/unified-config",l);r.success&&r.result?(console.log("Config saved successfully:",r.result),c(r.result),t({type:"success",text:"Configuration sauvegardée avec succès"}),await v(),setTimeout(()=>{t(null),m()},1500)):(console.error("Save failed:",r.error),t({type:"error",text:((a=r.error)==null?void 0:a.message)||"Erreur lors de la sauvegarde"}))}catch(l){console.error("Save unified config failed:",l),t({type:"error",text:"Erreur lors de la sauvegarde: "+(l.message||"Erreur inconnue")})}finally{u(!1)}},M=async()=>{var a;u(!0),t(null);try{const l=await d.post("/api/network-scan/default-config",i);l.success&&l.result?(o(l.result),t({type:"success",text:"Configuration par défaut sauvegardée"}),setTimeout(()=>t(null),3e3)):t({type:"error",text:((a=l.error)==null?void 0:a.message)||"Erreur lors de la sauvegarde"})}catch(l){console.error("Save default config failed:",l),t({type:"error",text:"Erreur lors de la sauvegarde: "+(l.message||"Erreur inconnue")})}finally{u(!1)}};return f?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:[e.jsxs("div",{className:"bg-[#121212] border border-gray-700 rounded-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:e.jsx(D,{size:24,className:"text-purple-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Configuration Scan Réseau"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Paramètres des scans automatiques"})]})]}),e.jsx("button",{onClick:m,className:"text-gray-400 hover:text-white transition-colors p-2 hover:bg-gray-800 rounded-lg",children:e.jsx(k,{size:20})})]}),e.jsxs("div",{className:"p-6",children:[x&&e.jsxs("div",{className:`mb-4 px-4 py-3 rounded-lg border-2 flex items-center gap-3 ${x.type==="success"?"border-green-600 bg-green-900/40 text-green-100":"border-red-600 bg-red-900/40 text-red-100"}`,children:[x.type==="success"?e.jsx(F,{size:18,className:"text-green-400 flex-shrink-0"}):e.jsx(U,{size:18,className:"text-red-400 flex-shrink-0"}),e.jsx("div",{className:"flex-1 text-sm",children:x.text})]}),A?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(C,{size:32,className:"text-gray-400 animate-spin"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-purple-500/5 border border-purple-500/20 rounded-lg p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:e.jsx(I,{size:18,className:"text-purple-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold text-white",children:"Scan automatique"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Activez les scans automatiques du réseau"})]})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.enabled,onChange:a=>{const l=a.target.checked;c({...s,enabled:l,fullScan:s.fullScan||{enabled:!1,interval:1440,scanType:"full"},refresh:s.refresh||{enabled:!1,interval:10}})},className:"w-5 h-5 rounded border-gray-600 bg-[#1a1a1a] text-purple-500 focus:ring-purple-500 focus:ring-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-300",children:s.enabled?"Activé":"Désactivé"})]})]}),s.enabled&&e.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-800",children:[e.jsxs("div",{className:"bg-green-500/5 border border-green-500/20 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{size:14,className:"text-green-400"}),e.jsx("h4",{className:"text-sm font-semibold text-gray-300",children:"Full Scan"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:((y=s.fullScan)==null?void 0:y.enabled)??!1,onChange:a=>{var l,r;return c({...s,fullScan:{...s.fullScan,enabled:a.target.checked,interval:((l=s.fullScan)==null?void 0:l.interval)??1440,scanType:((r=s.fullScan)==null?void 0:r.scanType)??"full"}})},className:"w-4 h-4"}),e.jsx("span",{className:"text-xs text-gray-400",children:"Activer"})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Découvre de nouvelles IPs sur le réseau (scan complet de la plage choisie)"}),((N=s.fullScan)==null?void 0:N.enabled)&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1.5",children:"Intervalle"}),e.jsxs("select",{value:s.fullScan.interval,onChange:a=>c({...s,fullScan:{...s.fullScan,interval:parseInt(a.target.value)}}),className:"w-full px-3 py-2 text-sm bg-[#1a1a1a] border border-gray-700 rounded-lg text-gray-200 focus:outline-none focus:border-green-500",children:[e.jsx("option",{value:"15",children:"15 minutes"}),e.jsx("option",{value:"30",children:"30 minutes"}),e.jsx("option",{value:"60",children:"1 heure"}),e.jsx("option",{value:"120",children:"2 heures"}),e.jsx("option",{value:"360",children:"6 heures"}),e.jsx("option",{value:"720",children:"12 heures"}),e.jsx("option",{value:"1440",children:"24 heures (1 fois par jour)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1.5",children:"Type de scan"}),e.jsxs("select",{value:s.fullScan.scanType,onChange:a=>c({...s,fullScan:{...s.fullScan,scanType:a.target.value}}),className:"w-full px-3 py-2 text-sm bg-[#1a1a1a] border border-gray-700 rounded-lg text-gray-200 focus:outline-none focus:border-green-500",children:[e.jsx("option",{value:"quick",children:"Rapide (ping uniquement)"}),e.jsx("option",{value:"full",children:"Complet (ping + MAC + hostname)"})]})]})]})]}),e.jsxs("div",{className:"bg-blue-500/5 border border-blue-500/20 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{size:14,className:"text-blue-400"}),e.jsx("h4",{className:"text-sm font-semibold text-gray-300",children:"Rafraîchissement"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:((S=s.refresh)==null?void 0:S.enabled)??!1,onChange:a=>{var l;return c({...s,refresh:{...s.refresh,enabled:a.target.checked,interval:((l=s.refresh)==null?void 0:l.interval)??10}})},className:"w-4 h-4"}),e.jsx("span",{className:"text-xs text-gray-400",children:"Activer"})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Met à jour uniquement les IPs déjà connues (plus rapide, ne découvre pas de nouvelles IPs)"}),((w=s.refresh)==null?void 0:w.enabled)&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1.5",children:"Intervalle"}),e.jsxs("select",{value:s.refresh.interval,onChange:a=>c({...s,refresh:{...s.refresh,interval:parseInt(a.target.value)}}),className:"w-full px-3 py-2 text-sm bg-[#1a1a1a] border border-gray-700 rounded-lg text-gray-200 focus:outline-none focus:border-blue-500",children:[e.jsx("option",{value:"5",children:"5 minutes"}),e.jsx("option",{value:"10",children:"10 minutes"}),e.jsx("option",{value:"15",children:"15 minutes"}),e.jsx("option",{value:"30",children:"30 minutes"}),e.jsx("option",{value:"60",children:"1 heure"})]})]})]})]}),e.jsxs("button",{onClick:E,disabled:b,className:`w-full px-4 py-3 bg-purple-500/10 hover:bg-purple-500/20 text-purple-400 rounded-lg border border-purple-500/30 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 font-medium transition-colors ${s.enabled?"":"mt-4"}`,children:[e.jsx(T,{size:18}),"Sauvegarder la configuration"]})]})}),e.jsxs("div",{className:"mt-6 bg-blue-500/5 border border-blue-500/20 rounded-lg p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-300 flex items-center gap-2 mb-4",children:[e.jsx(z,{size:14,className:"text-blue-400"}),e.jsx("span",{children:"Configuration par défaut du scan"})]}),e.jsx("p",{className:"text-xs text-gray-500 mb-4",children:"Paramètres par défaut utilisés lors des scans manuels depuis la page de scan"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i.defaultAutoDetect,onChange:a=>o({...i,defaultAutoDetect:a.target.checked}),className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Auto-détection "})]})}),!i.defaultAutoDetect&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("label",{className:"block text-sm text-gray-400",children:"Plage IP par défaut"}),e.jsx("button",{onClick:()=>p(!0),className:"p-1 hover:bg-blue-500/10 text-blue-400 rounded-lg transition-colors",title:"Aide réseau",children:e.jsx(H,{size:14})})]}),e.jsx("input",{type:"text",value:i.defaultRange,onChange:a=>o({...i,defaultRange:a.target.value}),placeholder:"192.168.1.0/24",className:"w-full px-4 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-gray-200 focus:outline-none focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Type de scan par défaut"}),e.jsxs("select",{value:i.defaultScanType,onChange:a=>o({...i,defaultScanType:a.target.value}),className:"w-full px-4 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-gray-200 focus:outline-none focus:border-blue-500",children:[e.jsx("option",{value:"quick",children:"Rapide (ping uniquement)"}),e.jsx("option",{value:"full",children:"Complet (ping + MAC + hostname)"})]})]}),e.jsxs("button",{onClick:M,disabled:b,className:"w-full px-4 py-2 bg-blue-500/10 hover:bg-blue-500/20 text-blue-400 rounded-lg border border-blue-500/30 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsx(T,{size:16}),"Sauvegarder"]})]})]})]})]}),e.jsx("div",{className:"flex justify-end p-6 border-t border-gray-800",children:e.jsx("button",{onClick:m,className:"px-4 py-2 bg-gray-500/10 hover:bg-gray-500/20 text-gray-400 rounded-lg border border-gray-500/30 transition-colors",children:"Fermer"})})]}),q&&e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-[#121212] border border-gray-700 rounded-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:e.jsx(z,{size:24,className:"text-purple-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Aide - Format de plage réseau"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Comment spécifier une plage d'IPs à scanner"})]})]}),e.jsx("button",{onClick:()=>p(!1),className:"text-gray-400 hover:text-white transition-colors p-2 hover:bg-gray-800 rounded-lg",children:e.jsx(k,{size:20})})]}),e.jsx("div",{className:"p-6 space-y-4",children:e.jsxs("div",{className:"bg-purple-500/10 border border-purple-500/30 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-purple-400 mb-3",children:"Format de plage réseau"}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-300",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-purple-300 mb-1",children:"Notation CIDR (recommandé) :"}),e.jsx("code",{className:"block bg-[#1a1a1a] px-3 py-2 rounded text-emerald-400 font-mono text-xs my-2",children:"192.168.1.0/24"}),e.jsx("p",{className:"text-gray-400 text-xs",children:"Scanne les IPs de 192.168.1.1 à 192.168.1.254 (254 IPs)"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-purple-300 mb-1",children:"Notation par plage :"}),e.jsx("code",{className:"block bg-[#1a1a1a] px-3 py-2 rounded text-emerald-400 font-mono text-xs my-2",children:"192.168.1.1-254"}),e.jsx("p",{className:"text-gray-400 text-xs",children:"Scanne les IPs de 192.168.1.1 à 192.168.1.254"})]}),e.jsxs("div",{className:"bg-[#1a1a1a] rounded p-3 mt-3",children:[e.jsx("p",{className:"font-semibold text-yellow-400 mb-2 text-xs",children:"Masques réseau courants :"}),e.jsxs("ul",{className:"space-y-1 text-xs text-gray-400",children:[e.jsxs("li",{children:[e.jsx("code",{className:"text-emerald-400",children:"/24"})," = 254 IPs (192.168.1.1-254) - Réseau local standard"]}),e.jsxs("li",{children:[e.jsx("code",{className:"text-emerald-400",children:"/25"})," = 126 IPs (192.168.1.1-192.168.1.126)"]}),e.jsxs("li",{children:[e.jsx("code",{className:"text-emerald-400",children:"/26"})," = 62 IPs (192.168.1.1-192.168.1.62)"]}),e.jsxs("li",{children:[e.jsx("code",{className:"text-red-400",children:"/16"})," = 65534 IPs - Trop large, non supporté"]})]})]})]})]})}),e.jsx("div",{className:"flex justify-end p-6 border-t border-gray-800",children:e.jsx("button",{onClick:()=>p(!1),className:"px-4 py-2 bg-gray-500/10 hover:bg-gray-500/20 text-gray-400 rounded-lg border border-gray-500/30 transition-colors",children:"Fermer"})})]})})]}):null};export{_ as N};
