import{j as e,d as Es,e as it,b as ct,u as ot}from"./index-D769t3SB.js";import{r as l,R as dt}from"./vendor-charts-fy94SsLU.js";import{P as Fs}from"./PermissionBanner-DQzGv1X1.js";import{X as Le,a2 as X,Y as _e,a0 as xt,_ as mt,p as Ee,C as ut,ai as Ps,R as pe,G as ht,A as pt,d as Be,a8 as re,aq as rs,ar as gt,b as bt,ag as Bs,as as jt,at as Rs,au as Ls,av as _s,aw as ls,l as Is,af as ft,j as ae,H as ss,D as ge,ax as G,g as ts,I as yt,c as Nt,ah as vt,ay as wt,az as Re,q as O,aA as je,aB as fe,O as Ts,z as Ct,B as zt,aC as Ds,aD as Ms,aE as As,aF as kt,al as St,aG as Ft}from"./vendor-icons-Wr2_Nvt-.js";import"./vendor-D9iDNHsv.js";import"./vendor-state-CiM9n9np.js";const Pt=({toast:t,onClose:i})=>{const[m,o]=l.useState(!1),[d,A]=l.useState(100),w=t.duration||3e3;l.useEffect(()=>{const n=setTimeout(()=>o(!0),10);return()=>clearTimeout(n)},[]),l.useEffect(()=>{if(t.type!=="loading"&&t.duration!==0){const n=setTimeout(()=>{i(t.id)},w),j=Date.now(),F=setInterval(()=>{const D=Date.now()-j,z=Math.max(0,100-D/w*100);A(z),z<=0&&clearInterval(F)},50);return()=>{clearTimeout(n),clearInterval(F)}}},[t.id,t.type,t.duration,w,i]);const C={success:e.jsx(mt,{size:18,className:"text-emerald-400"}),error:e.jsx(xt,{size:18,className:"text-red-400"}),warning:e.jsx(_e,{size:18,className:"text-amber-400"}),loading:e.jsx(X,{size:18,className:"text-blue-400 animate-spin"})},S={success:"bg-emerald-900/30 border-emerald-700/50",error:"bg-red-900/30 border-red-700/50",warning:"bg-amber-900/30 border-amber-700/50",loading:"bg-blue-900/30 border-blue-700/50"},v={success:"bg-emerald-500",error:"bg-red-500",warning:"bg-amber-500",loading:"bg-blue-500"};return e.jsxs("div",{className:`flex flex-col rounded-lg border ${S[t.type]} backdrop-blur-sm shadow-lg transition-all duration-300 overflow-hidden`,style:{transform:m?"translateX(0)":"translateX(100%)",opacity:m?1:0},children:[e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[C[t.type],e.jsx("span",{className:"text-sm text-white flex-1",children:t.message}),t.type!=="loading"&&e.jsx("button",{onClick:()=>i(t.id),className:"p-1 hover:bg-white/10 rounded transition-colors",children:e.jsx(Le,{size:14,className:"text-gray-400"})})]}),t.type==="loading"&&t.progress!==void 0?e.jsx("div",{className:"w-full h-1 bg-gray-700/50",children:e.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:`${t.progress}%`}})}):t.type!=="loading"&&e.jsx("div",{className:"w-full h-0.5 bg-gray-700/30",children:e.jsx("div",{className:`h-full ${v[t.type]} transition-none`,style:{width:`${d}%`}})})]})},Tt=({toasts:t,onClose:i})=>t.length===0?null:e.jsx("div",{className:"fixed bottom-20 right-4 z-[100] flex flex-col gap-2 max-w-sm",children:t.map(m=>e.jsx(Pt,{toast:m,onClose:i},m.id))}),be=t=>{if(t==null||t===0||isNaN(t)||t<0)return"0 B";const i=1024,m=["B","KB","MB","GB","TB"],o=Math.floor(Math.log(t)/Math.log(i));return o<0||o>=m.length?"0 B":parseFloat((t/Math.pow(i,o)).toFixed(2))+" "+m[o]},$s=t=>be(t)+"/s",Dt=t=>t.startsWith("image/")?Rs:t.startsWith("video/")?Ls:t.startsWith("audio/")?_s:t.includes("zip")||t.includes("rar")||t.includes("tar")||t.includes("7z")?ls:t.startsWith("text/")||t.includes("document")?Is:rs,Mt=({task:t,onClose:i})=>{const{getTrackers:m,getPeers:o,getFiles:d,updateFilePriority:A,getPieces:w,getBlacklist:C,emptyBlacklist:S,getLog:v}=Es(),[n,j]=l.useState("files"),[F,D]=l.useState(!1),[z,$]=l.useState([]),[P,N]=l.useState([]),[h,Ie]=l.useState([]),[le,ye]=l.useState(""),[B,Ue]=l.useState([]),[Ne,ne]=l.useState(""),k=l.useCallback(async a=>{D(!0);try{switch(a){case"files":const b=await d(t.id);$(b);break;case"trackers":const E=await m(t.id);N(E);break;case"peers":const W=await o(t.id);Ie(W);break;case"pieces":const f=await w(t.id);ye(f);break;case"blacklist":const q=await C(t.id);Ue(q);break;case"log":const L=await v(t.id);ne(L);break}}catch(b){console.error("Error loading data:",b)}D(!1)},[t.id,d,m,o,w,C,v]);l.useEffect(()=>{k(n)},[n,k]),l.useEffect(()=>{if(n==="peers"||n==="trackers"){const a=setInterval(()=>k(n),5e3);return()=>clearInterval(a)}},[n,k]);const We=async(a,b)=>{await A(t.id,a,b)&&k("files")},R=async()=>{confirm("Vider la blacklist ?")&&await S(t.id)&&k("blacklist")},Q=a=>{switch(a){case"announced":return"text-emerald-400";case"announcing":return"text-blue-400";case"announce_failed":return"text-red-400";default:return"text-gray-400"}},qe=a=>{switch(a){case"ready":return"text-emerald-400";case"handshaking":case"connecting":return"text-blue-400";default:return"text-gray-400"}},He=a=>({not_blacklisted:"Non blacklisté",crypto_not_supported:"Crypto non supporté",connect_fail:"Échec de connexion",hs_timeout:"Timeout handshake",hs_failed:"Échec handshake",hs_crypt_failed:"Échec crypto handshake",hs_crypto_disabled:"Crypto désactivé",torrent_not_found:"Torrent non trouvé",read_failed:"Échec lecture",write_failed:"Échec écriture",crap_received:"Données invalides",conn_closed:"Connexion fermée",timeout:"Timeout",blocklist:"Dans la blocklist",user:"Manuel"})[a]||a,Ke=()=>{if(!le)return null;const a=le.split(""),b=a.length,E=a.filter(f=>f==="X").length,W=a.filter(f=>f==="+"||f==="/").length;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:[E," / ",b," pièces (",Math.round(E/b*100),"%)"]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 bg-emerald-500 rounded-sm"}),"Complet"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 bg-blue-500 rounded-sm"}),"En cours (",W,")"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 bg-gray-600 rounded-sm"}),"En attente"]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-0.5 p-2 bg-[#0a0a0a] rounded-lg max-h-64 overflow-y-auto",children:a.map((f,q)=>{let L="bg-gray-700";return f==="X"?L="bg-emerald-500":f==="+"||f==="/"?L="bg-blue-500":f==="U"?L="bg-purple-500":f==="-"&&(L="bg-gray-800"),e.jsx("div",{className:`w-2 h-2 ${L} rounded-[1px]`,title:`Pièce ${q+1}: ${f==="X"?"Complète":f==="+"?"En téléchargement":f==="/"?"Prioritaire":f==="."?"En attente":"Non demandée"}`},q)})})]})},ve=[{key:"files",label:"Fichiers",icon:e.jsx(rs,{size:14})},{key:"log",label:"Journal",icon:e.jsx(gt,{size:14})},{key:"trackers",label:"Traqueurs",icon:e.jsx(Ps,{size:14})},{key:"peers",label:"Pairs",icon:e.jsx(bt,{size:14})},{key:"pieces",label:"Pièces",icon:e.jsx(Bs,{size:14})},{key:"blacklist",label:"Blacklist",icon:e.jsx(jt,{size:14})}];return e.jsxs("div",{className:"bg-[#121212] rounded-xl border border-gray-800 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-800",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-sm font-medium text-white truncate",children:t.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[be(t.downloaded)," / ",be(t.size)," (",t.progress,"%)"]})]}),e.jsx("button",{onClick:i,className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded-lg transition-colors",children:e.jsx(Le,{size:16})})]}),e.jsx("div",{className:"flex items-center gap-1 px-2 py-1 border-b border-gray-800 overflow-x-auto",children:ve.map(a=>e.jsxs("button",{onClick:()=>j(a.key),className:`flex items-center gap-1.5 px-3 py-2 text-xs font-medium rounded-lg transition-colors whitespace-nowrap ${n===a.key?"bg-blue-600 text-white":"text-gray-400 hover:text-white hover:bg-gray-800"}`,children:[a.icon,a.label]},a.key))}),e.jsx("div",{className:"p-4 max-h-96 overflow-y-auto",children:F?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(X,{size:24,className:"text-blue-400 animate-spin"})}):e.jsxs(e.Fragment,{children:[n==="files"&&e.jsx("div",{className:"space-y-2",children:z.length>0?z.map(a=>{const b=Dt(a.mimetype),E=a.size>0?Math.round(a.rx/a.size*100):0;return e.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(b,{size:16,className:"text-gray-400 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-white truncate",children:a.name}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsxs("span",{children:[be(a.rx)," / ",be(a.size)]}),a.status==="done"&&e.jsxs("span",{className:"text-emerald-400 flex items-center gap-1",children:[e.jsx(Ee,{size:10})," Terminé"]}),a.status==="error"&&e.jsxs("span",{className:"text-red-400 flex items-center gap-1",children:[e.jsx(_e,{size:10})," Erreur"]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:a.priority,onChange:W=>We(a.id,W.target.value),className:"appearance-none bg-[#0a0a0a] border border-gray-700 rounded px-2 py-1 pr-6 text-xs text-gray-300 focus:outline-none focus:outline-none",children:[e.jsx("option",{value:"no_dl",children:"Ne pas télécharger"}),e.jsx("option",{value:"low",children:"Basse"}),e.jsx("option",{value:"normal",children:"Normale"}),e.jsx("option",{value:"high",children:"Haute"})]}),e.jsx(ut,{size:12,className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none"})]})]}),a.priority!=="no_dl"&&a.status!=="done"&&e.jsx("div",{className:"mt-2 h-1 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 transition-all",style:{width:`${E}%`}})})]},a.id)}):e.jsx("p",{className:"text-center text-gray-500 py-4",children:"Aucun fichier"})}),n==="log"&&e.jsx("div",{className:"bg-[#0a0a0a] rounded-lg p-3",children:Ne?e.jsx("pre",{className:"text-xs text-gray-300 font-mono whitespace-pre-wrap break-words max-h-64 overflow-y-auto",children:Ne}):e.jsx("p",{className:"text-center text-gray-500 py-4",children:"Aucun log disponible"})}),n==="trackers"&&e.jsx("div",{className:"space-y-2",children:P.length>0?P.map((a,b)=>e.jsx("div",{className:"bg-[#1a1a1a] rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ps,{size:14,className:Q(a.status)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs text-white font-mono truncate",children:a.announce}),e.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-500",children:[e.jsx("span",{className:Q(a.status),children:a.status==="announced"?"Annoncé":a.status==="announcing"?"Annonce...":a.status==="announce_failed"?"Échec":"Non annoncé"}),e.jsxs("span",{children:["Seeds: ",a.nseeders]}),e.jsxs("span",{children:["Leechers: ",a.nleechers]}),a.reannounce_in>0&&e.jsxs("span",{children:["Réannonce dans ",Math.floor(a.reannounce_in/60),"min"]})]})]}),!a.is_enabled&&e.jsx("span",{className:"text-xs text-gray-500",children:"Désactivé"}),a.is_backup&&e.jsx("span",{className:"text-xs text-amber-400",children:"Backup"})]})},b)):e.jsx("p",{className:"text-center text-gray-500 py-4",children:"Aucun traqueur"})}),n==="peers"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-xs text-gray-400",children:[h.length," pair(s) connecté(s)"]}),e.jsx("button",{onClick:()=>k("peers"),className:"p-1 text-gray-400 hover:text-white transition-colors",children:e.jsx(pe,{size:14})})]}),h.length>0?h.map((a,b)=>e.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ht,{size:12,className:"text-gray-500"}),e.jsx("span",{className:"text-xs text-gray-400",children:a.country_code})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-xs text-white font-mono",children:[a.host,":",a.port]}),e.jsx("p",{className:"text-xs text-gray-500",children:a.client})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsxs("span",{className:"text-emerald-400 flex items-center gap-1",children:[e.jsx(pt,{size:10}),$s(a.rx_rate)]}),e.jsxs("span",{className:"text-blue-400 flex items-center gap-1",children:[e.jsx(Be,{size:10}),$s(a.tx_rate)]})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[a.progress,"%"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs text-gray-500",children:[e.jsx("span",{className:qe(a.state),children:a.state==="ready"?"Connecté":a.state==="handshaking"?"Handshake...":a.state==="connecting"?"Connexion...":"Déconnecté"}),e.jsxs("span",{children:["via ",a.origin]}),e.jsx("span",{children:a.protocol})]})]},b)):e.jsx("p",{className:"text-center text-gray-500 py-4",children:"Aucun pair connecté"})]}),n==="pieces"&&(le?Ke():e.jsx("p",{className:"text-center text-gray-500 py-4",children:"Aucune information sur les pièces"})),n==="blacklist"&&e.jsxs("div",{className:"space-y-2",children:[B.length>0&&e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-xs text-gray-400",children:[B.length," entrée(s)"]}),e.jsxs("button",{onClick:R,className:"flex items-center gap-1 px-2 py-1 text-xs text-red-400 hover:bg-red-900/20 rounded transition-colors",children:[e.jsx(re,{size:12}),"Vider"]})]}),B.length>0?B.map((a,b)=>e.jsx("div",{className:"bg-[#1a1a1a] rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-white font-mono",children:a.host}),e.jsx("p",{className:"text-xs text-gray-500",children:He(a.reason)})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-xs text-gray-400",children:["Expire dans ",Math.floor(a.expire/60),"min"]}),a.global&&e.jsx("span",{className:"text-xs text-amber-400",children:"Global"})]})]})},b)):e.jsx("p",{className:"text-center text-gray-500 py-4",children:"Blacklist vide"})]})]})})]})},At=t=>{switch(t){case"ultra":return"Freebox Ultra";case"delta":return"Freebox Delta";case"pop":return"Freebox Pop";case"revolution":return"Freebox Revolution";default:return"Freebox"}},H=t=>{if(t==null||t===0||isNaN(t)||t<0)return"0 B";const i=1024,m=["B","KB","MB","GB","TB"],o=Math.floor(Math.log(t)/Math.log(i));return o<0||o>=m.length?"0 B":parseFloat((t/Math.pow(i,o)).toFixed(2))+" "+m[o]},as=t=>new Date(t*1e3).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),te=t=>{try{return decodeURIComponent(escape(atob(t)))}catch{return t}},$t=t=>{if(t.type==="dir")return ae;const i=t.mimetype||"";return i.startsWith("image/")?Rs:i.startsWith("video/")?Ls:i.startsWith("audio/")?_s:i.includes("zip")||i.includes("rar")||i.includes("tar")||i.includes("7z")?ls:i.startsWith("text/")||i.includes("document")?Is:rs},Et=t=>{if(t.type==="dir")return"text-yellow-400";const i=t.mimetype||"";return i.startsWith("image/")?"text-pink-400":i.startsWith("video/")?"text-purple-400":i.startsWith("audio/")?"text-cyan-400":i.includes("zip")||i.includes("rar")?"text-orange-400":"text-gray-400"},Bt=({file:t,isSelected:i,isShared:m,isRootFolder:o,isParentDir:d,viewMode:A,onSelect:w,onOpen:C,onContextMenu:S,onRename:v,onCopy:n,onMove:j,onShare:F,onDelete:D})=>{const z=$t(t),$=Et(t),[P,N]=l.useState(!1);return A==="grid"?e.jsxs("div",{className:`relative p-4 rounded-xl border transition-all cursor-pointer group ${i?"bg-blue-900/30 border-blue-600":"bg-[#1a1a1a] border-transparent hover:border-gray-700 hover:bg-[#202020]"}`,onClick:h=>{(h.ctrlKey||h.metaKey)&&!d?w():C()},onContextMenu:d?void 0:S,children:[!d&&e.jsx("button",{className:`absolute top-2 left-2 p-1 rounded transition-opacity ${i?"opacity-100":"opacity-0 group-hover:opacity-100"}`,onClick:h=>{h.stopPropagation(),w()},children:i?e.jsx(Ds,{size:16,className:"text-blue-400"}):e.jsx(Ms,{size:16,className:"text-gray-500"})}),!d&&e.jsxs("div",{className:"absolute top-2 right-2",children:[e.jsx("button",{className:`p-1 rounded transition-opacity hover:bg-white/10 ${P?"opacity-100":"opacity-0 group-hover:opacity-100"}`,onClick:h=>{h.stopPropagation(),N(!P)},children:e.jsx(As,{size:16,className:"text-gray-400"})}),P&&e.jsxs("div",{className:"absolute right-0 top-8 bg-[#1a1a1a] border border-gray-700 rounded-lg shadow-xl py-1 min-w-[160px] z-50",onClick:h=>h.stopPropagation(),children:[e.jsxs("button",{onClick:()=>{o||(v(),N(!1))},disabled:o,className:`w-full px-3 py-2 text-left text-sm flex items-center gap-2 ${o?"text-gray-600 cursor-not-allowed":"text-gray-300 hover:bg-gray-800"}`,children:[e.jsx(Re,{size:14})," Renommer"]}),e.jsxs("button",{onClick:()=>{n(),N(!1)},className:"w-full px-3 py-2 text-left text-sm text-gray-300 hover:bg-gray-800 flex items-center gap-2",children:[e.jsx(O,{size:14})," Copier"]}),e.jsxs("button",{onClick:()=>{j(),N(!1)},className:"w-full px-3 py-2 text-left text-sm text-gray-300 hover:bg-gray-800 flex items-center gap-2",children:[e.jsx(je,{size:14})," Déplacer"]}),e.jsxs("button",{onClick:()=>{F(),N(!1)},className:"w-full px-3 py-2 text-left text-sm text-purple-400 hover:bg-gray-800 flex items-center gap-2",children:[e.jsx(fe,{size:14})," Partager"]}),e.jsx("div",{className:"border-t border-gray-700 my-1"}),e.jsxs("button",{onClick:()=>{D(),N(!1)},className:"w-full px-3 py-2 text-left text-sm text-red-400 hover:bg-gray-800 flex items-center gap-2",children:[e.jsx(re,{size:14})," Supprimer"]})]})]}),m&&!d&&e.jsx("div",{className:"absolute top-2 right-8 p-1",title:"Partagé",children:e.jsx(G,{size:14,className:"text-purple-400"})}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"relative",children:e.jsx(z,{size:40,className:$})}),e.jsx("span",{className:"text-sm text-center text-white truncate w-full",title:t.name,children:t.name}),t.type!=="dir"&&e.jsx("span",{className:"text-xs text-gray-500",children:H(t.size)})]})]}):e.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg transition-all cursor-pointer group ${i?"bg-blue-900/30":"hover:bg-[#1a1a1a]"}`,onClick:h=>{(h.ctrlKey||h.metaKey)&&!d?w():C()},onContextMenu:d?void 0:S,children:[d?e.jsx("div",{className:"w-6"}):e.jsx("button",{className:`p-1 rounded transition-opacity ${i?"opacity-100":"opacity-0 group-hover:opacity-100"}`,onClick:h=>{h.stopPropagation(),w()},children:i?e.jsx(Ds,{size:16,className:"text-blue-400"}):e.jsx(Ms,{size:16,className:"text-gray-500"})}),e.jsxs("div",{className:"relative",children:[e.jsx(z,{size:20,className:$}),m&&!d&&e.jsx("div",{className:"absolute -top-1 -right-1 bg-purple-500 rounded-full p-0.5",title:"Partagé",children:e.jsx(G,{size:8,className:"text-white"})})]}),e.jsx("span",{className:"flex-1 text-sm text-white truncate",title:t.name,children:t.name}),m&&!d&&e.jsx("span",{className:"text-xs text-purple-400 hidden sm:block",children:"Partagé"}),!d&&e.jsx("span",{className:"text-xs text-gray-500 w-24 text-right",children:t.type==="dir"?`${t.filecount||0} fichiers`:H(t.size)}),!d&&e.jsx("span",{className:"text-xs text-gray-500 w-32 text-right hidden md:block",children:as(t.modification)}),d?e.jsx("div",{className:"w-6"}):e.jsxs("div",{className:"relative",children:[e.jsx("button",{className:`p-1 rounded transition-opacity hover:bg-white/10 ${P?"opacity-100":"opacity-0 group-hover:opacity-100"}`,onClick:h=>{h.stopPropagation(),N(!P)},children:e.jsx(As,{size:16,className:"text-gray-400"})}),P&&e.jsxs("div",{className:"absolute right-0 top-8 bg-[#1a1a1a] border border-gray-700 rounded-lg shadow-xl py-1 min-w-[160px] z-50",onClick:h=>h.stopPropagation(),children:[e.jsxs("button",{onClick:()=>{o||(v(),N(!1))},disabled:o,className:`w-full px-3 py-2 text-left text-sm flex items-center gap-2 ${o?"text-gray-600 cursor-not-allowed":"text-gray-300 hover:bg-gray-800"}`,children:[e.jsx(Re,{size:14})," Renommer"]}),e.jsxs("button",{onClick:()=>{n(),N(!1)},className:"w-full px-3 py-2 text-left text-sm text-gray-300 hover:bg-gray-800 flex items-center gap-2",children:[e.jsx(O,{size:14})," Copier"]}),e.jsxs("button",{onClick:()=>{j(),N(!1)},className:"w-full px-3 py-2 text-left text-sm text-gray-300 hover:bg-gray-800 flex items-center gap-2",children:[e.jsx(je,{size:14})," Déplacer"]}),e.jsxs("button",{onClick:()=>{F(),N(!1)},className:"w-full px-3 py-2 text-left text-sm text-purple-400 hover:bg-gray-800 flex items-center gap-2",children:[e.jsx(fe,{size:14})," Partager"]}),e.jsx("div",{className:"border-t border-gray-700 my-1"}),e.jsxs("button",{onClick:()=>{D(),N(!1)},className:"w-full px-3 py-2 text-left text-sm text-red-400 hover:bg-gray-800 flex items-center gap-2",children:[e.jsx(re,{size:14})," Supprimer"]})]})]})]})},Rt=({task:t,isSelected:i,onSelect:m,onPause:o,onResume:d,onRetry:A,onDelete:w})=>{const C=t.status==="downloading"||t.status==="seeding",S=t.status==="paused",v=t.status==="done",n=t.status==="error",j=t.status==="queued",F=()=>v?"bg-emerald-500/20":n?"bg-red-500/20":S||j?"bg-gray-500/20":"bg-blue-500/20",D=()=>v?"text-emerald-400":n?"text-red-400":S||j?"text-gray-400":"text-blue-400",z=()=>v?"bg-emerald-500":n?"bg-red-500":"bg-blue-500",$=()=>n?e.jsx("span",{className:"text-red-400",children:"Erreur"}):j?e.jsx("span",{className:"text-gray-400",children:"En attente"}):S?e.jsx("span",{className:"text-gray-400",children:"En pause"}):v?e.jsx("span",{className:"text-emerald-400",children:"Terminé"}):t.status==="seeding"?e.jsx("span",{className:"text-purple-400",children:"Seeding"}):null;return e.jsxs("div",{className:`rounded-lg p-3 cursor-pointer transition-all ${i?"bg-blue-900/30 border border-blue-600":"bg-[#1a1a1a] border border-transparent hover:border-gray-700"}`,onClick:m,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${F()}`,children:n?e.jsx(_e,{size:16,className:D()}):e.jsx(ge,{size:16,className:D()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm text-white truncate",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsxs("span",{children:[H(t.downloaded)," / ",H(t.size)]}),C&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"-"}),e.jsxs("span",{className:"text-blue-400",children:[H(t.downloadSpeed),"/s"]})]}),t.eta&&t.eta>0&&C&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"-"}),e.jsxs("span",{children:[Math.floor(t.eta/60),"min restantes"]})]}),$()&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"-"}),$()]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",onClick:P=>P.stopPropagation(),children:[C&&e.jsx("button",{onClick:o,className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg transition-colors",title:"Pause",children:e.jsx(kt,{size:16})}),(S||j)&&e.jsx("button",{onClick:d,className:"p-2 text-gray-400 hover:text-emerald-400 hover:bg-emerald-900/20 rounded-lg transition-colors",title:"Reprendre",children:e.jsx(St,{size:16})}),n&&e.jsx("button",{onClick:A,className:"p-2 text-gray-400 hover:text-amber-400 hover:bg-amber-900/20 rounded-lg transition-colors",title:"Réessayer",children:e.jsx(Ft,{size:16})}),e.jsx("button",{onClick:w,className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-900/20 rounded-lg transition-colors",title:"Supprimer",children:e.jsx(Le,{size:16})})]})]}),!v&&e.jsx("div",{className:"mt-2",children:e.jsx("div",{className:"h-1.5 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${z()}`,style:{width:`${t.progress}%`}})})})]})},Ht=({onBack:t,initialTab:i,initialDownloadId:m})=>{const{files:o,currentPath:d,disks:A,isLoading:w,isLoadingMore:C,hasMore:S,error:v,selectedFiles:n,shareLinks:j,listFiles:F,loadMore:D,navigateTo:z,navigateUp:$,createDirectory:P,deleteFiles:N,copyFiles:h,moveFiles:Ie,rename:le,fetchDisks:ye,fetchShareLinks:B,createShareLink:Ue,deleteShareLink:Ne,toggleSelectFile:ne,clearSelection:k,selectAll:We}=it(),{tasks:R,fetchDownloads:Q,addDownload:qe,addDownloadFromFile:He,pauseDownload:Ke,resumeDownload:ve,deleteDownload:a}=Es(),{permissions:b,freeboxUrl:E}=ct(),W=b.explorer===!0,f=b.downloader===!0,{info:q}=ot(),L=At((q==null?void 0:q.board_name)||""),[J,Ve]=l.useState(i||"files"),[ie,Us]=l.useState("list"),[Xe,Ws]=l.useState(""),[qs,Ge]=l.useState(!1),[ce,Oe]=l.useState(""),[Hs,we]=l.useState(!1),[Y,Ce]=l.useState(null),[Z,oe]=l.useState(""),[Ks,Qe]=l.useState(!1),[Vs,Je]=l.useState(!1),[ze,ee]=l.useState(""),[y,Ye]=l.useState("/"),[ke,ns]=l.useState([]),[is,cs]=l.useState(!1),[Xs,Se]=l.useState(!1),[de,Fe]=l.useState(null),[os,Gs]=l.useState(7),[xe,me]=l.useState(null),[Ze,Pe]=l.useState(!1),[M,K]=l.useState(null),[Os,Te]=l.useState(!1),[ue,De]=l.useState(""),[_,he]=l.useState(null),[ds,xs]=l.useState(!1),[T,Me]=l.useState(null),[Qs,ms]=l.useState([]),u=(s,r,c,x)=>{const p=Date.now().toString();return ms(g=>g.find(V=>V.id===p)?g.map(V=>V.id===p?{...V,type:s,message:r,progress:x}:V):[...g,{id:p,type:s,message:r,progress:x}]),p},I=l.useCallback(s=>{ms(r=>r.filter(c=>c.id!==s))},[]);l.useEffect(()=>{ye(),Q(),B(),F("/")},[ye,Q,B,F]),l.useEffect(()=>{if(m&&R.length>0&&!T){const s=R.find(r=>r.id===m);s&&Me(s)}},[m,R,T]),l.useEffect(()=>{const s=()=>K(null);return window.addEventListener("click",s),()=>window.removeEventListener("click",s)},[]);const es=A.length>0,Ae=A.reduce((s,r)=>{var x;const c=((x=r.partitions)==null?void 0:x.reduce((p,g)=>p+(g.total_bytes||0),0))||0;return s+c},0),us=A.reduce((s,r)=>{var x;const c=((x=r.partitions)==null?void 0:x.reduce((p,g)=>p+(g.used_bytes||0),0))||0;return s+c},0),hs=o.filter(s=>s.name!=="."&&!(s.name===".."&&d==="/")&&s.name.toLowerCase().includes(Xe.toLowerCase())),Js=(()=>{if(d==="/")return[];try{const r=te(d).split("/").filter(Boolean);return r.map((c,x)=>{const p="/"+r.slice(0,x+1).join("/"),g=btoa(unescape(encodeURIComponent(p)));return{name:c,encodedPath:g}})}catch{return[]}})(),Ys=s=>{s.type==="dir"&&(s.name===".."?$():z(s.path))},ps=l.useCallback(s=>j.some(r=>r.path===s),[j]),se=s=>{try{return te(s).split("/").filter(Boolean).length===1}catch{return!1}},gs=s=>{if(se(s.path)){u("warning","Impossible de renommer un disque");return}Ce(s),oe(s.name),we(!0)},bs=s=>{k(),ne(s.path),ks()},js=s=>{k(),ne(s.path),Ss()},fs=s=>{Fe(s),me(null),Se(!0)},ys=async s=>{if(confirm(`Supprimer "${s.name}" ?`)){const r=u("loading",`Suppression de "${s.name}"...`),c=await N([s.path]);I(r),c?u("success",`"${s.name}" supprimé`):u("error","Erreur lors de la suppression")}},Ns=async()=>{if(ce.trim()){const s=u("loading","Création du dossier..."),r=await P(ce.trim());I(s),r?u("success",`Dossier "${ce.trim()}" créé`):u("error","Erreur lors de la création du dossier"),Oe(""),Ge(!1)}},vs=async()=>{xs(!0);const s=u("loading","Ajout du téléchargement...");let r=!1;try{if(_){const c=new FileReader,x=await new Promise((p,g)=>{c.onload=()=>{const V=c.result.split(",")[1];p(V)},c.onerror=g,c.readAsDataURL(_)});r=await He(x,_.name)}else ue.trim()&&(r=await qe(ue.trim()))}catch{r=!1}I(s),xs(!1),r?(u("success","Téléchargement ajouté"),De(""),he(null),Te(!1)):u("error","Erreur lors de l'ajout du téléchargement")},Zs=s=>{var c;const r=(c=s.target.files)==null?void 0:c[0];r&&r.name.endsWith(".torrent")&&(he(r),De(""))},et=async s=>{const r=u("loading","Relance du téléchargement...");await ve(s),I(r),u("success","Téléchargement relancé")},st=async()=>{const s=n.length;if(s>0&&confirm(`Supprimer ${s} élément(s) ?`)){const r=u("loading",`Suppression de ${s} élément(s)...`),c=await N(n);I(r),c?u("success",`${s} élément(s) supprimé(s)`):u("error","Erreur lors de la suppression")}},ws=async()=>{if(Y&&Z.trim()){const s=u("loading","Renommage en cours..."),r=await le(Y.path,Z.trim());I(s),r?u("success",`"${Y.name}" renommé en "${Z.trim()}"`):u("error","Erreur lors du renommage"),Ce(null),oe(""),we(!1)}},tt=async()=>{if(n.length>0&&y&&y!=="/"){const s=n.length,r=ze,c=[...n],x=y;Je(!1),ee(""),Ye("/"),k();const p=u("loading",`Copie de ${s} élément(s) en cours...`),g=await h(c,x);I(p),g?u("success",`${s} élément(s) copié(s) vers ${r}`):u("error","Erreur lors de la copie")}},at=async()=>{if(n.length>0&&y&&y!=="/"){const s=n.length,r=ze,c=[...n],x=y;Qe(!1),ee(""),Ye("/"),k();const p=u("loading",`Déplacement de ${s} élément(s) en cours...`),g=await Ie(c,x);I(p),g?u("success",`${s} élément(s) déplacé(s) vers ${r}`):u("error","Erreur lors du déplacement")}},rt=async()=>{if(de){const s=await Ue(de.path,os||void 0);s&&me(s)}},Cs=async s=>{try{await navigator.clipboard.writeText(s),Pe(!0),setTimeout(()=>Pe(!1),2e3)}catch{const r=document.createElement("textarea");r.value=s,document.body.appendChild(r),r.select(),document.execCommand("copy"),document.body.removeChild(r),Pe(!0),setTimeout(()=>Pe(!1),2e3)}},lt=(s,r)=>{s.preventDefault(),s.stopPropagation();const c=180,x=250;let p=s.clientX,g=s.clientY;p+c>window.innerWidth&&(p=window.innerWidth-c-10),g+x>window.innerHeight&&(g=window.innerHeight-x-10),K({x:p,y:g,file:r})},U=async s=>{cs(!0);try{const r=s==="/"||s===""?"/api/fs/list":`/api/fs/list?path=${encodeURIComponent(s)}`,x=await(await fetch(r)).json();if(x.success&&x.result){const p=x.result.filter(g=>g.type==="dir");ns(p),Ye(s),ee(s==="/"?"/":te(s))}}catch{ns([])}cs(!1)},zs=async()=>{if(y!=="/")try{const r=te(y).split("/").filter(Boolean);if(r.pop(),r.length===0)await U("/");else{const c="/"+r.join("/"),x=btoa(unescape(encodeURIComponent(c)));await U(x)}}catch{await U("/")}},ks=()=>{Je(!0),U("/")},Ss=()=>{Qe(!0),U("/")},$e=R.filter(s=>s.status==="downloading"||s.status==="seeding").length;return e.jsxs("div",{className:"min-h-screen bg-[#050505] text-gray-300",children:[e.jsx("header",{className:"sticky top-0 z-40 bg-[#0a0a0a]/95 backdrop-blur-sm border-b border-gray-800",children:e.jsx("div",{className:"max-w-[1920px] mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-800 rounded-lg transition-colors",children:e.jsx(ft,{size:24})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/20 rounded-lg",children:e.jsx(ae,{size:24,className:"text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-white",children:"Fichiers"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Explorateur & Téléchargements"})]})]})]}),es&&Ae>0?e.jsxs("div",{className:"hidden md:flex items-center gap-3 bg-[#1a1a1a] px-4 py-2 rounded-lg",children:[e.jsx(ss,{size:16,className:"text-gray-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Espace utilisé"}),e.jsxs("div",{className:"text-sm text-white",children:[H(us)," / ",H(Ae)]})]}),e.jsx("div",{className:"w-24 h-2 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500",style:{width:`${Ae>0?us/Ae*100:0}%`}})})]}):e.jsxs("div",{className:"hidden md:flex items-center gap-3 bg-[#1a1a1a] px-4 py-2 rounded-lg",children:[e.jsx(ss,{size:16,className:"text-gray-500"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Aucun disque"})]})]})})}),e.jsxs("main",{className:"max-w-[1920px] mx-auto px-4 py-6 pb-24",children:[e.jsx("div",{className:"flex items-center justify-between mb-6 border-b border-gray-800",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>Ve("files"),className:`px-4 py-3 text-sm font-medium transition-colors border-b-2 -mb-px ${J==="files"?"text-blue-400 border-blue-400":"text-gray-400 border-transparent hover:text-white"}`,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(ae,{size:16}),"Explorateur"]})}),e.jsx("button",{onClick:()=>Ve("downloads"),className:`px-4 py-3 text-sm font-medium transition-colors border-b-2 -mb-px ${J==="downloads"?"text-emerald-400 border-emerald-400":"text-gray-400 border-transparent hover:text-white"}`,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(ge,{size:16}),"Téléchargements (",R.length,")",$e>0&&e.jsx("span",{className:"px-1.5 py-0.5 text-[10px] bg-emerald-500 text-white rounded-full",children:$e})]})}),e.jsx("button",{onClick:()=>{Ve("shares"),B()},className:`px-4 py-3 text-sm font-medium transition-colors border-b-2 -mb-px ${J==="shares"?"text-purple-400 border-purple-400":"text-gray-400 border-transparent hover:text-white"}`,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(G,{size:16}),"Partages (",j.length,")"]})})]})}),v&&e.jsxs("div",{className:"mb-6 p-4 bg-red-900/20 border border-red-700/50 rounded-xl flex items-center gap-3",children:[e.jsx(_e,{className:"text-red-400 flex-shrink-0"}),e.jsx("p",{className:"text-red-400",children:v})]}),J==="files"&&e.jsxs(e.Fragment,{children:[!W&&e.jsx(Fs,{permission:"explorer",freeboxUrl:E}),!es&&W&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(ss,{size:64,className:"text-gray-600 mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"Aucun disque détecté"}),e.jsx("p",{className:"text-gray-500 text-center max-w-md",children:"Connectez un disque dur à votre Freebox pour accéder à l'explorateur de fichiers."})]}),es&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-1 overflow-x-auto flex-grow",children:[e.jsxs("button",{onClick:()=>z("/"),className:"flex items-center gap-2 px-2 py-1.5 hover:bg-gray-800 rounded-lg transition-colors flex-shrink-0",children:[e.jsx(ts,{size:16}),e.jsx("span",{className:"text-sm text-gray-300",children:L})]}),Js.map((s,r)=>{const c=ps(s.encodedPath);return e.jsxs(dt.Fragment,{children:[e.jsx(yt,{size:14,className:"text-gray-600 flex-shrink-0"}),e.jsxs("button",{onClick:()=>z(s.encodedPath),className:`px-2 py-1 text-sm hover:text-white hover:bg-gray-800 rounded transition-colors truncate max-w-48 flex items-center gap-1 ${c?"text-purple-400":"text-gray-300"}`,children:[s.name,c&&e.jsx(G,{size:12,className:"flex-shrink-0"})]})]},r)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Nt,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500"}),e.jsx("input",{type:"text",placeholder:"Rechercher...",value:Xe,onChange:s=>Ws(s.target.value),className:"pl-8 pr-3 py-1.5 bg-[#1a1a1a] border border-gray-700 rounded-lg text-sm text-white placeholder:text-gray-500 focus:outline-none focus:outline-none w-40"})]}),e.jsx("button",{onClick:()=>Us(ie==="grid"?"list":"grid"),className:"p-2 hover:bg-gray-800 rounded-lg transition-colors",title:ie==="grid"?"Vue liste":"Vue grille",children:ie==="grid"?e.jsx(vt,{size:16}):e.jsx(Bs,{size:16})}),e.jsx("button",{onClick:()=>F(),className:"p-2 hover:bg-gray-800 rounded-lg transition-colors",title:"Actualiser",children:e.jsx(pe,{size:16})})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:$,disabled:d==="/",className:"flex items-center gap-2 px-3 py-1.5 text-xs bg-[#1a1a1a] hover:bg-[#252525] disabled:opacity-50 disabled:cursor-not-allowed border border-gray-700 rounded-lg transition-colors",children:[e.jsx(Be,{size:14}),"Dossier parent"]}),e.jsxs("button",{onClick:()=>Ge(!0),disabled:d==="/",title:d==="/"?"Impossible de créer un dossier à la racine":"Nouveau dossier",className:"flex items-center gap-2 px-3 py-1.5 text-xs bg-blue-600 hover:bg-blue-500 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg transition-colors",children:[e.jsx(wt,{size:14}),"Nouveau dossier"]})]}),e.jsx("div",{className:"flex items-center gap-2",children:n.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-xs text-gray-400",children:[n.length," sélectionné(s)"]}),e.jsx("button",{onClick:k,className:"px-3 py-1.5 text-xs text-gray-400 hover:text-white transition-colors",children:"Annuler"}),n.length===1&&!se(n[0])&&e.jsxs("button",{onClick:()=>{const s=o.find(r=>r.path===n[0]);s&&(Ce(s),oe(s.name),we(!0))},className:"flex items-center gap-2 px-3 py-1.5 text-xs bg-[#1a1a1a] hover:bg-[#252525] border border-gray-700 rounded-lg transition-colors",title:"Renommer",children:[e.jsx(Re,{size:14}),"Renommer"]}),e.jsxs("button",{onClick:ks,className:"flex items-center gap-2 px-3 py-1.5 text-xs bg-[#1a1a1a] hover:bg-[#252525] border border-gray-700 rounded-lg transition-colors",title:"Copier",children:[e.jsx(O,{size:14}),"Copier"]}),e.jsxs("button",{onClick:Ss,className:"flex items-center gap-2 px-3 py-1.5 text-xs bg-[#1a1a1a] hover:bg-[#252525] border border-gray-700 rounded-lg transition-colors",title:"Déplacer",children:[e.jsx(je,{size:14}),"Déplacer"]}),n.length===1&&e.jsxs("button",{onClick:()=>{const s=o.find(r=>r.path===n[0]);s&&(Fe(s),me(null),Se(!0))},className:"flex items-center gap-2 px-3 py-1.5 text-xs bg-purple-600/20 hover:bg-purple-600/30 text-purple-400 rounded-lg transition-colors",title:"Partager",children:[e.jsx(fe,{size:14}),"Partager"]}),e.jsxs("button",{onClick:st,className:"flex items-center gap-2 px-3 py-1.5 text-xs bg-red-600/20 hover:bg-red-600/30 text-red-400 rounded-lg transition-colors",children:[e.jsx(re,{size:14}),"Supprimer"]})]}):e.jsx("button",{onClick:We,className:"px-3 py-1.5 text-xs text-gray-400 hover:text-white transition-colors",children:"Tout sélectionner"})})]}),w?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(X,{size:32,className:"text-blue-400 animate-spin"})}):hs.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:ie==="grid"?"grid grid-cols-2 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-3":"space-y-1",children:hs.map(s=>e.jsx(Bt,{file:s,isSelected:n.includes(s.path),isShared:ps(s.path),isRootFolder:se(s.path),isParentDir:s.name==="..",viewMode:ie,onSelect:()=>ne(s.path),onOpen:()=>Ys(s),onContextMenu:r=>lt(r,s),onRename:()=>gs(s),onCopy:()=>bs(s),onMove:()=>js(s),onShare:()=>fs(s),onDelete:()=>ys(s)},s.path))}),S&&e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx("button",{onClick:D,disabled:C,className:"flex items-center gap-2 px-6 py-2.5 bg-[#1a1a1a] hover:bg-[#252525] disabled:opacity-50 border border-gray-700 rounded-lg transition-colors text-sm text-white",children:C?e.jsxs(e.Fragment,{children:[e.jsx(X,{size:16,className:"animate-spin"}),"Chargement..."]}):e.jsxs(e.Fragment,{children:[e.jsx(pe,{size:16}),"Charger plus de fichiers"]})})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(ae,{size:48,className:"text-gray-600 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Dossier vide"}),e.jsx("p",{className:"text-gray-500 text-center max-w-md",children:Xe?"Aucun fichier ne correspond à votre recherche.":"Ce dossier ne contient aucun fichier."})]})]})]}),J==="downloads"&&e.jsxs(e.Fragment,{children:[!f&&e.jsx(Fs,{permission:"downloader",freeboxUrl:E}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>Te(!0),className:"flex items-center gap-2 px-3 py-1.5 text-xs bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors",children:[e.jsx(Ts,{size:14}),"Ajouter"]}),$e>0&&e.jsxs("span",{className:"text-sm text-emerald-400",children:[$e," téléchargement(s) en cours"]})]}),e.jsx("button",{onClick:()=>Q(),className:"p-2 hover:bg-gray-800 rounded-lg transition-colors",title:"Actualiser",children:e.jsx(pe,{size:16})})]}),R.length>0?e.jsx("div",{className:"space-y-2",children:R.map(s=>e.jsx(Rt,{task:s,isSelected:(T==null?void 0:T.id)===s.id,onSelect:()=>Me((T==null?void 0:T.id)===s.id?null:s),onPause:()=>Ke(s.id),onResume:()=>ve(s.id),onRetry:()=>et(s.id),onDelete:()=>{confirm("Supprimer ce téléchargement ?")&&((T==null?void 0:T.id)===s.id&&Me(null),a(s.id,!1))}},s.id))}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(ge,{size:48,className:"text-gray-600 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Aucun téléchargement"}),e.jsx("p",{className:"text-gray-500 text-center max-w-md",children:"Vos téléchargements actifs et terminés apparaîtront ici."}),e.jsxs("button",{onClick:()=>Te(!0),className:"mt-4 flex items-center gap-2 px-4 py-2 text-sm bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors",children:[e.jsx(Ts,{size:16}),"Ajouter un téléchargement"]})]}),T&&e.jsx("div",{className:"mt-6",children:e.jsx(Mt,{task:T,onClose:()=>Me(null)})})]}),J==="shares"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"text-sm text-gray-400",children:j.length>0&&e.jsxs("span",{children:[j.length," lien(s) de partage actif(s)"]})}),e.jsx("button",{onClick:()=>B(),className:"p-2 hover:bg-gray-800 rounded-lg transition-colors",title:"Actualiser",children:e.jsx(pe,{size:16})})]}),j.length>0?e.jsx("div",{className:"space-y-2",children:j.map(s=>e.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-purple-500/20",children:e.jsx(G,{size:16,className:"text-purple-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm text-white truncate",children:s.name}),e.jsx("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:s.expire>0?e.jsxs(e.Fragment,{children:[e.jsx(Ct,{size:12}),e.jsxs("span",{children:["Expire le ",as(s.expire)]})]}):e.jsx("span",{children:"Pas d'expiration"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>Cs(s.fullurl),className:"flex items-center gap-2 px-3 py-1.5 text-xs bg-purple-600/20 hover:bg-purple-600/30 text-purple-400 rounded-lg transition-colors",children:[Ze?e.jsx(Ee,{size:14}):e.jsx(O,{size:14}),Ze?"Copié !":"Copier le lien"]}),e.jsx("button",{onClick:async()=>{confirm("Supprimer ce lien de partage ?")&&await Ne(s.token)},className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-900/20 rounded-lg transition-colors",children:e.jsx(re,{size:16})})]})]}),s.fullurl&&e.jsx("div",{className:"mt-3 p-2 bg-[#0a0a0a] rounded-lg",children:e.jsx("p",{className:"text-xs text-gray-400 font-mono truncate",children:s.fullurl})})]},s.token))}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(G,{size:48,className:"text-gray-600 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Aucun lien de partage"}),e.jsx("p",{className:"text-gray-500 text-center max-w-md",children:`Sélectionnez un fichier ou dossier dans l'explorateur et cliquez sur "Partager" pour créer un lien.`})]})]}),qs&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-[#121212] rounded-xl border border-gray-800 p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Nouveau dossier"}),e.jsx("input",{type:"text",placeholder:"Nom du dossier",value:ce,onChange:s=>Oe(s.target.value),onKeyDown:s=>s.key==="Enter"&&Ns(),className:"w-full px-4 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white placeholder:text-gray-500 focus:outline-none focus:outline-none",autoFocus:!0}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx("button",{onClick:()=>{Oe(""),Ge(!1)},className:"px-4 py-2 text-sm text-gray-400 hover:text-white transition-colors",children:"Annuler"}),e.jsx("button",{onClick:Ns,disabled:!ce.trim(),className:"px-4 py-2 text-sm bg-blue-600 hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors",children:"Créer"})]})]})}),Hs&&Y&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-[#121212] rounded-xl border border-gray-800 p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Renommer"}),e.jsxs("p",{className:"text-sm text-gray-400 mb-4",children:['Renommer "',Y.name,'"']}),e.jsx("input",{type:"text",placeholder:"Nouveau nom",value:Z,onChange:s=>oe(s.target.value),onKeyDown:s=>s.key==="Enter"&&ws(),className:"w-full px-4 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white placeholder:text-gray-500 focus:outline-none focus:outline-none",autoFocus:!0}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx("button",{onClick:()=>{Ce(null),oe(""),we(!1)},className:"px-4 py-2 text-sm text-gray-400 hover:text-white transition-colors",children:"Annuler"}),e.jsx("button",{onClick:ws,disabled:!Z.trim()||Z===Y.name,className:"px-4 py-2 text-sm bg-blue-600 hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors",children:"Renommer"})]})]})}),Vs&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-[#121212] rounded-xl border border-gray-800 p-6 w-full max-w-lg",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(O,{size:20,className:"text-blue-400"}),"Copier ",n.length," élément(s)"]}),e.jsxs("div",{className:"mb-4 p-3 bg-[#1a1a1a] rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Destination :"}),e.jsx("p",{className:"text-sm text-white font-mono",children:ze||"/"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("button",{onClick:()=>U("/"),className:"p-1.5 hover:bg-gray-700 rounded transition-colors",title:"Racine",children:e.jsx(ts,{size:14})}),e.jsx("button",{onClick:zs,disabled:y==="/",className:"p-1.5 hover:bg-gray-700 rounded transition-colors disabled:opacity-50",title:"Dossier parent",children:e.jsx(Be,{size:14})}),e.jsx("span",{className:"text-xs text-gray-400 truncate flex-1",children:y==="/"?"/":te(y)})]}),e.jsx("div",{className:"h-48 overflow-y-auto bg-[#0a0a0a] rounded-lg border border-gray-700",children:is?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(X,{size:20,className:"text-blue-400 animate-spin"})}):ke.length>0?e.jsx("div",{className:"p-1",children:ke.map(s=>e.jsxs("button",{onClick:()=>U(s.path),className:"w-full flex items-center gap-2 p-2 hover:bg-gray-800 rounded text-left transition-colors",children:[e.jsx(ae,{size:16,className:"text-yellow-400 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-white truncate",children:s.name})]},s.path))}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 text-sm",children:"Aucun sous-dossier"})})]}),y==="/"&&e.jsx("p",{className:"text-xs text-amber-400 mb-3",children:"Sélectionnez un dossier de destination"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>{ee(""),Je(!1)},className:"px-4 py-2 text-sm text-gray-400 hover:text-white transition-colors",children:"Annuler"}),e.jsx("button",{onClick:tt,disabled:y==="/",className:"px-4 py-2 text-sm bg-blue-600 hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors",children:"Copier ici"})]})]})}),Ks&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-[#121212] rounded-xl border border-gray-800 p-6 w-full max-w-lg",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(je,{size:20,className:"text-blue-400"}),"Déplacer ",n.length," élément(s)"]}),e.jsxs("div",{className:"mb-4 p-3 bg-[#1a1a1a] rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Destination :"}),e.jsx("p",{className:"text-sm text-white font-mono",children:ze||"/"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("button",{onClick:()=>U("/"),className:"p-1.5 hover:bg-gray-700 rounded transition-colors",title:"Racine",children:e.jsx(ts,{size:14})}),e.jsx("button",{onClick:zs,disabled:y==="/",className:"p-1.5 hover:bg-gray-700 rounded transition-colors disabled:opacity-50",title:"Dossier parent",children:e.jsx(Be,{size:14})}),e.jsx("span",{className:"text-xs text-gray-400 truncate flex-1",children:y==="/"?"/":te(y)})]}),e.jsx("div",{className:"h-48 overflow-y-auto bg-[#0a0a0a] rounded-lg border border-gray-700",children:is?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(X,{size:20,className:"text-blue-400 animate-spin"})}):ke.length>0?e.jsx("div",{className:"p-1",children:ke.map(s=>e.jsxs("button",{onClick:()=>U(s.path),className:"w-full flex items-center gap-2 p-2 hover:bg-gray-800 rounded text-left transition-colors",children:[e.jsx(ae,{size:16,className:"text-yellow-400 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-white truncate",children:s.name})]},s.path))}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 text-sm",children:"Aucun sous-dossier"})})]}),y==="/"&&e.jsx("p",{className:"text-xs text-amber-400 mb-3",children:"Sélectionnez un dossier de destination"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>{ee(""),Qe(!1)},className:"px-4 py-2 text-sm text-gray-400 hover:text-white transition-colors",children:"Annuler"}),e.jsx("button",{onClick:at,disabled:y==="/",className:"px-4 py-2 text-sm bg-blue-600 hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors",children:"Déplacer ici"})]})]})}),Xs&&de&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-[#121212] rounded-xl border border-gray-800 p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(fe,{size:20,className:"text-purple-400"}),'Partager "',de.name,'"']})}),xe?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4 p-4 bg-emerald-900/20 border border-emerald-700/50 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2 text-emerald-400 mb-2",children:[e.jsx(Ee,{size:16}),e.jsx("span",{className:"text-sm font-medium",children:"Lien créé avec succès !"})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Lien de partage :"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:xe.fullurl,readOnly:!0,className:"flex-1 px-4 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm font-mono"}),e.jsx("button",{onClick:()=>Cs(xe.fullurl),className:"px-4 py-2 bg-purple-600 hover:bg-purple-500 text-white rounded-lg transition-colors",children:Ze?e.jsx(Ee,{size:16}):e.jsx(O,{size:16})})]})]}),xe.expire>0&&e.jsxs("p",{className:"text-xs text-gray-500 mb-4",children:["Expire le ",as(xe.expire)]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>{Fe(null),me(null),Se(!1),k()},className:"px-4 py-2 text-sm bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Fermer"})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-sm text-gray-400 mb-4",children:["Créez un lien de partage public pour ce ",de.type==="dir"?"dossier":"fichier","."]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Expiration du lien :"}),e.jsxs("select",{value:os,onChange:s=>Gs(Number(s.target.value)),className:"w-full px-4 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white focus:outline-none focus:border-purple-500",children:[e.jsx("option",{value:0,children:"Jamais"}),e.jsx("option",{value:1,children:"1 jour"}),e.jsx("option",{value:7,children:"7 jours"}),e.jsx("option",{value:30,children:"30 jours"}),e.jsx("option",{value:90,children:"90 jours"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>{Fe(null),me(null),Se(!1)},className:"px-4 py-2 text-sm text-gray-400 hover:text-white transition-colors",children:"Annuler"}),e.jsx("button",{onClick:rt,className:"px-4 py-2 text-sm bg-purple-600 hover:bg-purple-500 text-white rounded-lg transition-colors",children:"Créer le lien"})]})]})]})}),Os&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-[#121212] rounded-xl border border-gray-800 p-6 w-full max-w-lg",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(ge,{size:20,className:"text-blue-400"}),"Ajouter un téléchargement"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"URL du fichier ou lien magnet"}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(G,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500"}),e.jsx("input",{type:"text",placeholder:"https://... ou magnet:?xt=...",value:ue,onChange:s=>{De(s.target.value),s.target.value&&he(null)},onKeyDown:s=>s.key==="Enter"&&(ue.trim()||_)&&vs(),disabled:!!_,className:"w-full pl-10 pr-4 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white placeholder:text-gray-500 focus:outline-none focus:outline-none disabled:opacity-50",autoFocus:!0})]})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 h-px bg-gray-700"}),e.jsx("span",{className:"text-xs text-gray-500",children:"ou"}),e.jsx("div",{className:"flex-1 h-px bg-gray-700"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Fichier torrent"}),_?e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-[#1a1a1a] border border-gray-700 rounded-lg",children:[e.jsx("div",{className:"p-2 bg-blue-500/20 rounded-lg",children:e.jsx(ls,{size:20,className:"text-blue-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-white truncate",children:_.name}),e.jsx("p",{className:"text-xs text-gray-500",children:H(_.size)})]}),e.jsx("button",{onClick:()=>he(null),className:"p-1 text-gray-400 hover:text-red-400 transition-colors",children:e.jsx(Le,{size:16})})]}):e.jsxs("label",{className:"flex flex-col items-center justify-center gap-2 p-6 border-2 border-dashed border-gray-700 rounded-lg cursor-pointer hover:border-gray-600 hover:bg-[#1a1a1a]/50 transition-colors",children:[e.jsx(zt,{size:24,className:"text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-400",children:"Cliquez ou déposez un fichier .torrent"}),e.jsx("input",{type:"file",accept:".torrent",onChange:Zs,className:"hidden"})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Formats supportés : HTTP, HTTPS, FTP, Magnet, fichiers .torrent"})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[e.jsx("button",{onClick:()=>{De(""),he(null),Te(!1)},className:"px-4 py-2 text-sm text-gray-400 hover:text-white transition-colors",children:"Annuler"}),e.jsx("button",{onClick:vs,disabled:!ue.trim()&&!_||ds,className:"flex items-center gap-2 px-4 py-2 text-sm bg-blue-600 hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors",children:ds?e.jsxs(e.Fragment,{children:[e.jsx(X,{size:16,className:"animate-spin"}),"Ajout..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{size:16}),"Télécharger"]})})]})]})})]}),M&&e.jsxs("div",{className:"fixed bg-[#1a1a1a] border border-gray-700 rounded-lg shadow-xl py-1 min-w-[180px] z-[200]",style:{left:M.x,top:M.y},onClick:s=>s.stopPropagation(),children:[e.jsx("div",{className:"px-3 py-2 border-b border-gray-700",children:e.jsx("p",{className:"text-xs text-gray-400 truncate max-w-[160px]",children:M.file.name})}),e.jsxs("button",{onClick:()=>{se(M.file.path)||(gs(M.file),K(null))},disabled:se(M.file.path),className:`w-full px-3 py-2 text-left text-sm flex items-center gap-2 ${se(M.file.path)?"text-gray-600 cursor-not-allowed":"text-gray-300 hover:bg-gray-800"}`,children:[e.jsx(Re,{size:14})," Renommer"]}),e.jsxs("button",{onClick:()=>{bs(M.file),K(null)},className:"w-full px-3 py-2 text-left text-sm text-gray-300 hover:bg-gray-800 flex items-center gap-2",children:[e.jsx(O,{size:14})," Copier"]}),e.jsxs("button",{onClick:()=>{js(M.file),K(null)},className:"w-full px-3 py-2 text-left text-sm text-gray-300 hover:bg-gray-800 flex items-center gap-2",children:[e.jsx(je,{size:14})," Déplacer"]}),e.jsxs("button",{onClick:()=>{fs(M.file),K(null)},className:"w-full px-3 py-2 text-left text-sm text-purple-400 hover:bg-gray-800 flex items-center gap-2",children:[e.jsx(fe,{size:14})," Partager"]}),e.jsx("div",{className:"border-t border-gray-700 my-1"}),e.jsxs("button",{onClick:()=>{ys(M.file),K(null)},className:"w-full px-3 py-2 text-left text-sm text-red-400 hover:bg-gray-800 flex items-center gap-2",children:[e.jsx(re,{size:14})," Supprimer"]})]}),e.jsx(Tt,{toasts:Qs,onClose:I})]})};export{Ht as FilesPage,Ht as default};
