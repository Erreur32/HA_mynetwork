import{F as E,G as z,j as e,E as F,H as O,o as S,r as M,k as G,b as X,q as B,M as Y}from"./index-D769t3SB.js";import{r as o,c as J,A as Q,C as Z,X as ee,Y as se,T as te,L as ae,d as H}from"./vendor-charts-fy94SsLU.js";import{a2 as re,a0 as ne,e as le,s as ie,H as V,S as ce,f as T,A as de,d as oe,_ as U,aT as xe,aO as me}from"./vendor-icons-Wr2_Nvt-.js";import{P as q}from"./PluginSummaryCard-BVc5nQnY.js";import"./vendor-D9iDNHsv.js";import"./vendor-state-CiM9n9np.js";const ue=()=>{var k,a;const[s,v]=o.useState(null),[l,c]=o.useState(null),[u,y]=o.useState(!0),[r,x]=o.useState(!0),[h,m]=o.useState(null),j=async()=>{try{y(!0),m(null);const i=await M.get("/api/system/server");i.success&&i.result?(v(i.result),i.result.docker):m("Failed to fetch system info")}catch(i){m("Error fetching system info"),console.error("System info error:",i)}finally{y(!1)}},g=async()=>{x(!1)};o.useEffect(()=>{j(),g()},[]),E(j,{enabled:!0,interval:z.system}),E(g,{enabled:!1,interval:5e3});const n=i=>{if(i===0)return"N/A";const N=i/(1024*1024*1024);return N>=1?`${N.toFixed(2)} GB`:`${(i/(1024*1024)).toFixed(2)} MB`};return u&&!s?e.jsx(F,{title:"Système Serveur",children:e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(re,{size:24,className:"mx-auto mb-2 animate-spin"}),e.jsx("p",{className:"text-sm",children:"Chargement..."})]})}):h&&!s?e.jsx(F,{title:"Système Serveur",children:e.jsxs("div",{className:"text-center py-8 text-red-500",children:[e.jsx(ne,{size:24,className:"mx-auto mb-2"}),e.jsx("p",{className:"text-sm",children:h})]})}):s?e.jsx(F,{title:"Système Serveur",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"flex items-center gap-2 text-gray-400",children:[e.jsx(le,{size:16})," CPU"]}),e.jsxs("span",{className:"text-white",children:[s.cpu.cores," cores"]})]}),e.jsx("div",{className:"w-full bg-[#1a1a1a] rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all",style:{width:`${Math.min(s.cpu.usage??0,100)}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[e.jsx("span",{children:s.cpu.model}),e.jsxs("span",{children:[(s.cpu.usage??0).toFixed(1),"%"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"flex items-center gap-2 text-gray-400",children:[e.jsx(ie,{size:16})," RAM"]}),e.jsxs("span",{className:"text-white",children:[n(s.memory.used)," / ",n(s.memory.total)]})]}),e.jsx("div",{className:"w-full bg-[#1a1a1a] rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all",style:{width:`${Math.min(s.memory.percentage??0,100)}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[e.jsxs("span",{children:["Libre: ",n(s.memory.free)]}),e.jsxs("span",{children:[(s.memory.percentage??0).toFixed(1),"%"]})]})]}),s.disks&&s.disks.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[e.jsx(V,{size:16}),e.jsxs("span",{children:["Disques (",s.disks.length,")"]})]}),s.disks.map((i,N)=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400 font-mono text-xs",children:i.mount}),e.jsxs("span",{className:"text-white text-xs",children:[n(i.used)," / ",n(i.total)]})]}),e.jsx("div",{className:"w-full bg-[#1a1a1a] rounded-full h-2",children:e.jsx("div",{className:"bg-fuchsia-500 h-2 rounded-full transition-all",style:{width:`${Math.min(i.percentage??0,100)}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[e.jsxs("span",{children:["Libre: ",n(i.free)]}),e.jsxs("span",{children:[(i.percentage??0).toFixed(1),"%"]})]})]},N))]}):s.disk.total>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"flex items-center gap-2 text-gray-400",children:[e.jsx(V,{size:16})," Disque"]}),e.jsxs("span",{className:"text-white",children:[n(s.disk.used)," / ",n(s.disk.total)]})]}),e.jsx("div",{className:"w-full bg-[#1a1a1a] rounded-full h-2",children:e.jsx("div",{className:"bg-fuchsia-500 h-2 rounded-full transition-all",style:{width:`${Math.min(s.disk.percentage??0,100)}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[e.jsxs("span",{children:["Libre: ",n(s.disk.free)]}),e.jsxs("span",{children:[(s.disk.percentage??0).toFixed(1),"%"]})]})]}),(s.docker||s.dockerStats)&&e.jsxs("div",{className:"space-y-2 bg-[#05151a] px-3 py-2 rounded border border-cyan-900/60",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-cyan-400",children:[e.jsx(ce,{size:14}),e.jsx("span",{className:"font-semibold text-sm",children:"Docker"})]}),s.dockerVersion&&e.jsxs("div",{className:"text-xs text-cyan-300",children:["v",s.dockerVersion.replace("Docker version ","")]})]}),s.dockerStats?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-gray-400 text-[10px]",children:"Containers"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),e.jsx("span",{className:"text-gray-300",children:s.dockerStats.containers.running})]}),e.jsx("span",{className:"text-gray-500",children:"/"}),e.jsx("span",{className:"text-gray-400",children:s.dockerStats.containers.total})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-gray-400 text-[10px]",children:"Images"}),e.jsx("div",{className:"text-gray-300",children:s.dockerStats.images})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-gray-400 text-[10px]",children:"Volumes"}),e.jsx("div",{className:"text-gray-300",children:s.dockerStats.volumes})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-gray-400 text-[10px]",children:"Networks"}),e.jsx("div",{className:"text-gray-300",children:s.dockerStats.networks})]})]}),s.dockerStats.diskUsage&&s.dockerStats.diskUsage.total>0&&e.jsxs("div",{className:"space-y-1 pt-1 border-t border-cyan-900/40",children:[e.jsx("div",{className:"text-gray-400 text-[10px]",children:"Disk Usage"}),e.jsx("div",{className:"text-gray-300",children:n(s.dockerStats.diskUsage.total)})]})]}):e.jsxs("div",{className:"text-xs text-gray-500 text-center py-2",children:["Stats Docker non disponibles",e.jsx("div",{className:"text-[10px] text-gray-600 mt-1",children:"Vérifiez que le socket Docker est monté"})]})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-700 space-y-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Hostname"}),e.jsx("span",{className:"text-gray-300",children:s.hostname})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Platform"}),e.jsxs("span",{className:"text-gray-300",children:[s.platform," (",s.arch,")"]})]}),!1,(s.dockerVersion||((k=s.dockerStats)==null?void 0:k.version))&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Docker"}),e.jsx("span",{className:"text-gray-300",children:(s.dockerVersion||((a=s.dockerStats)==null?void 0:a.version)||"").replace("Docker version ","")})]})]}),l&&e.jsxs("div",{className:"pt-4 border-t border-gray-700 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[e.jsx(T,{size:16}),e.jsx("span",{children:"Trafic Réseau"})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(O,{data:l.history||[],dataKey:"download",color:"#3b82f6",title:"Descendant",currentValue:l.current.download>0?S(l.current.download).split(" ")[0]:"0",unit:l.current.download>0&&S(l.current.download).split(" ")[1]||"kb/s",trend:"down"}),e.jsx(O,{data:l.history||[],dataKey:"upload",color:"#10b981",title:"Montant",currentValue:l.current.upload>0?S(l.current.upload).split(" ")[0]:"0",unit:l.current.upload>0&&S(l.current.upload).split(" ")[1]||"kb/s",trend:"up"})]})]}),s.uptime&&e.jsxs("div",{className:"mt-3 pt-2 border-t border-gray-800 flex items-center justify-between text-[11px] text-gray-400",children:[e.jsx("span",{children:"Uptime"}),e.jsx("span",{className:"text-gray-300 font-medium",children:(()=>{const i=s.uptime,N=Math.floor(i/3600),L=Math.floor(N/24);if(L>0){const w=N%24;return w>0?`${L}j ${w}h`:`${L}j`}return`${N}h`})()})]})]})}):null},C={blue:"#3b82f6",green:"#10b981"},he=()=>{const{history:s,extendedHistory:v,fetchExtendedHistory:l,status:c}=G(),{login:u,isLoggedIn:y}=X(),[r,x]=o.useState(3600);o.useEffect(()=>{r>0&&l(r).catch(()=>{})},[l,r]),E(()=>{r>0&&l(r).catch(()=>{})},{enabled:r>0,interval:z.system});const h=r===0?s:v.length>0?v:s;return e.jsxs(F,{title:"Bande passante Freebox",actions:c&&e.jsxs("span",{className:"flex items-center gap-3 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(de,{size:13,className:"text-blue-400"}),e.jsx("span",{className:"font-medium text-gray-300",children:S(c.rate_down)})]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(oe,{size:13,className:"text-green-400"}),e.jsx("span",{className:"font-medium text-gray-300",children:S(c.rate_up)})]})]}),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-3",children:[e.jsxs("span",{children:["Période: ",e.jsxs("span",{className:"text-gray-300",children:[r===0&&"Temps réel",r===3600&&"1h",r===21600&&"6h",r===86400&&"24h",r===604800&&"7j"]})]}),e.jsxs("span",{className:"hidden sm:inline text-[11px] text-gray-500",children:["Échelle: ",e.jsx("span",{className:"text-gray-300",children:r===0?"temps réel (live)":v.length>0?"historique (RRD)":"temps réel (live)"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"inline-flex items-center gap-1 bg-[#1b1b1b] rounded-full p-1 border border-gray-800",children:[e.jsx("button",{type:"button",className:`px-2 py-0.5 rounded-full text-[11px] ${r===0?"bg-blue-600 text-white":"text-gray-400 hover:text-gray-200"}`,onClick:()=>x(0),children:"Live"}),e.jsx("button",{type:"button",className:`px-2 py-0.5 rounded-full text-[11px] ${r===3600?"bg-blue-600 text-white":"text-gray-400 hover:text-gray-200"}`,onClick:()=>x(3600),children:"1h"}),e.jsx("button",{type:"button",className:`px-2 py-0.5 rounded-full text-[11px] ${r===21600?"bg-blue-600 text-white":"text-gray-400 hover:text-gray-200"}`,onClick:()=>x(21600),children:"6h"}),e.jsx("button",{type:"button",className:`px-2 py-0.5 rounded-full text-[11px] ${r===86400?"bg-blue-600 text-white":"text-gray-400 hover:text-gray-200"}`,onClick:()=>x(86400),children:"24h"}),e.jsx("button",{type:"button",className:`px-2 py-0.5 rounded-full text-[11px] ${r===604800?"bg-blue-600 text-white":"text-gray-400 hover:text-gray-200"}`,onClick:()=>x(604800),children:"7j"})]}),e.jsxs("button",{type:"button",className:"flex items-center gap-1 px-2 py-0.5 rounded-full text-[11px] bg-[#1b1b1b] border border-gray-800 text-gray-300 hover:bg-[#252525] hover:text-white",onClick:()=>{u().then(()=>{r>0&&l(r).catch(()=>{})}).catch(()=>{r>0&&l(r).catch(()=>{})})},title:y?"Rafraîchir l’historique via Freebox":"Tenter de se reconnecter à la Freebox",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${y?"bg-emerald-400":"bg-red-500"}`}),e.jsx("span",{children:"Auth"})]})]})]}),e.jsx("div",{className:"w-full",style:{height:"256px",minHeight:"256px"},children:h.length>0?e.jsx(J,{width:"100%",height:256,minWidth:0,minHeight:256,children:e.jsxs(Q,{data:h,isAnimationActive:r!==0,children:[e.jsx(Z,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(ee,{dataKey:"time",stroke:"#6b7280",tick:{fill:"#6b7280",fontSize:11},interval:"preserveStartEnd"}),e.jsx(se,{stroke:"#6b7280",tick:{fill:"#6b7280",fontSize:11},tickFormatter:m=>S(m*1024).split(" ")[0]}),e.jsx(te,{contentStyle:{backgroundColor:"#1f2937",border:"1px solid #374151",borderRadius:"8px"},labelStyle:{color:"#9ca3af"},formatter:(m,j,g)=>{const n=g.dataKey==="download"?"Descendant":"Montant",k=g.dataKey==="download"?C.blue:C.green;return[e.jsx("span",{style:{color:k},children:S(m*1024)}),n]}}),e.jsx(ae,{}),e.jsx(H,{type:r===0?"linear":"monotone",dataKey:"download",stackId:"1",stroke:C.blue,fill:C.blue,fillOpacity:.3,name:"Descendant",isAnimationActive:r!==0}),e.jsx(H,{type:r===0?"linear":"monotone",dataKey:"upload",stackId:"2",stroke:C.green,fill:C.green,fillOpacity:.3,name:"Montant",isAnimationActive:r!==0})]})}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-500",children:[e.jsx(T,{className:"w-10 h-10 mb-3 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Collecte des données en cours..."}),e.jsx("p",{className:"text-xs mt-1",children:"Le graphique se remplira automatiquement."})]})})]})},ge=({onViewDetails:s})=>{const{pluginStats:v}=B(),l=v["scan-reseau"],c=l==null?void 0:l.system,u=(c==null?void 0:c.totalIps)||0,y=(c==null?void 0:c.onlineIps)||0,r=(c==null?void 0:c.offlineIps)||0,x=c!=null&&c.lastScan?new Date(c.lastScan):null,[h,m]=o.useState([]),[j,g]=o.useState([]),[n,k]=o.useState(!1),[a,i]=o.useState(null),[N,L]=o.useState(!0);o.useEffect(()=>{let t=!0;return(async()=>{try{L(!0);const f=await M.get("/api/network-scan/auto-status");t&&f.success&&f.result&&i(f.result)}catch(f){console.error("Failed to fetch auto status:",f)}finally{t&&L(!1)}})(),()=>{t=!1}},[]),o.useEffect(()=>{if(u===0){m([]),g([]);return}let t=!0;return(async()=>{var f,d;k(!0);try{const p=new URLSearchParams({status:"offline",limit:"10",sortBy:"last_seen",sortOrder:"desc"}),b=await M.get(`/api/network-scan/history?${p.toString()}`);t&&b.success&&((f=b.result)!=null&&f.items)?m(b.result.items):t&&m([]);const D=new URLSearchParams({status:"online",limit:"10",sortBy:"ping_latency",sortOrder:"desc"}),$=await M.get(`/api/network-scan/history?${D.toString()}`);if(t&&$.success&&((d=$.result)!=null&&d.items)){const _=$.result.items.filter(R=>R.pingLatency&&R.pingLatency>0).sort((R,W)=>(W.pingLatency||0)-(R.pingLatency||0)).slice(0,10);g(_)}else t&&g([])}catch(p){console.error("Failed to fetch network scan details:",p),t&&(m([]),g([]))}finally{t&&k(!1)}})(),()=>{t=!1}},[u]);const w=t=>new Date(t).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),P=(t,A)=>{const f=new Date;let d;d=new Date(f.getTime()+A*6e4);const p=d.getTime()-f.getTime();if(p<=0)return`Le ${d.toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit"})} à ${d.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})}`;const b=Math.floor(p/6e4),D=Math.floor(p/36e5),$=Math.floor(p/864e5);return b<60?b<1?`Dans moins d'1min (${d.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})`:`Dans ${b}min (${d.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})`:D<24?`Dans ${D}h (${d.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})`:$<7?`Dans ${$}j (${d.toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit"})} ${d.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})`:`Le ${d.toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"})} à ${d.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})}`},I=t=>{const A=new Date(t),d=new Date().getTime()-A.getTime(),p=Math.floor(d/6e4),b=Math.floor(d/36e5),D=Math.floor(d/864e5);return p<1?"À l'instant":p<60?`Il y a ${p}min`:b<24?`Il y a ${b}h`:D<7?`Il y a ${D}j`:w(t)},K=t=>t?t<50?"text-emerald-400":t<100?"text-yellow-400":t<200?"text-orange-400":"text-red-400":"text-gray-400";return e.jsx(F,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{size:18,className:"text-cyan-400"}),e.jsx("span",{children:"Scan Réseau"})]}),actions:s?e.jsxs("button",{onClick:s,className:"text-xs text-blue-400 hover:text-blue-300 flex items-center gap-1 transition-colors px-3 py-1.5 bg-blue-500/10 hover:bg-blue-500/20 rounded border border-blue-500/30",children:["Voir détails",e.jsx(xe,{size:14})]}):void 0,children:u===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(T,{size:32,className:"text-gray-500 mb-2"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Aucun scan effectué"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Lancez un scan pour découvrir les IPs du réseau"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"text-center p-3 bg-[#1a1a1a] rounded-lg border border-gray-800",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-200",children:u}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Total IPs"})]}),e.jsxs("div",{className:"text-center p-3 bg-[#1a1a1a] rounded-lg border border-gray-800",children:[e.jsx("div",{className:"text-2xl font-bold text-emerald-400",children:y}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Online"})]}),e.jsxs("div",{className:"text-center p-3 bg-[#1a1a1a] rounded-lg border border-gray-800",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:r}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Offline"})]})]}),e.jsx("div",{className:"pt-2 border-t border-gray-800",children:e.jsxs("div",{className:"text-xs space-y-2",children:[e.jsx("div",{className:"text-gray-400 mb-1",children:"Dernier Scan:"}),a!=null&&a.lastScan?e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[a.lastScan.isManual?e.jsx("span",{className:"px-2 py-0.5 bg-blue-500/20 text-blue-400 rounded text-xs font-medium",children:"Manuel"}):e.jsx("span",{className:"px-2 py-0.5 bg-green-500/20 text-green-400 rounded text-xs font-medium",children:"Auto"}),e.jsx("span",{className:"text-gray-400",children:a.lastScan.type==="full"?e.jsxs(e.Fragment,{children:["Full Scan (",a.lastScan.scanType,")"]}):e.jsxs(e.Fragment,{children:["Refresh (",a.lastScan.scanType,")"]})}),e.jsx("span",{className:"text-gray-300 font-medium",children:w(a.lastScan.timestamp)}),e.jsx("span",{className:"text-gray-500 text-xs",children:I(a.lastScan.timestamp)})]}),a.lastScan.range&&e.jsxs("div",{className:"text-gray-500 text-xs mt-0.5",children:["Plage: ",a.lastScan.range]})]}):x?e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx("span",{className:"px-2 py-0.5 bg-blue-500/20 text-blue-400 rounded text-xs font-medium",children:"Manuel"}),e.jsx("span",{className:"text-gray-300",children:"Scan"}),e.jsx("span",{className:"text-gray-300 font-medium",children:w(x.toISOString())})]}),e.jsx("div",{className:"text-gray-500 text-xs mt-0.5",children:I(x.toISOString())})]}):e.jsx("div",{className:"text-gray-500",children:"Aucun scan effectué"}),a&&a.enabled&&(a.fullScan.config.enabled||a.refresh.config.enabled)?e.jsxs("div",{className:"pt-2 border-t border-gray-800 space-y-1",children:[a.fullScan.config.enabled&&e.jsxs("div",{className:"flex items-center gap-2 text-xs whitespace-nowrap overflow-x-auto",children:[e.jsx(U,{size:12,className:"text-emerald-400 flex-shrink-0"}),e.jsx("span",{className:"text-gray-300",children:"Auto"}),e.jsxs("span",{className:"text-gray-300",children:["Full scan (",a.fullScan.config.scanType,")"]}),a.fullScan.lastExecution?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-500",children:w(a.fullScan.lastExecution.timestamp)}),e.jsx("span",{className:"text-gray-400",children:I(a.fullScan.lastExecution.timestamp)})]}):e.jsx("span",{className:"text-gray-500",children:P(null,a.fullScan.config.interval)})]}),a.refresh.config.enabled&&e.jsxs("div",{className:"flex items-center gap-2 text-xs whitespace-nowrap overflow-x-auto",children:[e.jsx(U,{size:12,className:"text-blue-400 flex-shrink-0"}),e.jsx("span",{className:"text-gray-300",children:"Auto"}),e.jsx("span",{className:"text-gray-300",children:"Refresh (quick)"}),a.refresh.lastExecution?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-500",children:w(a.refresh.lastExecution.timestamp)}),e.jsx("span",{className:"text-gray-400",children:I(a.refresh.lastExecution.timestamp)})]}):e.jsx("span",{className:"text-gray-500",children:P(null,a.refresh.config.interval)})]})]}):N?e.jsx("div",{className:"text-gray-500 text-xs pt-2 border-t border-gray-800",children:"Chargement..."}):a&&!a.enabled?e.jsx("div",{className:"text-gray-500 text-xs pt-2 border-t border-gray-800",children:"Scan automatique désactivé"}):a&&a.enabled&&!a.fullScan.config.enabled&&!a.refresh.config.enabled?e.jsx("div",{className:"text-gray-500 text-xs pt-2 border-t border-gray-800",children:"Aucun scan auto configuré"}):null]})}),r>0&&e.jsxs("div",{className:"pt-2 border-t border-gray-800",children:[e.jsxs("div",{className:"text-xs text-gray-400 mb-2 font-medium",children:["IPs Offline (",h.length>0?h.length:r,")"]}),n&&h.length===0?e.jsx("div",{className:"text-[11px] text-gray-500 py-2",children:"Chargement..."}):h.length>0?e.jsx("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:h.map(t=>e.jsxs("div",{className:"flex items-center justify-between text-[11px] py-1 px-2 bg-[#1a1a1a] rounded border border-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-red-400"}),e.jsx("span",{className:"text-gray-300 font-mono",children:t.ip}),t.hostname&&e.jsxs("span",{className:"text-gray-500",children:["(",t.hostname,")"]})]}),t.mac&&e.jsx("span",{className:"text-gray-500 font-mono text-[10px]",children:t.mac})]},t.id))}):e.jsx("div",{className:"text-[11px] text-gray-500 py-2",children:"Aucune IP offline récente"})]}),y>0&&e.jsxs("div",{className:"pt-2 border-t border-gray-800",children:[e.jsxs("div",{className:"text-xs text-gray-400 mb-2 font-medium",children:["Top Pire Latence (",j.length>0?j.length:"--",")"]}),n&&j.length===0?e.jsx("div",{className:"text-[11px] text-gray-500 py-2",children:"Chargement..."}):j.length>0?e.jsx("div",{className:"space-y-1",children:j.map(t=>e.jsxs("div",{className:"flex items-center justify-between text-[11px] py-1 px-2 bg-[#1a1a1a] rounded border border-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-orange-400"}),e.jsx("span",{className:"text-gray-300 font-mono",children:t.ip}),t.hostname&&e.jsxs("span",{className:"text-gray-500",children:["(",t.hostname,")"]})]}),t.pingLatency&&e.jsxs("span",{className:`font-semibold ${K(t.pingLatency)}`,children:[t.pingLatency,"ms"]})]},t.id))}):e.jsx("div",{className:"text-[11px] text-gray-500 py-2",children:"Aucune latence mesurée"})]})]})})},ve=({onNavigateToFreebox:s,onNavigateToUniFi:v,onNavigateToPlugins:l,onNavigateToNetworkScan:c})=>{const{plugins:u,fetchPlugins:y,fetchAllStats:r}=B();o.useEffect(()=>{y()},[y]),E(r,{enabled:u.some(n=>n.enabled),interval:z.system});const x=u.filter(n=>n.enabled&&n.connectionStatus),h=x.some(n=>n.id==="unifi"),m=x.some(n=>n.id==="freebox"),j=u.some(n=>n.id==="scan-reseau"&&n.enabled),g=u.some(n=>n.configured);return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx(Y,{onPluginClick:()=>l==null?void 0:l()}),e.jsx(ue,{})]}),e.jsxs("div",{className:"md:col-span-1 xl:col-span-3 flex flex-col gap-6",children:[m&&e.jsx(he,{}),!g&&e.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-8 border border-gray-800 text-center",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:"Aucun plugin configuré"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Configurez un plugin dans les paramètres pour afficher les données"})]}),g&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[x.find(n=>n.id==="freebox")&&e.jsx(q,{pluginId:"freebox",onViewDetails:s}),h&&e.jsx(q,{pluginId:"unifi",onViewDetails:v}),j&&e.jsx(ge,{onViewDetails:c})]})]})]})};export{ve as UnifiedDashboardPage};
