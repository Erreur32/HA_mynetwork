import{s as b,r as y,j as e,E as v}from"./index-D769t3SB.js";import{r as i}from"./vendor-charts-fy94SsLU.js";import{Y as p,aS as w,R as A,K as C,T as L}from"./vendor-icons-Wr2_Nvt-.js";import"./vendor-D9iDNHsv.js";import"./vendor-state-CiM9n9np.js";const F=({onBack:u})=>{const{user:r}=b(),[o,g]=i.useState([]),[h,d]=i.useState(!0),[n,j]=i.useState("all"),[x,S]=i.useState(50);i.useEffect(()=>{(r==null?void 0:r.role)==="admin"&&m()},[r,n,x]);const m=async()=>{var s,l;d(!0);try{const a=new URLSearchParams({limit:x.toString()});n!=="all"&&a.append("level",n);const t=await y.get(`/api/logs?${a}`);if(t.success&&t.result)g(t.result.logs);else{const c=(s=t.error)==null?void 0:s.message;c&&!c.includes("socket")&&!c.includes("ECONNRESET")&&console.error("Failed to fetch logs:",c)}}catch(a){const t=a.message||((l=a.error)==null?void 0:l.message)||"";t&&!t.includes("socket")&&!t.includes("ECONNRESET")&&console.error("Failed to fetch logs:",t)}finally{d(!1)}},f=s=>{switch(s){case"error":return e.jsx(p,{size:14,className:"text-red-400"});case"warning":return e.jsx(L,{size:14,className:"text-yellow-400"});default:return e.jsx(C,{size:14,className:"text-blue-400"})}},N=s=>s.replace(/\./g," ").replace(/\b\w/g,l=>l.toUpperCase());return(r==null?void 0:r.role)!=="admin"?e.jsx("div",{className:"min-h-screen bg-[#050505] text-gray-300 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(p,{size:48,className:"mx-auto text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Accès administrateur requis"})]})}):e.jsx("div",{className:"min-h-screen bg-[#050505] text-gray-300",children:e.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:u,className:"p-2 hover:bg-[#1a1a1a] rounded transition-colors",children:e.jsx(w,{size:20})}),e.jsx("h1",{className:"text-2xl font-semibold",children:"Logs d'Activité"}),e.jsx("button",{onClick:m,className:"ml-auto p-2 hover:bg-[#1a1a1a] rounded transition-colors",title:"Actualiser",children:e.jsx(A,{size:20})})]}),e.jsx(v,{title:"Filtres",className:"mb-6",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:["all","info","warning","error"].map(s=>e.jsx("button",{onClick:()=>j(s),className:`px-3 py-1.5 rounded text-xs border transition-colors ${n===s?"bg-blue-900/30 border-blue-700 text-blue-400":"bg-[#1a1a1a] border-gray-700 text-gray-400 hover:bg-[#252525]"}`,children:s==="all"?"Tous":s.toUpperCase()},s))})}),h?e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Chargement..."}):e.jsxs("div",{className:"space-y-2",children:[o.map(s=>e.jsxs("div",{className:"bg-[#1a1a1a] border border-gray-700 rounded p-3 flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5",children:f(s.level)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-white",children:N(s.action)}),e.jsx("span",{className:"text-xs text-gray-500",children:"sur"}),e.jsx("span",{className:"text-sm text-gray-400",children:s.resource}),s.pluginId&&e.jsx("span",{className:"px-1.5 py-0.5 bg-purple-900/30 border border-purple-700 rounded text-xs text-purple-400",children:s.pluginId})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500",children:[s.username&&e.jsxs("span",{children:["Par ",s.username]}),e.jsx("span",{children:new Date(s.timestamp).toLocaleString("fr-FR")}),s.ipAddress&&e.jsxs("span",{children:["IP: ",s.ipAddress]})]})]})]},s.id)),o.length===0&&e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Aucun log trouvé"})]})]})})};export{F as LogsPage};
