import{q as bs,j as e,B as ys,r as _,A as J,u as Ps,b as Qe,P as js,h as be,L as Ls,s as as,t as ds,v as us,w as _s,m as Fs,x as Is,y as Ms,U as $s,z as Es,i as ye,C as Rs,D as Ds}from"./index-D769t3SB.js";import{r}from"./vendor-charts-fy94SsLU.js";import{m as $e,X as ls,E as Ke,o as Je,Y as ce,_ as Se,a0 as ts,R as de,a7 as ne,a as ke,b as _e,z as es,p as Xe,a2 as ie,O as Pe,U as ms,C as zs,I as Os,a8 as we,w as vs,aH as Us,n as He,W as ss,as as qs,G as Re,S as Ve,aI as hs,D as fs,q as Bs,T as Be,aa as ps,$ as Ee,aJ as Hs,l as rs,B as Vs,ac as Ns,K as De,aK as Ts,aL as gs,aM as Ws,aN as Gs,af as ws,k as Ks,aB as Cs,M as Ze,aO as Me,H as Ss,N as Ye,aP as Js,aQ as Xs,aR as Zs}from"./vendor-icons-Wr2_Nvt-.js";import{N as Ys}from"./NetworkScanConfigModal-BtVl_IC3.js";import"./vendor-D9iDNHsv.js";import"./vendor-state-CiM9n9np.js";const Qs=({isOpen:n,onClose:c,pluginId:h})=>{const{plugins:E,updatePluginConfig:A,testPluginConnection:L,fetchPlugins:S}=bs(),[y,u]=r.useState(!1),[C,T]=r.useState(!1),[F,b]=r.useState(null),[x,j]=r.useState(!1),v=E.find($=>$.id===h),[i,f]=r.useState({apiMode:"controller",url:"",username:"",password:"",site:"default",apiKey:""});if(r.useEffect(()=>{v&&v.settings&&f({apiMode:v.settings.apiMode||"controller",url:v.settings.url||"",username:v.settings.username||"",password:v.settings.password||"",site:v.settings.site||"default",apiKey:v.settings.apiKey||""})},[v]),!n||!v)return null;const o=($,P)=>{f(U=>({...U,[$]:P})),b(null)},s=()=>{if(h==="unifi")if((i.apiMode||"controller")==="site-manager"){if(!i.apiKey||!i.apiKey.trim())return{valid:!1,error:"La clÃ© API (apiKey) est requise pour le mode Site Manager"}}else{if(!i.url||!i.url.trim())return{valid:!1,error:"L'URL est requise"};try{const P=new URL(i.url);if(!["http:","https:"].includes(P.protocol))return{valid:!1,error:"L'URL doit commencer par http:// ou https://"}}catch{return{valid:!1,error:"Format d'URL invalide"}}if(!i.username||!i.username.trim())return{valid:!1,error:"Le nom d'utilisateur est requis"};if(!i.password||!i.password.trim())return{valid:!1,error:"Le mot de passe est requis"};if(!i.site||!i.site.trim())return{valid:!1,error:"Le nom du site est requis"}}return{valid:!0}},k=async()=>{T(!0),b(null);const $=s();if(!$.valid){b({success:!1,message:$.error||"Veuillez remplir tous les champs requis"}),T(!1);return}try{const P=i.apiMode||"controller",U={apiMode:P};P==="site-manager"?U.apiKey=i.apiKey:(U.url=i.url.trim(),U.username=i.username.trim(),U.password=i.password,U.site=i.site.trim()||"default");const d=await L(h,U);b(d?{success:d.connected,message:d.message||(d.connected?"Connexion rÃ©ussie ! Vous pouvez maintenant sauvegarder.":"Ã‰chec de la connexion. VÃ©rifiez vos identifiants et l'URL.")}:{success:!1,message:"Test de connexion impossible (voir logs backend)"}),await S()}catch(P){b({success:!1,message:P instanceof Error?P.message:"Erreur lors du test de connexion"})}finally{T(!1)}},t=async()=>{u(!0),b(null);const $=s();if(!$.valid){b({success:!1,message:$.error||"Veuillez remplir tous les champs requis"}),u(!1);return}try{await A(h,{settings:i})?(await S(),await L(h),await S(),c()):b({success:!1,message:"Erreur lors de la sauvegarde de la configuration"})}catch(P){b({success:!1,message:P instanceof Error?P.message:"Erreur lors de la sauvegarde"})}finally{u(!1)}},H=(()=>{switch(h){case"unifi":return"purple";case"freebox":return"blue";default:return"gray"}})(),Z=H==="purple"?"bg-purple-500/20":H==="blue"?"bg-blue-500/20":"bg-gray-500/20",se=H==="purple"?"text-purple-400":H==="blue"?"text-blue-400":"text-gray-400";return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-[#151515] w-full max-w-md rounded-2xl border border-gray-800 shadow-2xl overflow-hidden max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-800 bg-[#1a1a1a]",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`p-1.5 ${Z} rounded-lg`,children:e.jsx($e,{size:20,className:se})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-bold text-white",children:["Configuration ",v.name]}),e.jsx("p",{className:"text-xs text-gray-500",children:"ParamÃ¨tres de connexion"})]})]}),e.jsx("button",{onClick:c,className:"p-1.5 hover:bg-gray-800 rounded-lg text-gray-400 hover:text-white transition-colors",children:e.jsx(ls,{size:20})})]}),e.jsxs("form",{onSubmit:$=>{$.preventDefault(),t()},className:"p-4 space-y-4",children:[h==="unifi"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Mode de connexion"}),e.jsxs("select",{value:i.apiMode||"controller",onChange:$=>o("apiMode",$.target.value),className:"w-full px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500",children:[e.jsx("option",{value:"controller",children:"Controller Local (URL/User/Pass)"}),e.jsx("option",{value:"site-manager",children:"Site Manager API (ClÃ© API)"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:i.apiMode==="site-manager"?"Utilise l'API cloud UniFi Site Manager (unifi.ui.com)":"Utilise l'API locale du Controller UniFi"})]}),h==="unifi"&&i.apiMode==="site-manager"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["ClÃ© API Site Manager ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:x?"text":"password",value:i.apiKey||"",onChange:$=>o("apiKey",$.target.value),placeholder:"Votre clÃ© API UniFi Site Manager",className:`w-full px-3 py-2 bg-[#1a1a1a] border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 pr-10 ${!i.apiKey||!i.apiKey.trim()?"border-red-600 focus:ring-red-500":"border-gray-700"}`}),e.jsx("button",{type:"button",onClick:()=>j(!x),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white",children:x?e.jsx(Ke,{size:18}):e.jsx(Je,{size:18})})]}),(!i.apiKey||!i.apiKey.trim())&&e.jsx("div",{className:"mt-2 p-2 bg-red-500/10 border border-red-500/30 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2 text-red-400 text-xs",children:[e.jsx(ce,{size:14}),e.jsx("span",{children:"âš ï¸ La clÃ© API est requise pour le mode Site Manager"})]})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Obtenez votre clÃ© API sur"," ",e.jsx("a",{href:"https://unifi.ui.com/api",target:"_blank",rel:"noopener noreferrer",className:"text-purple-400 hover:underline",children:"unifi.ui.com/api"})," ","(Documentation:"," ",e.jsx("a",{href:"https://developer.ui.com/site-manager-api/gettingstarted/",target:"_blank",rel:"noopener noreferrer",className:"text-purple-400 hover:underline",children:"Site Manager API"}),")"]})]}),h==="unifi"&&i.apiMode==="controller"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["URL du ContrÃ´leur UniFi ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"url",value:i.url,onChange:$=>o("url",$.target.value),placeholder:"https://unifi.example.com:8443",className:"w-full px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:outline-none transition-colors",required:!0,pattern:"https?://.+"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Inclure le port (gÃ©nÃ©ralement 8443)."," ",e.jsx("span",{className:"text-yellow-400",children:"âš ï¸ Utilisez un compte administrateur LOCAL (pas un compte cloud) pour Ã©viter les problÃ¨mes de 2FA."})]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Documentation:"," ",e.jsx("a",{href:"https://help.ui.com/hc/en-us/articles/30076656117655-Getting-Started-with-the-Official-UniFi-API",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:underline",children:"UniFi Controller API"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Nom d'utilisateur ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:i.username,onChange:$=>o("username",$.target.value),placeholder:"admin",className:"w-full px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:outline-none transition-colors",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Mot de passe ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:x?"text":"password",value:i.password,onChange:$=>o("password",$.target.value),placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",className:"w-full px-3 py-2 pr-10 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:outline-none transition-colors",required:!0}),e.jsx("button",{type:"button",onClick:()=>j(!x),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 text-gray-400 hover:text-white transition-colors",children:x?e.jsx(Ke,{size:18}):e.jsx(Je,{size:18})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Site UniFi"}),e.jsx("input",{type:"text",value:i.site,onChange:$=>o("site",$.target.value),placeholder:"default",className:"w-full px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:outline-none transition-colors"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Nom du site UniFi (gÃ©nÃ©ralement "default")'})]})]}),h==="freebox"&&e.jsx("div",{className:"p-4 bg-blue-900/20 border border-blue-700 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ce,{size:20,className:"text-blue-400 mt-0.5"}),e.jsxs("div",{className:"text-sm text-gray-300",children:[e.jsx("p",{className:"font-medium mb-1",children:"Configuration Freebox"}),e.jsx("p",{className:"text-gray-400",children:`Le plugin Freebox utilise l'authentification Freebox existante. Configurez la connexion via l'onglet "ParamÃ¨tres" ou utilisez l'API Freebox directement.`})]})]})}),F&&e.jsx("div",{className:`p-3 rounded-lg border ${F.success?"bg-green-900/20 border-green-700":"bg-red-900/20 border-red-700"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[F.success?e.jsx(Se,{size:16,className:"text-green-400"}):e.jsx(ts,{size:16,className:"text-red-400"}),e.jsx("span",{className:`text-sm ${F.success?"text-green-400":"text-red-400"}`,children:F.message})]})}),v.connectionStatus&&e.jsx("div",{className:"p-3 bg-green-900/20 border border-green-700 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{size:16,className:"text-green-400"}),e.jsx("span",{className:"text-sm text-green-400",children:"Plugin connectÃ© et opÃ©rationnel"})]})}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t border-gray-700",children:[e.jsx(ys,{type:"button",onClick:k,disabled:C||y,variant:"secondary",className:"flex-1",children:C?e.jsxs(e.Fragment,{children:[e.jsx(de,{size:16,className:"animate-spin"}),"Test en cours..."]}):e.jsxs(e.Fragment,{children:[e.jsx(de,{size:16}),"Tester"]})}),e.jsx(ys,{type:"submit",disabled:y||C,className:"flex-1",children:y?e.jsxs(e.Fragment,{children:[e.jsx(de,{size:16,className:"animate-spin"}),"Sauvegarde..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{size:16}),"Sauvegarder"]})})]})]})]})})},et=({isOpen:n,onClose:c,devices:h=[]})=>{const[E,A]=r.useState("profiles"),[L,S]=r.useState(!1),[y,u]=r.useState(null),[C,T]=r.useState(null),[F,b]=r.useState([]),[x,j]=r.useState([]),[v,i]=r.useState(null),[f,o]=r.useState([]),[s,k]=r.useState(new Set),[t,D]=r.useState(!1),[H,Z]=r.useState(""),[se,$]=r.useState(!1),[P,U]=r.useState(""),[d,R]=r.useState("denied"),[Q,z]=r.useState("00:00"),[X,N]=r.useState("08:00"),[g,K]=r.useState([!0,!0,!0,!0,!0,!1,!1,!1]),[ee,q]=r.useState(!1),[l,I]=r.useState(null),[O,ae]=r.useState([]),[xe,We]=r.useState("denied"),[Ce,te]=r.useState(30);r.useEffect(()=>{n&&ue()},[n]);const ue=async()=>{var m,w;S(!0),u(null);try{const B=await _.get(J.PROFILES);if(B.success&&B.result)b(B.result);else{if(((m=B.error)==null?void 0:m.code)==="INSUFFICIENT_RIGHTS"){u(`Droits insuffisants. Veuillez ajouter le droit "Gestion des profils utilisateur" Ã  l'application.`),S(!1);return}u(((w=B.error)==null?void 0:w.message)||"Erreur lors du chargement des profils"),S(!1);return}const me=await _.get(J.NETWORK_CONTROL);me.success&&me.result&&j(me.result)}catch(B){console.error("Error fetching parental data:",B),u("Erreur lors du chargement du contrÃ´le parental")}finally{S(!1)}},le=m=>{T(m),setTimeout(()=>T(null),3e3)},ze=m=>x.find(w=>w.profile_id===m)||null,Y=async m=>{try{const w=await _.get(`${J.NETWORK_CONTROL}/${m}/rules`);w.success&&w.result&&o(w.result)}catch(w){console.error("Error fetching rules:",w)}},je=async m=>{const w=new Set(s);w.has(m)?w.delete(m):(w.add(m),await Y(m)),k(w),i(m)},ve=async()=>{var m;if(!H.trim()){u("Veuillez entrer un nom de profil");return}S(!0),u(null);try{const w=await _.post(J.PROFILES,{name:H,url:"/resources/images/profile/profile_01.png"});w.success&&w.result?(await ue(),D(!1),Z(""),le("Profil crÃ©Ã© avec succÃ¨s")):u(((m=w.error)==null?void 0:m.message)||"Erreur lors de la crÃ©ation du profil")}catch{u("Erreur lors de la crÃ©ation du profil")}finally{S(!1)}},Oe=async m=>{var w;if(confirm("Supprimer ce profil ?")){S(!0),u(null);try{const B=await _.delete(`${J.PROFILES}/${m}`);B.success?(b(F.filter(me=>me.id!==m)),le("Profil supprimÃ©")):u(((w=B.error)==null?void 0:w.message)||"Erreur lors de la suppression")}catch{u("Erreur lors de la suppression")}finally{S(!1)}}},Fe=async()=>{var m;if(l!==null){S(!0),u(null);try{const w=await _.put(`${J.NETWORK_CONTROL}/${l}`,{macs:O});w.success?(await ue(),q(!1),I(null),ae([]),le("Appareils assignÃ©s")):u(((m=w.error)==null?void 0:m.message)||"Erreur lors de l'assignation")}catch{u("Erreur lors de l'assignation")}finally{S(!1)}}},Ge=async m=>{var w;S(!0),u(null);try{const B=Math.floor(Date.now()/1e3)+Ce*60,me=await _.put(`${J.NETWORK_CONTROL}/${m}`,{override:!0,override_mode:xe,override_until:B});me.success?(await ue(),le(`Mode temporaire activÃ© pour ${Ce} minutes`)):u(((w=me.error)==null?void 0:w.message)||"Erreur lors de l'activation du mode temporaire")}catch{u("Erreur lors de l'activation du mode temporaire")}finally{S(!1)}},p=async m=>{var w;S(!0),u(null);try{const B=await _.put(`${J.NETWORK_CONTROL}/${m}`,{override:!1});B.success?(await ue(),le("Mode temporaire dÃ©sactivÃ©")):u(((w=B.error)==null?void 0:w.message)||"Erreur lors de la dÃ©sactivation")}catch{u("Erreur lors de la dÃ©sactivation")}finally{S(!1)}},W=async()=>{var m;if(v!==null){if(!P.trim()){u("Veuillez entrer un nom de rÃ¨gle");return}S(!0),u(null);try{const[w,B]=Q.split(":").map(Number),[me,fe]=X.split(":").map(Number),Ue=w*3600+B*60,xs=me*3600+fe*60,cs=await _.post(`${J.NETWORK_CONTROL}/${v}/rules`,{name:P,mode:d,start_time:Ue,end_time:xs,weekdays:g,enabled:!0});cs.success?(await Y(v),$(!1),U(""),le("RÃ¨gle crÃ©Ã©e")):u(((m=cs.error)==null?void 0:m.message)||"Erreur lors de la crÃ©ation de la rÃ¨gle")}catch{u("Erreur lors de la crÃ©ation de la rÃ¨gle")}finally{S(!1)}}},re=async m=>{var w;if(v!==null&&confirm("Supprimer cette rÃ¨gle ?")){S(!0),u(null);try{const B=await _.delete(`${J.NETWORK_CONTROL}/${v}/rules/${m}`);B.success?(await Y(v),le("RÃ¨gle supprimÃ©e")):u(((w=B.error)==null?void 0:w.message)||"Erreur lors de la suppression")}catch{u("Erreur lors de la suppression")}finally{S(!1)}}},Ne=async m=>{var w;if(v!==null){S(!0),u(null);try{const B=await _.put(`${J.NETWORK_CONTROL}/${v}/rules/${m.id}`,{enabled:!m.enabled});B.success?(await Y(v),le(m.enabled?"RÃ¨gle dÃ©sactivÃ©e":"RÃ¨gle activÃ©e")):u(((w=B.error)==null?void 0:w.message)||"Erreur lors de la modification")}catch{u("Erreur lors de la modification")}finally{S(!1)}}},he=m=>{O.includes(m)?ae(O.filter(w=>w!==m)):ae([...O,m])},Ie=m=>{switch(m){case"allowed":return"text-emerald-400 bg-emerald-500/20";case"denied":return"text-red-400 bg-red-500/20";case"webonly":return"text-blue-400 bg-blue-500/20";default:return"text-gray-400 bg-gray-500/20"}},Te=m=>{switch(m){case"allowed":return"AutorisÃ©";case"denied":return"BloquÃ©";case"webonly":return"Web seulement";default:return m}},ge=m=>{switch(m){case"allowed":return e.jsx(Re,{size:14});case"denied":return e.jsx(qs,{size:14});case"webonly":return e.jsx(ss,{size:14});default:return null}},ns=m=>{const w=Math.floor(m/3600),B=Math.floor(m%3600/60);return`${w.toString().padStart(2,"0")}:${B.toString().padStart(2,"0")}`},is=m=>{const w=Math.floor(Date.now()/1e3),B=m-w;return B<=0?"ExpirÃ©":B<60?`${B}s`:B<3600?`${Math.floor(B/60)}min`:`${Math.floor(B/3600)}h ${Math.floor(B%3600/60)}min`},os=["Lun","Mar","Mer","Jeu","Ven","Sam","Dim","Vac"];return n?e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-[#121212] rounded-2xl border border-gray-800 shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-800 bg-[#0f0f0f]",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:e.jsx(ke,{size:20,className:"text-purple-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"ContrÃ´le Parental"}),e.jsx("p",{className:"text-xs text-gray-500",children:"GÃ©rer les restrictions d'accÃ¨s Internet par profil"})]})]}),e.jsx("button",{onClick:c,className:"p-2 hover:bg-gray-800 rounded-lg transition-colors",children:e.jsx(ls,{size:20,className:"text-gray-400"})})]}),e.jsxs("div",{className:"flex border-b border-gray-800 bg-[#0f0f0f]",children:[e.jsxs("button",{onClick:()=>A("profiles"),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors ${E==="profiles"?"text-white border-b-2 border-blue-500":"text-gray-400 hover:text-white"}`,children:[e.jsx(_e,{size:16}),"Profils"]}),e.jsxs("button",{onClick:()=>A("rules"),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors ${E==="rules"?"text-white border-b-2 border-blue-500":"text-gray-400 hover:text-white"}`,children:[e.jsx(es,{size:16}),"Planification"]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[y&&e.jsxs("div",{className:"mb-4 p-3 bg-red-900/20 border border-red-700/50 rounded-lg flex items-center gap-2",children:[e.jsx(ce,{size:16,className:"text-red-400"}),e.jsx("span",{className:"text-sm text-red-400",children:y})]}),C&&e.jsxs("div",{className:"mb-4 p-3 bg-emerald-900/20 border border-emerald-700/50 rounded-lg flex items-center gap-2",children:[e.jsx(Xe,{size:16,className:"text-emerald-400"}),e.jsx("span",{className:"text-sm text-emerald-400",children:C})]}),L&&e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(ie,{size:24,className:"text-gray-400 animate-spin"})}),!L&&E==="profiles"&&e.jsxs("div",{className:"space-y-4",children:[!t&&e.jsxs("button",{onClick:()=>D(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors",children:[e.jsx(Pe,{size:16}),"Nouveau profil"]}),t&&e.jsxs("div",{className:"p-4 bg-[#1a1a1a] rounded-xl border border-gray-700 space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium text-white",children:"Nouveau profil"}),e.jsx("input",{type:"text",value:H,onChange:m=>Z(m.target.value),placeholder:"Nom du profil (ex: Enfants)",className:"w-full px-3 py-2 bg-[#252525] border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:outline-none"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:ve,disabled:L,className:"flex items-center gap-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-500 text-white rounded-lg transition-colors disabled:opacity-50",children:[e.jsx(ne,{size:16}),"CrÃ©er"]}),e.jsx("button",{onClick:()=>{D(!1),Z("")},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Annuler"})]})]}),e.jsxs("div",{className:"space-y-2",children:[F.length===0&&!t&&e.jsxs("div",{className:"py-8 text-center text-gray-500",children:[e.jsx(ms,{size:32,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"Aucun profil configurÃ©"}),e.jsx("p",{className:"text-xs mt-1",children:"CrÃ©ez un profil pour gÃ©rer l'accÃ¨s Internet de certains appareils"})]}),F.map(m=>{var me;const w=ze(m.id),B=s.has(m.id);return e.jsxs("div",{className:"bg-[#1a1a1a] rounded-xl border border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"p-4 flex items-center justify-between cursor-pointer hover:bg-gray-800/30",onClick:()=>je(m.id),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[B?e.jsx(zs,{size:16,className:"text-gray-400"}):e.jsx(Os,{size:16,className:"text-gray-400"}),e.jsx("div",{className:"p-2 bg-gray-700 rounded-lg",children:e.jsx(ms,{size:16,className:"text-gray-300"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-white",children:m.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[w&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs ${Ie(w.current_mode)}`,children:[ge(w.current_mode),Te(w.current_mode)]}),w.override&&e.jsxs("span",{className:"text-xs text-orange-400",children:["(Temporaire: ",is(w.override_until),")"]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[w.macs.length," appareil(s)"]})]}),!w&&e.jsx("span",{className:"text-xs text-gray-500",children:"Aucun appareil assignÃ©"})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",onClick:fe=>fe.stopPropagation(),children:e.jsx("button",{onClick:()=>Oe(m.id),className:"p-2 hover:bg-red-900/50 rounded-lg transition-colors",title:"Supprimer",children:e.jsx(we,{size:14,className:"text-red-400"})})})]}),B&&e.jsxs("div",{className:"border-t border-gray-700 p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-400 uppercase",children:"Appareils"}),e.jsx("button",{onClick:()=>{I(m.id),ae((w==null?void 0:w.macs)||[]),q(!0)},className:"text-xs text-blue-400 hover:text-blue-300",children:"Modifier"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[(me=w==null?void 0:w.hosts)==null?void 0:me.map((fe,Ue)=>e.jsxs("span",{className:"text-xs text-gray-300 bg-gray-800 px-2 py-1 rounded flex items-center gap-1",children:[e.jsx(vs,{size:12}),fe]},Ue)),(w==null?void 0:w.macs)&&w.macs.length>0&&(!w.hosts||w.hosts.length===0)&&w.macs.map((fe,Ue)=>e.jsx("span",{className:"text-xs text-gray-500 font-mono bg-gray-800 px-2 py-1 rounded",children:fe},Ue)),(!w||w.macs.length===0)&&e.jsx("span",{className:"text-xs text-gray-500",children:"Aucun appareil assignÃ©"})]})]}),w&&e.jsxs("div",{className:"p-3 bg-[#252525] rounded-lg",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-400 uppercase mb-3",children:"Mode temporaire"}),w.override?e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded text-sm ${Ie(w.override_mode)}`,children:[ge(w.override_mode),Te(w.override_mode)]}),e.jsxs("span",{className:"text-sm text-gray-400",children:["pendant encore ",is(w.override_until)]})]}),e.jsxs("button",{onClick:()=>p(m.id),className:"flex items-center gap-1 px-3 py-1.5 bg-gray-700 hover:bg-gray-600 text-white rounded-lg text-sm",children:[e.jsx(Us,{size:14}),"DÃ©sactiver"]})]}):e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsxs("select",{value:xe,onChange:fe=>We(fe.target.value),className:"px-3 py-1.5 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm",children:[e.jsx("option",{value:"allowed",children:"AutorisÃ©"}),e.jsx("option",{value:"denied",children:"BloquÃ©"}),e.jsx("option",{value:"webonly",children:"Web seulement"})]}),e.jsx("span",{className:"text-gray-400 text-sm",children:"pendant"}),e.jsxs("select",{value:Ce,onChange:fe=>te(parseInt(fe.target.value)),className:"px-3 py-1.5 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm",children:[e.jsx("option",{value:"15",children:"15 min"}),e.jsx("option",{value:"30",children:"30 min"}),e.jsx("option",{value:"60",children:"1 heure"}),e.jsx("option",{value:"120",children:"2 heures"}),e.jsx("option",{value:"240",children:"4 heures"})]}),e.jsxs("button",{onClick:()=>Ge(m.id),className:"flex items-center gap-1 px-3 py-1.5 bg-blue-600 hover:bg-blue-500 text-white rounded-lg text-sm",children:[e.jsx(He,{size:14}),"Activer"]})]})]})]})]},m.id)})]}),ee&&e.jsx("div",{className:"fixed inset-0 z-[110] flex items-center justify-center bg-black/60 p-4",children:e.jsxs("div",{className:"bg-[#1a1a1a] rounded-xl border border-gray-700 w-full max-w-md max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsx("div",{className:"p-4 border-b border-gray-700",children:e.jsx("h3",{className:"text-sm font-medium text-white",children:"Assigner des appareils"})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[h.filter(m=>m.mac).map(m=>e.jsxs("label",{className:"flex items-center gap-3 px-3 py-2 hover:bg-gray-700/50 cursor-pointer rounded-lg",children:[e.jsx("input",{type:"checkbox",checked:O.includes(m.mac),onChange:()=>he(m.mac),className:"w-4 h-4 rounded border-gray-600 bg-gray-700 text-blue-500 focus:ring-0 focus:outline-none"}),e.jsx(vs,{size:14,className:"text-gray-400"}),e.jsx("span",{className:"text-sm text-white",children:m.name}),e.jsx("span",{className:"text-xs text-gray-500 font-mono",children:m.mac})]},m.id)),h.filter(m=>m.mac).length===0&&e.jsx("p",{className:"px-3 py-4 text-sm text-gray-500 text-center",children:"Aucun appareil disponible"})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex gap-2",children:[e.jsxs("button",{onClick:Fe,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg",children:[e.jsx(ne,{size:16}),"Enregistrer"]}),e.jsx("button",{onClick:()=>{q(!1),I(null),ae([])},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg",children:"Annuler"})]})]})})]}),!L&&E==="rules"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"SÃ©lectionner un profil"}),e.jsxs("select",{value:v||"",onChange:m=>{const w=parseInt(m.target.value);w?(i(w),Y(w)):(i(null),o([]))},className:"w-full px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:outline-none",children:[e.jsx("option",{value:"",children:"SÃ©lectionner..."}),F.map(m=>e.jsx("option",{value:m.id,children:m.name},m.id))]})]}),v&&e.jsxs(e.Fragment,{children:[!se&&e.jsxs("button",{onClick:()=>$(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors",children:[e.jsx(Pe,{size:16}),"Nouvelle rÃ¨gle"]}),se&&e.jsxs("div",{className:"p-4 bg-[#1a1a1a] rounded-xl border border-gray-700 space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium text-white",children:"Nouvelle rÃ¨gle de planification"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Nom"}),e.jsx("input",{type:"text",value:P,onChange:m=>U(m.target.value),placeholder:"Ex: Nuit (blocage)",className:"w-full px-3 py-2 bg-[#252525] border border-gray-700 rounded-lg text-white text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Mode"}),e.jsx("div",{className:"flex gap-2",children:["allowed","denied","webonly"].map(m=>e.jsxs("button",{onClick:()=>R(m),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm transition-colors ${d===m?Ie(m):"bg-gray-800 text-gray-400 hover:text-white"}`,children:[ge(m),Te(m)]},m))})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"De"}),e.jsx("input",{type:"time",value:Q,onChange:m=>z(m.target.value),className:"w-full px-3 py-2 bg-[#252525] border border-gray-700 rounded-lg text-white text-sm"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Ã€"}),e.jsx("input",{type:"time",value:X,onChange:m=>N(m.target.value),className:"w-full px-3 py-2 bg-[#252525] border border-gray-700 rounded-lg text-white text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-2",children:"Jours"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:os.map((m,w)=>e.jsx("button",{onClick:()=>{const B=[...g];B[w]=!B[w],K(B)},className:`px-3 py-1.5 rounded-lg text-xs font-medium transition-colors ${g[w]?"bg-blue-600 text-white":"bg-gray-800 text-gray-400 hover:text-white"}`,children:m},m))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:W,disabled:L,className:"flex items-center gap-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-500 text-white rounded-lg transition-colors disabled:opacity-50",children:[e.jsx(ne,{size:16}),"CrÃ©er"]}),e.jsx("button",{onClick:()=>{$(!1),U("")},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Annuler"})]})]}),e.jsxs("div",{className:"space-y-2",children:[f.length===0&&!se&&e.jsxs("div",{className:"py-8 text-center text-gray-500",children:[e.jsx(es,{size:32,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"Aucune rÃ¨gle de planification"}),e.jsx("p",{className:"text-xs mt-1",children:"Les rÃ¨gles dÃ©finissent automatiquement le mode d'accÃ¨s selon l'heure"})]}),f.map(m=>e.jsx("div",{className:`p-4 bg-[#1a1a1a] rounded-xl border border-gray-700 ${m.enabled?"":"opacity-60"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h4",{className:"text-sm font-medium text-white",children:m.name}),e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs ${Ie(m.mode)}`,children:[ge(m.mode),Te(m.mode)]}),!m.enabled&&e.jsx("span",{className:"text-xs text-gray-500",children:"(DÃ©sactivÃ©)"})]}),e.jsxs("div",{className:"mt-1 flex items-center gap-2 text-xs text-gray-400",children:[e.jsx(es,{size:12}),ns(m.start_time)," - ",ns(m.end_time),e.jsx("span",{className:"text-gray-600",children:"|"}),os.filter((w,B)=>m.weekdays[B]).join(", ")]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>Ne(m),className:`p-2 rounded-lg transition-colors ${m.enabled?"hover:bg-gray-700 text-emerald-400":"hover:bg-gray-700 text-gray-500"}`,title:m.enabled?"DÃ©sactiver":"Activer",children:e.jsx(He,{size:14})}),e.jsx("button",{onClick:()=>re(m.id),className:"p-2 hover:bg-red-900/50 rounded-lg transition-colors",title:"Supprimer",children:e.jsx(we,{size:14,className:"text-red-400"})})]})]})},m.id))]})]}),!v&&e.jsxs("div",{className:"py-8 text-center text-gray-500",children:[e.jsx(_e,{size:32,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"SÃ©lectionnez un profil pour gÃ©rer ses rÃ¨gles"})]})]})]})]})}):null},st=({isOpen:n,onClose:c,devices:h=[]})=>{const[E,A]=r.useState("rules"),[L,S]=r.useState(!1),[y,u]=r.useState(null),[C,T]=r.useState(null),[F,b]=r.useState([]),[x,j]=r.useState(null),[v,i]=r.useState(!1),[f,o]=r.useState({enabled:!0,ip_proto:"tcp",wan_port_start:0,lan_port:0,lan_ip:"",comment:""}),[s,k]=r.useState(null);r.useEffect(()=>{n&&t()},[n]);const t=async()=>{S(!0),u(null);try{const d=await _.get(`${J.SETTINGS_NAT}/redirections`);d.success&&d.result&&b(d.result);const R=await _.get(`${J.SETTINGS_NAT}/dmz`);R.success&&R.result&&k(R.result)}catch(d){const R=d==null?void 0:d.error_code;u(R==="insufficient_rights"?`Droits insuffisants. Veuillez rÃ©enregistrer l'application avec les droits "Modification des rÃ©glages".`:"Erreur lors du chargement des rÃ¨gles de pare-feu")}finally{S(!1)}},D=d=>{T(d),setTimeout(()=>T(null),3e3)},H=async()=>{var d;if(!f.lan_ip||!f.wan_port_start||!f.lan_port){u("Veuillez remplir tous les champs obligatoires");return}S(!0),u(null);try{const R=await _.post(`${J.SETTINGS_NAT}/redirections`,{enabled:f.enabled,ip_proto:f.ip_proto,wan_port_start:f.wan_port_start,wan_port_end:f.wan_port_end||f.wan_port_start,lan_port:f.lan_port,lan_ip:f.lan_ip,comment:f.comment||"",src_ip:f.src_ip||""});R.success&&R.result?(b([...F,R.result]),i(!1),o({enabled:!0,ip_proto:"tcp",wan_port_start:0,lan_port:0,lan_ip:"",comment:""}),D("RÃ¨gle crÃ©Ã©e avec succÃ¨s")):u(((d=R.error)==null?void 0:d.message)||"Erreur lors de la crÃ©ation")}catch{u("Erreur lors de la crÃ©ation de la rÃ¨gle")}finally{S(!1)}},Z=async d=>{var R;S(!0),u(null);try{const Q=await _.put(`${J.SETTINGS_NAT}/redirections/${d.id}`,{enabled:d.enabled,ip_proto:d.ip_proto,wan_port_start:d.wan_port_start,wan_port_end:d.wan_port_end||d.wan_port_start,lan_port:d.lan_port,lan_ip:d.lan_ip,comment:d.comment||""});Q.success&&Q.result?(b(F.map(z=>z.id===d.id?Q.result:z)),j(null),D("RÃ¨gle mise Ã  jour")):u(((R=Q.error)==null?void 0:R.message)||"Erreur lors de la mise Ã  jour")}catch{u("Erreur lors de la mise Ã  jour")}finally{S(!1)}},se=async d=>{await Z({...d,enabled:!d.enabled})},$=async d=>{var R;if(confirm("Supprimer cette rÃ¨gle de redirection ?")){S(!0),u(null);try{const Q=await _.delete(`${J.SETTINGS_NAT}/redirections/${d}`);Q.success?(b(F.filter(z=>z.id!==d)),D("RÃ¨gle supprimÃ©e")):u(((R=Q.error)==null?void 0:R.message)||"Erreur lors de la suppression")}catch{u("Erreur lors de la suppression")}finally{S(!1)}}},P=async()=>{var d;if(s){S(!0),u(null);try{const R=await _.put(`${J.SETTINGS_NAT}/dmz`,s);R.success?D("Configuration DMZ mise Ã  jour"):u(((d=R.error)==null?void 0:d.message)||"Erreur lors de la mise Ã  jour")}catch{u("Erreur lors de la mise Ã  jour")}finally{S(!1)}}},U=d=>{switch(d){case"tcp":return"TCP";case"udp":return"UDP";case"tcp_udp":return"TCP+UDP";default:return d.toUpperCase()}};return n?e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-[#121212] rounded-2xl border border-gray-800 shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-800 bg-[#0f0f0f]",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-orange-500/20 rounded-lg",children:e.jsx(ke,{size:20,className:"text-orange-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Pare-feu"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Redirection de ports et DMZ"})]})]}),e.jsx("button",{onClick:c,className:"p-2 hover:bg-gray-800 rounded-lg transition-colors",children:e.jsx(ls,{size:20,className:"text-gray-400"})})]}),e.jsxs("div",{className:"flex border-b border-gray-800 bg-[#0f0f0f]",children:[e.jsxs("button",{onClick:()=>A("rules"),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors ${E==="rules"?"text-white border-b-2 border-blue-500":"text-gray-400 hover:text-white"}`,children:[e.jsx(Ve,{size:16}),"Redirections"]}),e.jsxs("button",{onClick:()=>A("dmz"),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors ${E==="dmz"?"text-white border-b-2 border-blue-500":"text-gray-400 hover:text-white"}`,children:[e.jsx(Re,{size:16}),"DMZ"]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[y&&e.jsxs("div",{className:"mb-4 p-3 bg-red-900/20 border border-red-700/50 rounded-lg flex items-center gap-2",children:[e.jsx(ce,{size:16,className:"text-red-400"}),e.jsx("span",{className:"text-sm text-red-400",children:y})]}),C&&e.jsxs("div",{className:"mb-4 p-3 bg-emerald-900/20 border border-emerald-700/50 rounded-lg flex items-center gap-2",children:[e.jsx(Xe,{size:16,className:"text-emerald-400"}),e.jsx("span",{className:"text-sm text-emerald-400",children:C})]}),L&&e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(ie,{size:24,className:"text-gray-400 animate-spin"})}),!L&&E==="rules"&&e.jsxs("div",{className:"space-y-4",children:[!v&&e.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors",children:[e.jsx(Pe,{size:16}),"Nouvelle redirection"]}),v&&e.jsxs("div",{className:"p-4 bg-[#1a1a1a] rounded-xl border border-gray-700 space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium text-white",children:"Nouvelle redirection de port"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Protocole"}),e.jsxs("select",{value:f.ip_proto,onChange:d=>o({...f,ip_proto:d.target.value}),className:"w-full px-3 py-2 bg-[#252525] border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:outline-none",children:[e.jsx("option",{value:"tcp",children:"TCP"}),e.jsx("option",{value:"udp",children:"UDP"}),e.jsx("option",{value:"tcp_udp",children:"TCP + UDP"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Port externe (WAN)"}),e.jsx("input",{type:"number",value:f.wan_port_start||"",onChange:d=>o({...f,wan_port_start:parseInt(d.target.value)||0}),placeholder:"Ex: 8080",min:"1",max:"65535",className:"w-full px-3 py-2 bg-[#252525] border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"IP destination (LAN)"}),e.jsxs("select",{value:f.lan_ip,onChange:d=>o({...f,lan_ip:d.target.value}),className:"w-full px-3 py-2 bg-[#252525] border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:outline-none",children:[e.jsx("option",{value:"",children:"SÃ©lectionner un appareil..."}),h.filter(d=>d.ip).map(d=>e.jsxs("option",{value:d.ip,children:[d.name," (",d.ip,")"]},d.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Port destination (LAN)"}),e.jsx("input",{type:"number",value:f.lan_port||"",onChange:d=>o({...f,lan_port:parseInt(d.target.value)||0}),placeholder:"Ex: 80",min:"1",max:"65535",className:"w-full px-3 py-2 bg-[#252525] border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:outline-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Commentaire (optionnel)"}),e.jsx("input",{type:"text",value:f.comment||"",onChange:d=>o({...f,comment:d.target.value}),placeholder:"Ex: Serveur web",className:"w-full px-3 py-2 bg-[#252525] border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:outline-none"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:f.enabled,onChange:d=>o({...f,enabled:d.target.checked}),className:"w-4 h-4 rounded border-gray-600 bg-gray-700 text-blue-500 focus:ring-0 focus:outline-none"}),e.jsx("span",{className:"text-sm text-white",children:"Activer immÃ©diatement"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:H,disabled:L,className:"flex items-center gap-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-500 text-white rounded-lg transition-colors disabled:opacity-50",children:[e.jsx(ne,{size:16}),"CrÃ©er"]}),e.jsx("button",{onClick:()=>{i(!1),o({enabled:!0,ip_proto:"tcp",wan_port_start:0,lan_port:0,lan_ip:"",comment:""})},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Annuler"})]})]}),e.jsxs("div",{className:"space-y-2",children:[F.length===0&&!v&&e.jsxs("div",{className:"py-8 text-center text-gray-500",children:[e.jsx(Ve,{size:32,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"Aucune redirection de port configurÃ©e"}),e.jsx("p",{className:"text-xs mt-1",children:"Les redirections permettent d'exposer des services internes sur Internet"})]}),F.map(d=>e.jsx("div",{className:"p-4 bg-[#1a1a1a] rounded-xl border border-gray-700 group",children:(x==null?void 0:x.id)===d.id?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("select",{value:x.ip_proto,onChange:R=>j({...x,ip_proto:R.target.value}),className:"px-3 py-2 bg-[#252525] border border-gray-700 rounded-lg text-white text-sm",children:[e.jsx("option",{value:"tcp",children:"TCP"}),e.jsx("option",{value:"udp",children:"UDP"}),e.jsx("option",{value:"tcp_udp",children:"TCP + UDP"})]}),e.jsx("input",{type:"number",value:x.wan_port_start,onChange:R=>j({...x,wan_port_start:parseInt(R.target.value)||0}),placeholder:"Port WAN",className:"px-3 py-2 bg-[#252525] border border-gray-700 rounded-lg text-white text-sm"}),e.jsx("input",{type:"text",value:x.lan_ip,onChange:R=>j({...x,lan_ip:R.target.value}),placeholder:"IP LAN",className:"px-3 py-2 bg-[#252525] border border-gray-700 rounded-lg text-white text-sm font-mono"}),e.jsx("input",{type:"number",value:x.lan_port,onChange:R=>j({...x,lan_port:parseInt(R.target.value)||0}),placeholder:"Port LAN",className:"px-3 py-2 bg-[#252525] border border-gray-700 rounded-lg text-white text-sm"})]}),e.jsx("input",{type:"text",value:x.comment||"",onChange:R=>j({...x,comment:R.target.value}),placeholder:"Commentaire",className:"w-full px-3 py-2 bg-[#252525] border border-gray-700 rounded-lg text-white text-sm"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>Z(x),className:"flex items-center gap-2 px-3 py-1.5 bg-emerald-600 hover:bg-emerald-500 text-white rounded-lg text-sm",children:[e.jsx(ne,{size:14}),"Enregistrer"]}),e.jsx("button",{onClick:()=>j(null),className:"px-3 py-1.5 bg-gray-700 hover:bg-gray-600 text-white rounded-lg text-sm",children:"Annuler"})]})]}):e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>se(d),className:`p-1 rounded transition-colors ${d.enabled?"text-emerald-400 hover:bg-emerald-900/30":"text-gray-600 hover:bg-gray-700"}`,title:d.enabled?"DÃ©sactiver":"Activer",children:e.jsx(He,{size:16})}),e.jsx("h4",{className:"text-sm font-medium text-white",children:d.comment||`Port ${d.wan_port_start}`}),e.jsx("span",{className:"px-2 py-0.5 bg-blue-500/20 text-blue-400 rounded text-xs",children:U(d.ip_proto)})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1 ml-8",children:[":",d.wan_port_start,d.wan_port_end&&d.wan_port_end!==d.wan_port_start?`-${d.wan_port_end}`:""," â†’ ",d.lan_ip,":",d.lan_port]})]}),e.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>j(d),className:"p-2 hover:bg-gray-700 rounded-lg transition-colors",title:"Modifier",children:e.jsx(hs,{size:14,className:"text-gray-400"})}),e.jsx("button",{onClick:()=>$(d.id),className:"p-2 hover:bg-red-900/50 rounded-lg transition-colors",title:"Supprimer",children:e.jsx(we,{size:14,className:"text-red-400"})})]})]})},d.id))]})]}),!L&&E==="dmz"&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"p-4 bg-[#1a1a1a] rounded-xl border border-gray-700",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-orange-500/20 rounded-lg",children:e.jsx(Re,{size:20,className:"text-orange-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-white",children:"Zone dÃ©militarisÃ©e (DMZ)"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Expose un appareil directement sur Internet. Utilisez avec prÃ©caution !"})]})]}),e.jsx("div",{className:"p-3 bg-orange-900/20 border border-orange-700/50 rounded-lg mb-4",children:e.jsxs("p",{className:"text-xs text-orange-400",children:[e.jsx("strong",{children:"Attention :"})," L'appareil en DMZ est exposÃ© sans protection du pare-feu. Utilisez uniquement si vous savez ce que vous faites."]})}),s&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex items-center justify-between py-3 border-b border-gray-800",children:[e.jsx("span",{className:"text-sm text-white",children:"Activer la DMZ"}),e.jsx("button",{onClick:()=>k({...s,enabled:!s.enabled}),className:`relative w-11 h-6 rounded-full transition-colors ${s.enabled?"bg-orange-500":"bg-gray-600"}`,children:e.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 rounded-full bg-white transition-transform ${s.enabled?"translate-x-5":"translate-x-0"}`})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Appareil en DMZ"}),e.jsxs("select",{value:s.ip,onChange:d=>k({...s,ip:d.target.value}),disabled:!s.enabled,className:`w-full px-3 py-2 bg-[#252525] border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:outline-none ${s.enabled?"":"opacity-50"}`,children:[e.jsx("option",{value:"",children:"Aucun appareil"}),h.filter(d=>d.ip).map(d=>e.jsxs("option",{value:d.ip,children:[d.name," (",d.ip,")"]},d.id))]})]}),e.jsxs("button",{onClick:P,disabled:L,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors disabled:opacity-50",children:[e.jsx(ne,{size:16}),"Enregistrer"]})]})]})})]})]})}):null},tt=({isOpen:n,onClose:c})=>{const[h,E]=r.useState("server"),[A,L]=r.useState(!1),[S,y]=r.useState(null),[u,C]=r.useState(null),[T,F]=r.useState([]),[b,x]=r.useState({login:"",password:"",ip_reservation:""}),[j,v]=r.useState(!1),[i,f]=r.useState(!1),[o,s]=r.useState([]),[k,t]=r.useState(null),[D,H]=r.useState([]),[Z,se]=r.useState(null);r.useEffect(()=>{n&&$()},[n,h]);const $=async()=>{L(!0),y(null);try{if(h==="users"){const l=await _.get("/api/settings/vpn/users");l.success&&l.result&&F(l.result)}else if(h==="server"){const l=await _.get("/api/settings/vpn/servers");console.log("[VPN] Servers response:",l),l.success&&l.result&&s(l.result)}else if(h==="connections"){const l=await _.get("/api/settings/vpn/connections");l.success&&l.result&&H(l.result)}}catch(l){console.error("[VPN] Fetch error:",l),y("Erreur lors du chargement des donnÃ©es VPN")}finally{L(!1)}},P=async()=>{var l;if(!b.login||!b.password){y("Le login et le mot de passe sont requis");return}if(b.password.length<8||b.password.length>32){y("Le mot de passe doit contenir entre 8 et 32 caractÃ¨res");return}f(!0),y(null);try{const I={login:b.login,password:b.password};b.ip_reservation&&(I.ip_reservation=b.ip_reservation);const O=await _.post("/api/settings/vpn/users",I);O.success?(C("Utilisateur crÃ©Ã© avec succÃ¨s"),x({login:"",password:"",ip_reservation:""}),setTimeout(()=>C(null),3e3),$()):y(((l=O.error)==null?void 0:l.message)||"Erreur lors de la crÃ©ation")}catch(I){console.error("[VPN] Create user error:",I),y("Erreur lors de la crÃ©ation de l'utilisateur")}finally{f(!1)}},U=async l=>{var I;if(confirm(`Supprimer l'utilisateur "${l}" ?`)){y(null);try{const O=await _.delete(`/api/settings/vpn/users/${l}`);O.success?(C("Utilisateur supprimÃ©"),setTimeout(()=>C(null),3e3),$()):y(((I=O.error)==null?void 0:I.message)||"Erreur lors de la suppression")}catch(O){console.error("[VPN] Delete user error:",O),y("Erreur lors de la suppression")}}},d=async(l,I)=>{var O;t(l),y(null);try{const ae=I==="started"?"stop":"start",xe=await _.post(`/api/settings/vpn/servers/${l}/${ae}`);xe.success?(C(`Serveur ${ae==="start"?"dÃ©marrÃ©":"arrÃªtÃ©"}`),setTimeout(()=>C(null),3e3),setTimeout($,500)):y(((O=xe.error)==null?void 0:O.message)||"Erreur lors de l'opÃ©ration")}catch(ae){console.error("[VPN] Toggle server error:",ae),y("Erreur lors de l'opÃ©ration")}finally{t(null)}},R=async(l,I)=>{try{window.open(`/api/settings/vpn/servers/${I}/download/${l}`,"_blank")}catch(O){console.error("[VPN] Download config error:",O),y("Erreur lors du tÃ©lÃ©chargement de la configuration")}},Q=(l,I)=>{navigator.clipboard.writeText(l),se(I),setTimeout(()=>se(null),2e3)},z=l=>{if(l===0)return"0 B";const I=1024,O=["B","KB","MB","GB"],ae=Math.floor(Math.log(l)/Math.log(I));return parseFloat((l/Math.pow(I,ae)).toFixed(1))+" "+O[ae]},X=l=>{const O=Math.floor(Date.now()/1e3)-l;return O<60?`${O}s`:O<3600?`${Math.floor(O/60)}m`:`${Math.floor(O/3600)}h ${Math.floor(O%3600/60)}m`},N=l=>({openvpn_routed:"OpenVPN RoutÃ©",openvpn_bridge:"OpenVPN Bridge",pptp:"PPTP",wireguard:"WireGuard"})[l]||l,g=l=>({openvpn_routed:"AccÃ¨s routÃ© au rÃ©seau local",openvpn_bridge:"AccÃ¨s en pont au rÃ©seau (mÃªme sous-rÃ©seau)",pptp:"Protocole legacy - Non recommandÃ©",wireguard:"Protocole moderne, rapide et sÃ©curisÃ©"})[l]||"",K=l=>l.includes("wireguard")?"ğŸ”’":l.includes("openvpn")?"ğŸ”":l.includes("pptp")?"âš ï¸":"ğŸ›¡ï¸",ee=l=>{switch(l){case"started":return"text-emerald-400 bg-emerald-500/20";case"starting":case"stopping":return"text-yellow-400 bg-yellow-500/20";case"error":return"text-red-400 bg-red-500/20";default:return"text-gray-400 bg-gray-500/20"}},q=l=>{switch(l){case"started":return"Actif";case"starting":return"DÃ©marrage...";case"stopping":return"ArrÃªt...";case"error":return"Erreur";default:return"ArrÃªtÃ©"}};return n?e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-[#121212] rounded-2xl border border-gray-800 shadow-2xl w-full max-w-3xl max-h-[85vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-800 bg-[#0f0f0f] rounded-t-2xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/20 rounded-lg",children:e.jsx(ke,{size:20,className:"text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Serveur VPN"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Gestion des serveurs et utilisateurs VPN"})]})]}),e.jsx("button",{onClick:c,className:"p-2 hover:bg-gray-800 rounded-lg text-gray-400 hover:text-white transition-colors",children:e.jsx(ls,{size:20})})]}),e.jsxs("div",{className:"flex border-b border-gray-800 bg-[#0f0f0f]",children:[e.jsxs("button",{onClick:()=>E("server"),className:`flex-1 flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium transition-colors ${h==="server"?"text-blue-400 border-b-2 border-blue-400 bg-blue-500/5":"text-gray-400 hover:text-white"}`,children:[e.jsx(Ve,{size:16}),"Serveurs"]}),e.jsxs("button",{onClick:()=>E("users"),className:`flex-1 flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium transition-colors ${h==="users"?"text-blue-400 border-b-2 border-blue-400 bg-blue-500/5":"text-gray-400 hover:text-white"}`,children:[e.jsx(_e,{size:16}),"Utilisateurs"]}),e.jsxs("button",{onClick:()=>E("connections"),className:`flex-1 flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium transition-colors ${h==="connections"?"text-blue-400 border-b-2 border-blue-400 bg-blue-500/5":"text-gray-400 hover:text-white"}`,children:[e.jsx(ss,{size:16}),"Connexions"]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[S&&e.jsxs("div",{className:"mb-4 p-3 bg-red-900/30 border border-red-700 rounded-lg text-red-400 text-sm flex items-center gap-2",children:[e.jsx(ce,{size:16}),S]}),u&&e.jsxs("div",{className:"mb-4 p-3 bg-emerald-900/30 border border-emerald-700 rounded-lg text-emerald-400 text-sm flex items-center gap-2",children:[e.jsx(Xe,{size:16}),u]}),A?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ie,{size:32,className:"text-blue-400 animate-spin"})}):e.jsxs(e.Fragment,{children:[h==="server"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm text-gray-400",children:"Serveurs VPN disponibles"}),e.jsx("button",{onClick:$,className:"p-2 hover:bg-gray-800 rounded-lg text-gray-400 hover:text-white transition-colors",title:"Actualiser",children:e.jsx(de,{size:16,className:A?"animate-spin":""})})]}),o.length>0?e.jsx("div",{className:"space-y-3",children:o.map(l=>e.jsxs("div",{className:"p-4 bg-[#1a1a1a] rounded-xl border border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-2xl",children:K(l.name)}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-medium",children:N(l.name)}),e.jsx("p",{className:"text-xs text-gray-500",children:g(l.name)})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ee(l.state)}`,children:q(l.state)}),l.connection_count!==void 0&&l.connection_count>0&&e.jsxs("span",{className:"text-xs text-gray-500",children:[l.connection_count," conn."]}),e.jsx("button",{onClick:()=>d(l.name,l.state),disabled:k===l.name||l.state==="starting"||l.state==="stopping",className:"p-2 rounded-lg transition-colors hover:bg-gray-700 disabled:opacity-50",title:l.state==="started"?"ArrÃªter":"DÃ©marrer",children:k===l.name?e.jsx(ie,{size:18,className:"text-blue-400 animate-spin"}):e.jsx(He,{size:18,className:l.state==="started"?"text-emerald-400":"text-gray-400"})})]})]}),l.name==="pptp"&&l.state==="started"&&e.jsx("div",{className:"mt-3 p-2 bg-yellow-900/20 border border-yellow-700/50 rounded-lg",children:e.jsx("p",{className:"text-xs text-yellow-400",children:"âš ï¸ PPTP est considÃ©rÃ© comme non sÃ©curisÃ©. PrÃ©fÃ©rez WireGuard ou OpenVPN."})})]},l.name))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Ve,{size:40,className:"mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Aucun serveur VPN disponible"}),e.jsx("p",{className:"text-xs mt-1",children:"VÃ©rifiez que votre Freebox supporte les serveurs VPN"})]}),e.jsx("div",{className:"p-4 bg-blue-900/20 border border-blue-700/50 rounded-lg",children:e.jsxs("p",{className:"text-xs text-blue-400",children:[e.jsx("strong",{children:"WireGuard"})," : Protocole moderne recommandÃ©",e.jsx("br",{}),e.jsx("strong",{children:"OpenVPN"})," : Compatible avec plus de clients",e.jsx("br",{}),e.jsx("strong",{children:"PPTP"})," : Ã€ Ã©viter - non sÃ©curisÃ©"]})})]}),h==="users"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-[#1a1a1a] rounded-xl border border-gray-800 space-y-3",children:[e.jsxs("h3",{className:"text-sm font-medium text-white flex items-center gap-2",children:[e.jsx(Pe,{size:16,className:"text-blue-400"}),"Nouvel utilisateur"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Login *"}),e.jsx("input",{type:"text",value:b.login,onChange:l=>x({...b,login:l.target.value}),placeholder:"nom_utilisateur",className:"w-full px-3 py-2 bg-[#252525] border border-gray-700 rounded-lg text-white text-sm placeholder-gray-600 focus:outline-none focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Mot de passe * (8-32 car.)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:j?"text":"password",value:b.password,onChange:l=>x({...b,password:l.target.value}),placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",className:"w-full px-3 py-2 pr-10 bg-[#252525] border border-gray-700 rounded-lg text-white text-sm placeholder-gray-600 focus:outline-none focus:outline-none"}),e.jsx("button",{type:"button",onClick:()=>v(!j),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 text-gray-500 hover:text-white",children:j?e.jsx(Ke,{size:16}):e.jsx(Je,{size:16})})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"IP rÃ©servÃ©e (optionnel)"}),e.jsx("input",{type:"text",value:b.ip_reservation,onChange:l=>x({...b,ip_reservation:l.target.value}),placeholder:"ex: 192.168.27.10",className:"w-full px-3 py-2 bg-[#252525] border border-gray-700 rounded-lg text-white text-sm font-mono placeholder-gray-600 focus:outline-none focus:outline-none"})]}),e.jsxs("button",{onClick:P,disabled:i||!b.login||!b.password,className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-500 disabled:bg-gray-700 disabled:text-gray-500 text-white rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2",children:[i?e.jsx(ie,{size:16,className:"animate-spin"}):e.jsx(Pe,{size:16}),"CrÃ©er l'utilisateur"]})]}),T.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm text-gray-400 px-1",children:["Utilisateurs (",T.length,")"]}),T.map(l=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#1a1a1a] rounded-xl border border-gray-800 group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-500/20 flex items-center justify-center",children:e.jsx(_e,{size:18,className:"text-blue-400"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-white font-medium",children:l.login}),l.ip_reservation&&e.jsxs("p",{className:"text-xs text-gray-500 font-mono mt-0.5",children:["IP: ",l.ip_reservation]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o.some(I=>I.name.includes("openvpn")&&I.state==="started")&&e.jsx("button",{onClick:()=>{const I=o.find(O=>O.name.includes("openvpn")&&O.state==="started");I&&R(l.login,I.name)},className:"p-2 text-gray-500 hover:text-blue-400 hover:bg-blue-500/10 rounded-lg transition-colors",title:"TÃ©lÃ©charger config OpenVPN",children:e.jsx(fs,{size:16})}),e.jsx("button",{onClick:()=>Q(l.login,l.login),className:"p-2 text-gray-500 hover:text-white hover:bg-gray-700 rounded-lg transition-colors",title:"Copier le login",children:Z===l.login?e.jsx(Xe,{size:16,className:"text-emerald-400"}):e.jsx(Bs,{size:16})}),e.jsx("button",{onClick:()=>U(l.login),className:"p-2 text-gray-500 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors opacity-0 group-hover:opacity-100",title:"Supprimer",children:e.jsx(we,{size:16})})]})]},l.login))]}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(_e,{size:40,className:"mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Aucun utilisateur VPN configurÃ©"}),e.jsx("p",{className:"text-xs mt-1",children:"CrÃ©ez un utilisateur pour activer l'accÃ¨s VPN"})]})]}),h==="connections"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm text-gray-400",children:"Connexions actives"}),e.jsx("button",{onClick:$,className:"p-2 hover:bg-gray-800 rounded-lg text-gray-400 hover:text-white transition-colors",title:"Actualiser",children:e.jsx(de,{size:16,className:A?"animate-spin":""})})]}),D.length>0?e.jsx("div",{className:"space-y-2",children:D.map(l=>e.jsxs("div",{className:"p-4 bg-[#1a1a1a] rounded-xl border border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-emerald-500/20 flex items-center justify-center",children:e.jsx(ss,{size:16,className:"text-emerald-400"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-white font-medium",children:l.user}),e.jsx("p",{className:"text-xs text-gray-500",children:l.vpn})]})]}),e.jsx("span",{className:"px-2 py-1 bg-emerald-500/20 text-emerald-400 rounded-full text-xs",children:"ConnectÃ©"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"IP source"}),e.jsx("p",{className:"text-white font-mono mt-0.5",children:l.src_ip})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"IP locale"}),e.jsx("p",{className:"text-white font-mono mt-0.5",children:l.local_ip||"--"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Trafic"}),e.jsxs("p",{className:"text-white mt-0.5",children:["â†“",z(l.rx_bytes)," â†‘",z(l.tx_bytes)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"DurÃ©e"}),e.jsx("p",{className:"text-white mt-0.5",children:X(l.auth_time)})]})]})]},l.id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(ss,{size:40,className:"mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Aucune connexion VPN active"}),e.jsx("p",{className:"text-xs mt-1",children:"Les clients connectÃ©s apparaÃ®tront ici"})]})]})]})]})]})}):null},ks=[{value:1,label:"Lundi"},{value:2,label:"Mardi"},{value:3,label:"Mercredi"},{value:4,label:"Jeudi"},{value:5,label:"Vendredi"},{value:6,label:"Samedi"},{value:0,label:"Dimanche"}],rt=({isOpen:n,onClose:c})=>{const{schedule:h,fetchSchedule:E,updateSchedule:A}=Ps(),[L,S]=r.useState(!1),[y,u]=r.useState("simple"),[C,T]=r.useState("03:00"),[F,b]=r.useState([]),[x,j]=r.useState({}),[v,i]=r.useState(!1),[f,o]=r.useState(!1),[s,k]=r.useState(null),[t,D]=r.useState(null);r.useEffect(()=>{n&&H()},[n]);const H=async()=>{i(!0),await E(),i(!1)};r.useEffect(()=>{if(h){S(h.enabled);const P=h.mapping||{};j(P);const U=Object.values(P),d=new Set(U),R=Object.keys(P).map(Number);d.size<=1?(u("simple"),d.size===1&&T(U[0]),b(R)):(u("advanced"),T("03:00"),b(R))}},[h]);const Z=async()=>{o(!0),k(null),D(null);let P={};y==="simple"?F.forEach(d=>{P[d]=C}):P=x,await A({enabled:L,mapping:P})?(D("Planification enregistrÃ©e"),setTimeout(()=>D(null),3e3)):k("Erreur lors de l'enregistrement"),o(!1)},se=P=>{b(U=>U.includes(P)?U.filter(d=>d!==P):[...U,P])},$=(P,U)=>{j(d=>{const R={...d};return U?R[P]=U:delete R[P],R})};return r.useEffect(()=>{if(y==="advanced"){const P={};F.forEach(U=>{P[U]=C}),j(P)}else{const P=Object.values(x);new Set(P).size===1&&T(P[0]),b(Object.keys(x).map(Number))}},[y]),n?e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-[#151515] w-full max-w-lg rounded-2xl border border-gray-800 shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-800 bg-[#1a1a1a]",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"RedÃ©marrage planifiÃ©"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Programmer le redÃ©marrage automatique"})]}),e.jsx("button",{onClick:c,className:"p-2 hover:bg-gray-800 rounded-lg text-gray-400 hover:text-white transition-colors",children:e.jsx(ls,{size:24})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:v?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(ie,{className:"animate-spin text-blue-500",size:32})}):e.jsxs(e.Fragment,{children:[s&&e.jsxs("div",{className:"p-3 bg-red-900/30 border border-red-700 rounded-lg text-red-400 text-sm flex items-center gap-2",children:[e.jsx(Be,{size:16}),s]}),t&&e.jsxs("div",{className:"p-3 bg-emerald-900/30 border border-emerald-700 rounded-lg text-emerald-400 text-sm flex items-center gap-2",children:[e.jsx(Xe,{size:16}),t]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#1a1a1a] rounded-xl border border-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(He,{size:20,className:L?"text-emerald-400":"text-gray-500"}),e.jsx("span",{className:"text-white font-medium",children:"Activer la planification"})]}),e.jsx("button",{onClick:()=>S(!L),className:`relative w-12 h-6 rounded-full transition-colors ${L?"bg-emerald-500":"bg-gray-700"}`,children:e.jsx("div",{className:`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full transition-transform ${L?"translate-x-6":"translate-x-0"}`})})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#1a1a1a] rounded-xl border border-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($e,{size:20,className:y==="advanced"?"text-blue-400":"text-gray-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-white font-medium block",children:"Mode AvancÃ©"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Configuration par jour"})]})]}),e.jsx("button",{onClick:()=>{u(y==="simple"?"advanced":"simple")},className:`relative w-12 h-6 rounded-full transition-colors ${y==="advanced"?"bg-blue-600":"bg-gray-700"}`,children:e.jsx("div",{className:`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full transition-transform ${y==="advanced"?"translate-x-6":"translate-x-0"}`})})]})]}),y==="simple"&&e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-top-4 duration-300",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-400 flex items-center gap-2",children:[e.jsx(es,{size:16}),"Heure du redÃ©marrage"]}),e.jsx("input",{type:"time",value:C,onChange:P=>T(P.target.value),className:"w-full px-4 py-3 bg-[#1a1a1a] border border-gray-800 rounded-xl text-white focus:outline-none focus:outline-none transition-colors"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-400 flex items-center gap-2",children:[e.jsx(ps,{size:16}),"Jours d'exÃ©cution"]}),e.jsx("div",{className:"flex justify-between gap-1",children:ks.map(P=>e.jsx("button",{onClick:()=>se(P.value),className:`flex-1 aspect-square flex items-center justify-center rounded-lg text-sm font-medium transition-all ${F.includes(P.value)?"bg-blue-600 text-white shadow-lg shadow-blue-900/20":"bg-[#1a1a1a] text-gray-500 hover:bg-[#252525] hover:text-gray-300"}`,title:P.label,children:P.label[0]},P.value))})]})]}),y==="advanced"&&e.jsxs("div",{className:"space-y-3 animate-in fade-in slide-in-from-top-4 duration-300",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-400 flex items-center gap-2 mb-4",children:[e.jsx(ps,{size:16}),"Configuration par jour"]}),ks.map(P=>{const U=x[P.value]!==void 0,d=x[P.value]||"03:00";return e.jsxs("div",{className:"flex items-center gap-4 p-3 bg-[#1a1a1a] rounded-xl border border-gray-800 transition-colors hover:border-gray-700",children:[e.jsx("button",{onClick:()=>$(P.value,U?null:d),className:`w-5 h-5 rounded flex items-center justify-center transition-colors ${U?"bg-blue-600 text-white":"bg-[#252525] text-transparent border border-gray-700"}`,children:e.jsx(Xe,{size:14})}),e.jsx("span",{className:`flex-1 font-medium ${U?"text-white":"text-gray-500"}`,children:P.label}),e.jsx("input",{type:"time",value:d,disabled:!U,onChange:R=>$(P.value,R.target.value),className:`px-3 py-1.5 bg-[#252525] border border-gray-700 rounded-lg text-sm transition-colors focus:outline-none focus:outline-none ${U?"text-white":"text-gray-600 opacity-50"}`})]},P.value)})]}),e.jsx("div",{className:"p-4 bg-blue-900/20 border border-blue-700/50 rounded-lg",children:e.jsxs("p",{className:"text-xs text-blue-400",children:[e.jsx("strong",{children:"Note :"})," Cette fonctionnalitÃ© utilise le serveur du dashboard pour dÃ©clencher le redÃ©marrage. Le dashboard doit Ãªtre en cours d'exÃ©cution au moment prÃ©vu."]})})]})}),e.jsx("div",{className:"p-6 border-t border-gray-800 bg-[#1a1a1a]",children:e.jsxs("button",{onClick:Z,disabled:f,className:"w-full px-4 py-3 bg-blue-600 hover:bg-blue-500 disabled:bg-blue-600/50 text-white rounded-xl font-medium transition-colors flex items-center justify-center gap-2 shadow-lg shadow-blue-900/20",children:[f?e.jsx(ie,{size:18,className:"animate-spin"}):e.jsx(ne,{size:18}),"Enregistrer la planification"]})})]})}):null},at=()=>{const n=()=>7505,[c,h]=r.useState({prometheus:{enabled:!1,port:n(),path:"/metrics"},influxdb:{enabled:!1,url:"http://localhost:8086",database:"mynetwork",username:"",password:"",retention:"30d"}}),[E,A]=r.useState(!1),[L,S]=r.useState(!1),[y,u]=r.useState(null),[C,T]=r.useState(""),[F,b]=r.useState(!1),[x,j]=r.useState(null),[v,i]=r.useState(null),[f,o]=r.useState(!1),[s,k]=r.useState(null),[t,D]=r.useState(null),[H,Z]=r.useState("");r.useEffect(()=>{d(),se()},[]);const se=async()=>{try{const N=await _.get("/api/system/general");N.success&&N.result&&Z(N.result.publicUrl||"")}catch(N){console.error("Failed to load public URL:",N)}},$=t&&JSON.stringify(c)!==JSON.stringify(t);r.useEffect(()=>{if(!c.prometheus.enabled){T("");return}const N=c.prometheus.port||n();if(H&&H.trim())try{const l=`https://${new URL(H.trim()).hostname}/api/metrics/prometheus`;T(l);return}catch{}const g=window.location.hostname;if(/^(\d{1,3}\.){3}\d{1,3}$/.test(g)||/^([0-9a-fA-F]{0,4}:){2,7}[0-9a-fA-F]{0,4}$/.test(g)){const ee=`http://${g}:${N}/api/metrics/prometheus`;T(ee)}else{const ee=`http://${g}:${N}/api/metrics/prometheus`;T(ee)}},[c.prometheus.port,c.prometheus.enabled,H]);const P=async()=>{var N;b(!0),i(null);try{const g=await _.get("/api/config/export");if(g.success&&g.result){const K=new Blob([g.result.content],{type:"text/plain"}),ee=URL.createObjectURL(K),q=document.createElement("a");q.href=ee,q.download="mynetwork.conf",document.body.appendChild(q),q.click(),document.body.removeChild(q),URL.revokeObjectURL(ee),i({type:"success",text:"Configuration exportÃ©e avec succÃ¨s"})}else throw new Error(((N=g.error)==null?void 0:N.message)||"Ã‰chec de l'export")}catch(g){i({type:"error",text:g instanceof Error?g.message:"Erreur lors de l'export"})}finally{b(!1)}},U=async N=>{var K,ee;const g=(K=N.target.files)==null?void 0:K[0];if(g){j(g),i(null);try{const q=await g.text(),l=await _.post("/api/config/import",{content:q});if(l.success&&l.result)i({type:"success",text:l.result.message||`Configuration importÃ©e : ${l.result.imported} plugin(s) configurÃ©(s)`}),setTimeout(()=>{window.location.reload()},2e3);else throw new Error(((ee=l.error)==null?void 0:ee.message)||"Ã‰chec de l'import")}catch(q){i({type:"error",text:q instanceof Error?q.message:"Erreur lors de l'import"}),j(null)}}},d=async()=>{A(!0);try{const N=await _.get("/api/metrics/config");if(N.success&&N.result){const g=N.result;g.prometheus&&(!g.prometheus.port||g.prometheus.port===9090||g.prometheus.port===3e3)&&(g.prometheus.port=n()),h(g),D(JSON.parse(JSON.stringify(g)))}}catch(N){console.error("Failed to load metrics config:",N),u({type:"error",text:"Erreur lors du chargement de la configuration"})}finally{A(!1)}},R=async()=>{var N;S(!0),u(null);try{const g=await _.post("/api/metrics/config",{config:c});g.success?(u({type:"success",text:"Configuration sauvegardÃ©e avec succÃ¨s !"}),D(JSON.parse(JSON.stringify(c)))):u({type:"error",text:((N=g.error)==null?void 0:N.message)||"Erreur lors de la sauvegarde"})}catch(g){u({type:"error",text:g instanceof Error?g.message:"Erreur lors de la sauvegarde"})}finally{S(!1)}},Q=()=>{window.open(C,"_blank")},z=async()=>{var N;o(!0),k(null),u(null);try{const g=await _.get("/api/metrics/prometheus/audit");if(g.success&&g.result)k(g.result),g.result.summary.errors===0?u({type:"success",text:`Audit rÃ©ussi : ${g.result.summary.success}/${g.result.summary.total} tests passÃ©s`}):u({type:"error",text:`Audit partiel : ${g.result.summary.errors} erreur(s) dÃ©tectÃ©e(s)`});else throw new Error(((N=g.error)==null?void 0:N.message)||"Ã‰chec de l'audit")}catch(g){u({type:"error",text:g instanceof Error?g.message:"Erreur lors de l'audit Prometheus"})}finally{o(!1)}},X=async()=>{try{(await _.get("/api/metrics/influxdb")).success&&u({type:"success",text:"Export InfluxDB rÃ©ussi ! Les mÃ©triques sont disponibles."})}catch{u({type:"error",text:"Erreur lors du test InfluxDB"})}};return E?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(ie,{size:32,className:"text-gray-400 animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[$&&e.jsxs("div",{className:"p-4 bg-amber-900/20 border border-amber-700/50 rounded-lg flex items-start gap-3",children:[e.jsx(ce,{size:20,className:"text-amber-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-amber-400 mb-1",children:"Modifications non sauvegardÃ©es"}),e.jsxs("p",{className:"text-xs text-amber-300",children:["Vous avez modifiÃ© la configuration des mÃ©triques. N'oubliez pas de cliquer sur ",e.jsx("strong",{children:'"Sauvegarder la configuration"'})," pour enregistrer vos changements."]})]})]}),y&&e.jsx("div",{className:`p-3 rounded text-sm ${y.type==="success"?"bg-emerald-900/30 border border-emerald-700 text-emerald-400":"bg-red-900/30 border border-red-700 text-red-400"}`,children:y.text}),e.jsxs(V,{title:"Prometheus",icon:Ve,iconColor:"orange",children:[e.jsx(M,{label:"Activer l'export Prometheus",description:"Expose les mÃ©triques au format Prometheus sur /api/metrics/prometheus",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:c.prometheus.enabled,onChange:N=>h({...c,prometheus:{...c.prometheus,enabled:N.target.checked}}),className:"w-4 h-4 text-blue-600 bg-[#1a1a1a] border-gray-700 rounded focus:ring-0"}),e.jsx("span",{className:"text-sm text-gray-400",children:c.prometheus.enabled?e.jsxs("span",{className:"flex items-center gap-1 text-green-400",children:[e.jsx(Se,{size:14}),"ActivÃ©"]}):"DÃ©sactivÃ©"})]})}),c.prometheus.enabled&&e.jsxs(e.Fragment,{children:[e.jsx(M,{label:"Port du serveur",description:"Port a changer si vous le souhaitez. UtilisÃ© pour l'URL des mÃ©triques Prometheus.",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",min:"1024",max:"65535",value:c.prometheus.port||n(),onChange:N=>{const g=parseInt(N.target.value)||n();h({...c,prometheus:{...c.prometheus,port:g}})},className:"w-32 px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-400",children:"port"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(dÃ©faut: ",n(),")"]})]})}),e.jsx(M,{label:"Chemin de l'endpoint",description:"Chemin pour accÃ©der aux mÃ©triques Prometheus",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("input",{type:"text",value:c.prometheus.path||"/metrics",onChange:N=>h({...c,prometheus:{...c.prometheus,path:N.target.value}}),className:"flex-1 px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:outline-none",placeholder:"/metrics"})})}),e.jsx(M,{label:"URL de l'endpoint",description:"URL complÃ¨te pour rÃ©cupÃ©rer les mÃ©triques Prometheus",children:e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex items-center gap-2 w-full",children:[e.jsx("input",{type:"text",value:C,readOnly:!0,className:"flex-1 px-4 py-3 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-base opacity-90 cursor-not-allowed font-mono",style:{width:"100%",minWidth:"600px"}}),e.jsxs("button",{onClick:Q,className:"px-4 py-3 bg-blue-600 hover:bg-blue-700 rounded-lg text-white text-sm transition-colors flex items-center gap-2 flex-shrink-0 whitespace-nowrap",children:[e.jsx(Ee,{size:16}),"Tester"]}),e.jsxs("button",{onClick:z,disabled:f,className:"px-4 py-3 bg-orange-600 hover:bg-orange-700 rounded-lg text-white text-sm transition-colors flex items-center gap-2 flex-shrink-0 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap",children:[f?e.jsx(ie,{size:16,className:"animate-spin"}):e.jsx(ce,{size:16}),"Audit"]})]})})}),s&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-900/50 border border-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300",children:"RÃ©sultats de l'audit"}),e.jsxs("span",{className:`text-xs px-2 py-1 rounded ${s.summary.errors===0?"bg-green-900/40 text-green-400":"bg-orange-900/40 text-orange-400"}`,children:[s.summary.success,"/",s.summary.total," rÃ©ussis"]})]}),e.jsx("div",{className:"space-y-2",children:s.results.map((N,g)=>e.jsxs("div",{className:`p-2 rounded text-xs ${N.status==="success"?"bg-green-900/20 border border-green-700/50":"bg-red-900/20 border border-red-700/50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"font-medium text-gray-300",children:N.endpoint}),e.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] ${N.status==="success"?"bg-green-700/50 text-green-300":"bg-red-700/50 text-red-300"}`,children:N.status==="success"?"OK":"ERREUR"})]}),e.jsx("p",{className:"text-gray-400",children:N.message}),N.metricsCount!==void 0&&e.jsxs("p",{className:"text-gray-500 mt-1",children:["MÃ©triques: ",N.metricsCount]}),N.sampleMetrics&&N.sampleMetrics.length>0&&e.jsx("div",{className:"mt-1",children:e.jsxs("p",{className:"text-gray-500 text-[10px]",children:["Exemples: ",N.sampleMetrics.slice(0,5).join(", ")]})}),N.errors&&N.errors.length>0&&e.jsx("div",{className:"mt-1 text-red-400 text-[10px]",children:N.errors.map((K,ee)=>e.jsx("div",{children:K},ee))})]},g))})]}),e.jsxs("div",{className:"mt-4 p-3 bg-blue-900/20 border border-blue-700/50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-blue-300 mb-2",children:e.jsx("strong",{children:"Configuration Prometheus :"})}),e.jsx("pre",{className:"text-xs text-gray-400 overflow-x-auto",children:`scrape_configs:
  - job_name: 'mynetwork'
    scrape_interval: 30s
    static_configs:
      - targets: ['${window.location.hostname}:${c.prometheus.port||n()}']
    metrics_path: '/api/metrics/prometheus'`}),e.jsxs("p",{className:"text-xs text-blue-400 mt-2",children:[e.jsx("strong",{children:"Note :"})," Le port configurÃ© (",c.prometheus.port||n(),") correspond au port rÃ©el du serveur backend. L'endpoint est accessible Ã  ",e.jsx("code",{className:"text-blue-300",children:"/api/metrics/prometheus"}),"."]})]})]})]}),e.jsxs(V,{title:"InfluxDB",icon:Hs,iconColor:"cyan",children:[e.jsx(M,{label:"Activer l'export InfluxDB",description:"Exporte les mÃ©triques au format InfluxDB Line Protocol",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:c.influxdb.enabled,onChange:N=>h({...c,influxdb:{...c.influxdb,enabled:N.target.checked}}),className:"w-4 h-4 text-blue-600 bg-[#1a1a1a] border-gray-700 rounded focus:ring-0"}),e.jsx("span",{className:"text-sm text-gray-400",children:c.influxdb.enabled?e.jsxs("span",{className:"flex items-center gap-1 text-green-400",children:[e.jsx(Se,{size:14}),"ActivÃ©"]}):"DÃ©sactivÃ©"})]})}),c.influxdb.enabled&&e.jsxs(e.Fragment,{children:[e.jsx(M,{label:"URL du serveur InfluxDB",description:"URL complÃ¨te du serveur InfluxDB (ex: http://localhost:8086)",children:e.jsx("input",{type:"text",value:c.influxdb.url||"",onChange:N=>h({...c,influxdb:{...c.influxdb,url:N.target.value}}),placeholder:"http://localhost:8086",className:"w-full px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:outline-none transition-colors"})}),e.jsx(M,{label:"Base de donnÃ©es",description:"Nom de la base de donnÃ©es InfluxDB",children:e.jsx("input",{type:"text",value:c.influxdb.database||"",onChange:N=>h({...c,influxdb:{...c.influxdb,database:N.target.value}}),placeholder:"mynetwork",className:"w-full px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:outline-none transition-colors"})}),e.jsx(M,{label:"Nom d'utilisateur",description:"Nom d'utilisateur pour l'authentification InfluxDB (optionnel)",children:e.jsx("input",{type:"text",value:c.influxdb.username||"",onChange:N=>h({...c,influxdb:{...c.influxdb,username:N.target.value}}),placeholder:"admin",className:"w-full px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:outline-none transition-colors"})}),e.jsx(M,{label:"Mot de passe",description:"Mot de passe pour l'authentification InfluxDB (optionnel)",children:e.jsx("input",{type:"password",value:c.influxdb.password||"",onChange:N=>h({...c,influxdb:{...c.influxdb,password:N.target.value}}),placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",className:"w-full px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:outline-none transition-colors"})}),e.jsx(M,{label:"RÃ©tention",description:"DurÃ©e de rÃ©tention des donnÃ©es (ex: 30d, 1w, 1h)",children:e.jsx("input",{type:"text",value:c.influxdb.retention||"",onChange:N=>h({...c,influxdb:{...c.influxdb,retention:N.target.value}}),placeholder:"30d",className:"w-full px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:outline-none transition-colors"})}),e.jsxs("div",{className:"mt-4 p-3 bg-purple-900/20 border border-purple-700/50 rounded-lg",children:[e.jsxs("p",{className:"text-xs text-purple-300 mb-2",children:[e.jsx("strong",{children:"Note :"})," L'export InfluxDB est disponible via l'endpoint ",e.jsx("code",{className:"text-purple-400",children:"/api/metrics/influxdb"})]}),e.jsxs("button",{onClick:X,className:"mt-2 px-3 py-1.5 bg-purple-600 hover:bg-purple-700 rounded text-white text-xs transition-colors flex items-center gap-2",children:[e.jsx(Ee,{size:12}),"Tester l'export"]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs("button",{onClick:R,disabled:L,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[L?e.jsx(ie,{size:18,className:"animate-spin"}):e.jsx(ne,{size:18}),e.jsx("span",{children:"Sauvegarder la configuration"})]})}),e.jsx(V,{title:"Export/Import de Configuration",icon:rs,iconColor:"amber",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(M,{label:"Exporter la configuration",description:"TÃ©lÃ©chargez la configuration complÃ¨te de l'application (plugins, paramÃ¨tres) au format .conf",children:e.jsxs("button",{onClick:P,disabled:F,className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[F?e.jsx(ie,{size:16,className:"animate-spin"}):e.jsx(fs,{size:16}),e.jsx("span",{children:"Exporter"})]})}),e.jsx(M,{label:"Importer la configuration",description:"Importez une configuration depuis un fichier .conf (remplace la configuration actuelle)",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"file",accept:".conf",onChange:U,className:"hidden",id:"config-file-input"}),e.jsxs("label",{htmlFor:"config-file-input",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-white transition-colors cursor-pointer",children:[e.jsx(Vs,{size:16}),e.jsx("span",{children:"SÃ©lectionner un fichier"})]}),x&&e.jsx("span",{className:"text-sm text-gray-400",children:x.name})]})}),v&&e.jsxs("div",{className:`p-3 rounded-lg flex items-center gap-2 ${v.type==="success"?"bg-green-900/20 border border-green-700 text-green-400":"bg-red-900/20 border border-red-700 text-red-400"}`,children:[v.type==="success"?e.jsx(Se,{size:16}):e.jsx(ce,{size:16}),e.jsx("span",{className:"text-sm",children:v.text})]})]})})]})},lt=()=>{const{plugins:n,pluginStats:c,isLoading:h,fetchPlugins:E,updatePluginConfig:A,testPluginConnection:L}=bs(),{checkAuth:S,isRegistered:y,isLoggedIn:u,permissions:C,freeboxUrl:T}=Qe(),[F,b]=r.useState(null),[x,j]=r.useState(!1),[v,i]=r.useState(""),[f,o]=r.useState(!1),[s,k]=r.useState(!1);r.useEffect(()=>{E()},[E]),r.useEffect(()=>{const z=n.find(X=>X.id==="freebox");z!=null&&z.enabled?S().then(()=>{const X=Qe.getState();!X.isRegistered&&!X.isRegistering?o(!0):X.isRegistered&&X.isLoggedIn&&o(!1)}):o(!1)},[n,S]),r.useEffect(()=>{y&&u&&(o(!1),E())},[y,u,E]);const t=async(z,X)=>{await A(z,{enabled:X}),await E(),z==="freebox"&&X?(await S(),Qe.getState().isRegistered||o(!0)):z==="freebox"&&!X&&o(!1)},[D,H]=r.useState(null),[Z,se]=r.useState(null),$=async z=>{b(z);const X=await L(z);X?(se(X.connected),H(X.message)):(se(!1),H("Test de connexion impossible (voir logs backend)")),setTimeout(()=>b(null),2e3),await E()},P=z=>{i(z),j(!0)},U=()=>{j(!1),i(""),E()};if(h)return e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(de,{size:32,className:"text-gray-400 animate-spin"})});const d=n.find(z=>z.id==="freebox"),R=C.settings===!0,Q=(d==null?void 0:d.enabled)&&!R;return e.jsxs(e.Fragment,{children:[e.jsxs(V,{title:"Gestion des plugins",icon:$e,iconColor:"emerald",children:[Q&&e.jsx("div",{className:"mb-4 p-4 bg-orange-500/10 border-2 border-orange-500/30 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ce,{size:20,className:"text-orange-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-semibold text-orange-400 mb-1.5",children:"Permission manquante pour le plugin Freebox"}),e.jsxs("div",{className:"text-xs text-orange-300/90 mb-3",children:["La permission ",e.jsxs("span",{className:"font-medium text-orange-200",children:['"',js.settings,'"']})," est requise pour accÃ©der Ã  certaines fonctionnalitÃ©s de la Freebox (historique RRD, statistiques Ã©tendues, etc.)."]}),e.jsx("div",{className:"text-xs text-orange-300/80 mb-2",children:e.jsx("strong",{children:"Pour activer cette permission :"})}),e.jsxs("ol",{className:"text-xs text-orange-300/80 list-decimal list-inside space-y-1 mb-3",children:[e.jsx("li",{children:"Ouvrez l'interface Freebox OS"}),e.jsxs("li",{children:["Allez dans ",e.jsx("span",{className:"font-medium",children:"ParamÃ¨tres â†’ Gestion des accÃ¨s â†’ Applications"})]}),e.jsxs("li",{children:["SÃ©lectionnez ",e.jsx("span",{className:"font-medium",children:'"MynetworK Dashboard"'})]}),e.jsxs("li",{children:["Activez la permission ",e.jsxs("span",{className:"font-medium",children:['"',js.settings,'"']})]})]}),e.jsxs("a",{href:be(T),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-1.5 bg-orange-500/20 hover:bg-orange-500/30 border border-orange-500/50 rounded-lg text-xs text-orange-300 hover:text-orange-200 transition-colors",children:["Ouvrir les paramÃ¨tres Freebox OS",e.jsx(Ee,{size:14})]})]})]})}),D&&e.jsxs("div",{className:`mb-4 px-4 py-3 rounded-lg border-2 flex items-center gap-3 ${Z?"border-green-600 bg-green-900/40 text-green-100":"border-red-600 bg-red-900/40 text-red-100"}`,children:[Z?e.jsx(Se,{size:18,className:"text-green-400 flex-shrink-0"}):e.jsx(ts,{size:18,className:"text-red-400 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-sm mb-0.5",children:Z?"Test de connexion rÃ©ussi":"Test de connexion Ã©chouÃ©"}),e.jsx("div",{className:"text-xs opacity-90",children:D})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:n.map(z=>e.jsxs("div",{className:`rounded-lg p-3 border transition-all hover:shadow-lg flex flex-col ${z.enabled&&z.connectionStatus?"bg-emerald-500/10 border-emerald-500/30 hover:border-emerald-500/50 hover:shadow-emerald-500/20":z.enabled?"bg-yellow-500/10 border-yellow-500/30 hover:border-yellow-500/50 hover:shadow-yellow-500/20":"bg-gray-500/10 border-gray-500/30 hover:border-gray-500/50 hover:shadow-gray-500/20"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2.5",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[e.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0 ${z.enabled&&z.connectionStatus?"bg-emerald-500/20 border border-emerald-500/30":z.enabled?"bg-yellow-500/20 border border-yellow-500/30":"bg-gray-500/20 border border-gray-500/30"}`,children:e.jsx($e,{size:16,className:z.enabled&&z.connectionStatus?"text-emerald-400":z.enabled?"text-yellow-400":"text-gray-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-semibold text-theme-primary text-sm truncate",children:z.name}),e.jsxs("p",{className:"text-[10px] text-theme-tertiary",children:["v",z.version]})]})]}),e.jsx("div",{className:"flex-shrink-0",children:z.connectionStatus?e.jsxs("div",{className:"inline-flex items-center gap-1.5 px-2 py-1 bg-emerald-500/20 border border-emerald-500/30 rounded text-emerald-400 text-[10px] font-medium",children:[e.jsx(Se,{size:11}),e.jsx("span",{children:"ConnectÃ©"})]}):z.enabled?e.jsxs("div",{className:"inline-flex items-center gap-1.5 px-2 py-1 bg-yellow-500/20 border border-yellow-500/30 rounded text-yellow-400 text-[10px] font-medium",children:[e.jsx(ce,{size:11}),e.jsx("span",{children:"Non connectÃ©"})]}):e.jsxs("div",{className:"inline-flex items-center gap-1.5 px-2 py-1 bg-gray-500/20 border border-gray-500/30 rounded text-gray-400 text-[10px] font-medium",children:[e.jsx(ts,{size:11}),e.jsx("span",{children:"DÃ©sactivÃ©"})]})})]}),z.connectionStatus&&e.jsxs("div",{className:"mb-2.5 flex flex-wrap gap-1.5",children:[z.id==="freebox"&&e.jsxs(e.Fragment,{children:[z.firmware&&e.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-blue-500/20 border border-blue-500/30 rounded text-blue-400 text-[10px] font-medium",children:[e.jsx("span",{className:"text-blue-300/70",children:"Box:"}),e.jsx("span",{className:"font-mono",children:z.firmware})]}),z.playerFirmware&&e.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-purple-500/20 border border-purple-500/30 rounded text-purple-400 text-[10px] font-medium",children:[e.jsx("span",{className:"text-purple-300/70",children:"Player:"}),e.jsx("span",{className:"font-mono",children:z.playerFirmware})]}),z.apiVersion&&e.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-cyan-500/20 border border-cyan-500/30 rounded text-cyan-400 text-[10px] font-medium",children:[e.jsx("span",{className:"text-cyan-300/70",children:"API:"}),e.jsx("span",{className:"font-mono",children:z.apiVersion})]})]}),z.id==="unifi"&&e.jsxs(e.Fragment,{children:[z.controllerFirmware&&e.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-blue-500/20 border border-blue-500/30 rounded text-blue-400 text-[10px] font-medium",children:[e.jsx("span",{className:"text-blue-300/70",children:"Firmware:"}),e.jsx("span",{className:"font-mono",children:z.controllerFirmware})]}),z.apiMode&&e.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-purple-500/20 border border-purple-500/30 rounded text-purple-400 text-[10px] font-medium",children:[e.jsx("span",{className:"text-purple-300/70",children:"Mode:"}),e.jsx("span",{className:"font-mono uppercase",children:z.apiMode})]})]}),z.id==="scan-reseau"&&(()=>{var N;const X=(N=c==null?void 0:c["scan-reseau"])==null?void 0:N.system;return X?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-gray-500/20 border border-gray-500/30 rounded text-gray-300 text-[10px] font-medium",children:[e.jsx("span",{className:"text-gray-400",children:"Total:"}),e.jsx("span",{className:"font-mono font-semibold",children:X.totalIps||0})]}),e.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-emerald-500/20 border border-emerald-500/30 rounded text-emerald-400 text-[10px] font-medium",children:[e.jsx("span",{className:"text-emerald-300/70",children:"Online:"}),e.jsx("span",{className:"font-mono font-semibold",children:X.onlineIps||0})]}),e.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-red-500/20 border border-red-500/30 rounded text-red-400 text-[10px] font-medium",children:[e.jsx("span",{className:"text-red-300/70",children:"Offline:"}),e.jsx("span",{className:"font-mono font-semibold",children:X.offlineIps||0})]})]}):null})()]}),e.jsxs("div",{className:"flex items-center justify-between pt-2.5 mt-auto",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[10px] text-theme-tertiary font-medium",children:"Actif"}),e.jsx("button",{onClick:()=>t(z.id,!z.enabled),className:`relative w-9 h-5 rounded-full transition-all ${z.enabled?"bg-emerald-500 shadow-lg shadow-emerald-500/30":"bg-gray-600"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 w-4 h-4 rounded-full bg-white transition-transform shadow-md ${z.enabled?"translate-x-4":"translate-x-0"}`})})]}),e.jsx("div",{className:"flex items-center gap-1.5",children:z.id==="scan-reseau"?e.jsx("button",{onClick:()=>k(!0),className:"p-1.5 bg-theme-secondary border border-theme hover:bg-theme-primary hover:border-purple-500/50 rounded-lg text-theme-primary transition-all hover:shadow-lg hover:shadow-purple-500/10",title:"Configurer les scans automatiques",children:e.jsx($e,{size:12})}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>$(z.id),disabled:F===z.id,className:"p-1.5 bg-blue-600 hover:bg-blue-500 rounded-lg text-white transition-all disabled:opacity-50 disabled:cursor-not-allowed hover:shadow-lg hover:shadow-blue-500/30",title:"Tester la connexion",children:F===z.id?e.jsx(de,{size:12,className:"animate-spin"}):e.jsx(de,{size:12})}),e.jsx("button",{onClick:()=>P(z.id),className:"p-1.5 bg-theme-secondary border border-theme hover:bg-theme-primary hover:border-emerald-500/50 rounded-lg text-theme-primary transition-all hover:shadow-lg hover:shadow-emerald-500/10",title:"Configurer",children:e.jsx($e,{size:12})})]})})]})]},z.id))})]}),x&&v&&e.jsx(Qs,{isOpen:x,onClose:U,pluginId:v}),f&&e.jsx(Ls,{isOpen:f,onClose:()=>o(!1)}),s&&e.jsx(Ys,{isOpen:s,onClose:()=>k(!1)})]})},nt=()=>{const{user:n}=as(),[c,h]=r.useState([]),[E,A]=r.useState(!0),[L,S]=r.useState(!1),[y,u]=r.useState("all"),[C,T]=r.useState(50);r.useEffect(()=>{(n==null?void 0:n.role)==="admin"&&F()},[n,y,C]);const F=async()=>{A(!0);try{const i=new URLSearchParams({limit:C.toString()});y!=="all"&&i.append("level",y);const f=await _.get(`/api/logs?${i}`);f.success&&f.result&&h(f.result.logs)}catch(i){console.error("Failed to fetch logs:",i)}finally{A(!1)}},b=i=>{switch(i){case"error":return e.jsx(ce,{size:14,className:"text-red-400"});case"warning":return e.jsx(Be,{size:14,className:"text-yellow-400"});default:return e.jsx(De,{size:14,className:"text-blue-400"})}},x=i=>i.replace(/\./g," ").replace(/\b\w/g,f=>f.toUpperCase()),j=i=>new Date(i).toLocaleString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),v=async()=>{var i;if(confirm("ÃŠtes-vous sÃ»r de vouloir supprimer tous les logs ? Cette action est irrÃ©versible.")){S(!0);try{const f=await _.delete("/api/logs");if(f.success&&f.result)h([]),alert(`Tous les logs ont Ã©tÃ© supprimÃ©s (${f.result.deletedCount} entrÃ©es)`);else throw new Error(((i=f.error)==null?void 0:i.message)||"Ã‰chec de la suppression")}catch(f){alert(f instanceof Error?f.message:"Erreur lors de la suppression des logs")}finally{S(!1)}}};return(n==null?void 0:n.role)!=="admin"?e.jsx(V,{title:"Journal des Ã©vÃ©nements",icon:Ns,iconColor:"cyan",children:e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(ce,{size:32,className:"mx-auto mb-2"}),e.jsx("p",{children:"AccÃ¨s administrateur requis"})]})}):e.jsx(V,{title:"Journal des Ã©vÃ©nements",icon:Ns,iconColor:"cyan",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("button",{onClick:()=>u("all"),className:`px-3 py-1.5 text-xs rounded-lg border transition-colors ${y==="all"?"bg-blue-600 border-blue-500 text-white":"bg-[#1a1a1a] border-gray-700 text-gray-400 hover:border-gray-600"}`,children:"Tous"}),e.jsxs("button",{onClick:()=>u("info"),className:`px-3 py-1.5 text-xs rounded-lg border transition-colors flex items-center gap-1 ${y==="info"?"bg-blue-600 border-blue-500 text-white":"bg-[#1a1a1a] border-gray-700 text-gray-400 hover:border-gray-600"}`,children:[e.jsx(De,{size:12}),"Info"]}),e.jsxs("button",{onClick:()=>u("warning"),className:`px-3 py-1.5 text-xs rounded-lg border transition-colors flex items-center gap-1 ${y==="warning"?"bg-yellow-600 border-yellow-500 text-white":"bg-[#1a1a1a] border-gray-700 text-gray-400 hover:border-gray-600"}`,children:[e.jsx(Be,{size:12}),"Avertissement"]}),e.jsxs("button",{onClick:()=>u("error"),className:`px-3 py-1.5 text-xs rounded-lg border transition-colors flex items-center gap-1 ${y==="error"?"bg-red-600 border-red-500 text-white":"bg-[#1a1a1a] border-gray-700 text-gray-400 hover:border-gray-600"}`,children:[e.jsx(ce,{size:12}),"Erreur"]}),e.jsxs("button",{onClick:F,disabled:E,className:"px-3 py-1.5 text-xs bg-gray-700 hover:bg-gray-600 rounded-lg text-white transition-colors disabled:opacity-50 flex items-center gap-1",children:[e.jsx(de,{size:12,className:E?"animate-spin":""}),"Actualiser"]}),e.jsxs("button",{onClick:v,disabled:L||c.length===0,className:"px-3 py-1.5 text-xs bg-red-600 hover:bg-red-700 rounded-lg text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1",children:[L?e.jsx(ie,{size:12,className:"animate-spin"}):e.jsx(we,{size:12}),"Effacer tous les logs"]})]}),E?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(de,{size:32,className:"text-gray-400 animate-spin"})}):c.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(De,{size:32,className:"mx-auto mb-2"}),e.jsx("p",{children:"Aucun log trouvÃ©"})]}):e.jsx("div",{className:"space-y-2 max-h-[600px] overflow-y-auto",children:c.map(i=>e.jsx("div",{className:`p-3 rounded-lg border-l-4 transition-colors ${i.level==="error"?"bg-red-950/40 border-red-500 border-r border-t border-b border-red-700/60 hover:bg-red-950/50":i.level==="warning"?"bg-yellow-950/40 border-yellow-500 border-r border-t border-b border-yellow-700/60 hover:bg-yellow-950/50":"bg-blue-950/30 border-blue-500 border-r border-t border-b border-blue-700/40 hover:bg-blue-950/40"}`,children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"flex items-start gap-2 flex-1",children:[b(i.level),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:`text-sm font-medium ${i.level==="error"?"text-red-300":i.level==="warning"?"text-yellow-300":"text-blue-300"}`,children:x(i.action)}),i.username&&e.jsxs("span",{className:"text-xs text-gray-400",children:["par ",i.username]}),i.pluginId&&e.jsx("span",{className:"text-xs px-2 py-0.5 bg-blue-500/20 text-blue-400 rounded",children:i.pluginId})]}),i.resource&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[i.resource,i.resourceId&&` (${i.resourceId})`]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[j(i.timestamp),i.ipAddress&&` â€¢ ${i.ipAddress}`]})]})]})})},i.id))})]})})},it=()=>{var Y,je,ve,Oe,Fe,Ge;const{user:n}=as(),[c,h]=r.useState(!1),[E,A]=r.useState(null),[L,S]=r.useState(!1),[y,u]=r.useState(5),[C,T]=r.useState(15),[F,b]=r.useState(30),[x,j]=r.useState(168),[v,i]=r.useState(!1),[f,o]=r.useState([]),[s,k]=r.useState(!1),[t,D]=r.useState(null),[H,Z]=r.useState(""),[se,$]=r.useState(""),[P,U]=r.useState(""),[d,R]=r.useState(null),[Q,z]=r.useState(null),X=d&&(y!==d.maxLoginAttempts||C!==d.lockoutDuration||x!==d.sessionTimeoutHours),N=Q&&t&&(JSON.stringify((Y=t.allowedOrigins)==null?void 0:Y.sort())!==JSON.stringify((je=Q.allowedOrigins)==null?void 0:je.sort())||t.allowCredentials!==Q.allowCredentials||JSON.stringify((ve=t.allowedMethods)==null?void 0:ve.sort())!==JSON.stringify((Oe=Q.allowedMethods)==null?void 0:Oe.sort())||JSON.stringify((Fe=t.allowedHeaders)==null?void 0:Fe.sort())!==JSON.stringify((Ge=Q.allowedHeaders)==null?void 0:Ge.sort())),g=X||N;r.useEffect(()=>{K(),l(),ae()},[]);const K=async()=>{try{const p=await _.get("/api/system/security");if(p.success&&p.result){S(p.result.jwtSecretIsDefault||!1);const W=p.result.maxLoginAttempts||5,re=p.result.lockoutDuration||15,Ne=p.result.sessionTimeout||168;u(W),T(re),b(p.result.trackingWindow||30),j(Ne),R({maxLoginAttempts:W,lockoutDuration:re,sessionTimeoutHours:Ne})}}catch{console.log("Security settings endpoint not available")}},ee=async()=>{h(!0),A(null);try{const p=await _.post("/api/system/security",{maxLoginAttempts:y,lockoutDuration:C,sessionTimeoutHours:x});if(p.success){const W=p.result,re=W!=null&&W.message?W.message:"ParamÃ¨tres de sÃ©curitÃ© sauvegardÃ©s avec succÃ¨s";A({type:"success",text:re}),await K(),i(!1),R({maxLoginAttempts:y,lockoutDuration:C,sessionTimeoutHours:x})}else{const W=p.error;A({type:"error",text:(W==null?void 0:W.message)||"Erreur lors de la sauvegarde"})}}catch(p){A({type:"error",text:p instanceof Error?p.message:"Erreur lors de la sauvegarde"})}finally{h(!1)}},q=p=>{j(p),i(p!==168)},l=async()=>{k(!0);try{const p=await _.get("/api/security/blocked");p.success&&p.result&&o(p.result)}catch(p){console.error("Failed to load blocked IPs:",p)}finally{k(!1)}},I=async p=>{var W,re,Ne;try{(await _.post(`/api/security/blocked/${encodeURIComponent(p)}/unblock`)).success&&(await l(),A({type:"success",text:`L'identifiant "${p}" a Ã©tÃ© dÃ©bloquÃ© avec succÃ¨s`}),setTimeout(()=>A(null),3e3))}catch(he){const Ie=((Ne=(re=(W=he==null?void 0:he.response)==null?void 0:W.data)==null?void 0:re.error)==null?void 0:Ne.message)||"Erreur lors du dÃ©blocage";A({type:"error",text:Ie}),setTimeout(()=>A(null),3e3)}},O=p=>{if(p<=0)return"ExpirÃ©";const W=Math.ceil(p/60);if(W<60)return`${W} min`;const re=Math.floor(W/60),Ne=W%60;return Ne===0?`${re}h`:`${re}h ${Ne}min`},ae=async()=>{try{const p=await _.get("/api/system/general");if(p.success&&p.result){const W=p.result.corsConfig||null;D(W),z(W?JSON.parse(JSON.stringify(W)):null)}}catch(p){console.error("Failed to load CORS config:",p)}},xe=async()=>{h(!0),A(null);try{const p=await _.put("/api/system/general",{corsConfig:t||{allowedOrigins:[],allowCredentials:!0,allowedMethods:["GET","POST","PUT","DELETE","OPTIONS","PATCH"],allowedHeaders:["Content-Type","Authorization","X-Requested-With"]}});if(p.success)A({type:"success",text:"Configuration CORS sauvegardÃ©e. Un redÃ©marrage du serveur est nÃ©cessaire pour appliquer les changements."}),setTimeout(()=>A(null),5e3),await ae();else{const W=p.error;A({type:"error",text:(W==null?void 0:W.message)||"Erreur lors de la sauvegarde"})}}catch(p){A({type:"error",text:p instanceof Error?p.message:"Erreur lors de la sauvegarde"})}finally{h(!1)}},We=()=>{if(H.trim()){const p=(t==null?void 0:t.allowedOrigins)||[];p.includes(H.trim())||(D({...t,allowedOrigins:[...p,H.trim()],allowCredentials:(t==null?void 0:t.allowCredentials)!==void 0?t.allowCredentials:!0,allowedMethods:(t==null?void 0:t.allowedMethods)||["GET","POST","PUT","DELETE","OPTIONS","PATCH"],allowedHeaders:(t==null?void 0:t.allowedHeaders)||["Content-Type","Authorization","X-Requested-With"]}),Z(""))}},Ce=p=>{const W=(t==null?void 0:t.allowedOrigins)||[];D({...t,allowedOrigins:W.filter(re=>re!==p),allowCredentials:(t==null?void 0:t.allowCredentials)!==void 0?t.allowCredentials:!0,allowedMethods:(t==null?void 0:t.allowedMethods)||["GET","POST","PUT","DELETE","OPTIONS","PATCH"],allowedHeaders:(t==null?void 0:t.allowedHeaders)||["Content-Type","Authorization","X-Requested-With"]})},te=()=>{if(se.trim()){const p=(t==null?void 0:t.allowedMethods)||[];p.includes(se.trim().toUpperCase())||(D({...t,allowedMethods:[...p,se.trim().toUpperCase()],allowedOrigins:(t==null?void 0:t.allowedOrigins)||[],allowCredentials:(t==null?void 0:t.allowCredentials)!==void 0?t.allowCredentials:!0,allowedHeaders:(t==null?void 0:t.allowedHeaders)||["Content-Type","Authorization","X-Requested-With"]}),$(""))}},ue=p=>{const W=(t==null?void 0:t.allowedMethods)||[];D({...t,allowedMethods:W.filter(re=>re!==p),allowedOrigins:(t==null?void 0:t.allowedOrigins)||[],allowCredentials:(t==null?void 0:t.allowCredentials)!==void 0?t.allowCredentials:!0,allowedHeaders:(t==null?void 0:t.allowedHeaders)||["Content-Type","Authorization","X-Requested-With"]})},le=()=>{if(P.trim()){const p=(t==null?void 0:t.allowedHeaders)||[];p.includes(P.trim())||(D({...t,allowedHeaders:[...p,P.trim()],allowedOrigins:(t==null?void 0:t.allowedOrigins)||[],allowCredentials:(t==null?void 0:t.allowCredentials)!==void 0?t.allowCredentials:!0,allowedMethods:(t==null?void 0:t.allowedMethods)||["GET","POST","PUT","DELETE","OPTIONS","PATCH"]}),U(""))}},ze=p=>{const W=(t==null?void 0:t.allowedHeaders)||[];D({...t,allowedHeaders:W.filter(re=>re!==p),allowedOrigins:(t==null?void 0:t.allowedOrigins)||[],allowCredentials:(t==null?void 0:t.allowCredentials)!==void 0?t.allowCredentials:!0,allowedMethods:(t==null?void 0:t.allowedMethods)||["GET","POST","PUT","DELETE","OPTIONS","PATCH"]})};return e.jsxs("div",{className:"space-y-6",children:[g&&e.jsxs("div",{className:"p-4 bg-amber-900/20 border border-amber-700/50 rounded-lg flex items-start gap-3",children:[e.jsx(Be,{size:20,className:"text-amber-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-amber-400 mb-1",children:"Modifications non sauvegardÃ©es"}),e.jsxs("p",{className:"text-xs text-amber-300",children:["Vous avez modifiÃ© des paramÃ¨tres. N'oubliez pas de cliquer sur ",e.jsx("strong",{children:'"Sauvegarder"'})," pour enregistrer vos changements."]})]})]}),E&&e.jsxs("div",{className:`p-3 rounded-lg flex items-center gap-2 ${E.type==="success"?"bg-green-900/20 border border-green-700 text-green-400":"bg-red-900/20 border border-red-700 text-red-400"}`,children:[E.type==="success"?e.jsx(Se,{size:16}):e.jsx(Be,{size:16}),e.jsx("span",{className:"text-sm",children:E.text})]}),L&&e.jsx("div",{className:"p-4 bg-yellow-900/20 border border-yellow-700/50 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Be,{size:20,className:"text-yellow-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-yellow-400 mb-1",children:"Secret JWT par dÃ©faut dÃ©tectÃ©"}),e.jsxs("p",{className:"text-xs text-yellow-300 mb-2",children:["Pour des raisons de sÃ©curitÃ©, dÃ©finissez une variable d'environnement ",e.jsx("code",{className:"bg-yellow-900/30 px-1.5 py-0.5 rounded",children:"JWT_SECRET"})," avec une valeur unique et sÃ©curisÃ©e."]}),e.jsx("p",{className:"text-xs text-gray-400",children:"En production, utilisez un secret fort gÃ©nÃ©rÃ© alÃ©atoirement (minimum 32 caractÃ¨res)."})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"space-y-6",children:e.jsx(V,{title:"Protection contre les attaques",icon:ke,iconColor:"red",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(M,{label:"Tentatives de connexion maximum",description:"Nombre de tentatives de connexion autorisÃ©es avant blocage automatique",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",min:"3",max:"10",value:y,onChange:p=>u(parseInt(p.target.value)||5),className:"w-20 px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:outline-none"}),e.jsx("span",{className:"text-sm text-gray-400",children:"tentatives"})]})}),e.jsx(M,{label:"DurÃ©e de blocage",description:"DurÃ©e du blocage aprÃ¨s dÃ©passement du nombre maximum de tentatives",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",min:"5",max:"60",value:C,onChange:p=>T(parseInt(p.target.value)||15),className:"w-20 px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:outline-none"}),e.jsx("span",{className:"text-sm text-gray-400",children:"minutes"})]})}),e.jsx(M,{label:"FenÃªtre de suivi",description:"DurÃ©e pendant laquelle les tentatives Ã©chouÃ©es sont comptabilisÃ©es",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",min:"15",max:"120",value:F,onChange:p=>b(parseInt(p.target.value)||30),disabled:!0,className:"w-20 px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:outline-none opacity-50 cursor-not-allowed"}),e.jsx("span",{className:"text-sm text-gray-400",children:"minutes"}),e.jsx("span",{className:"text-xs text-gray-500",children:"(lecture seule)"})]})}),e.jsx("div",{className:"mt-4 p-3 bg-green-900/10 border border-green-700/30 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Se,{size:16,className:"text-green-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs text-green-400 font-medium mb-1",children:"Protection active"}),e.jsxs("p",{className:"text-xs text-gray-400",children:["Les tentatives de connexion Ã©chouÃ©es sont automatiquement bloquÃ©es aprÃ¨s ",y," tentatives pendant ",C," minutes."]})]})]})})]})})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(V,{title:"Authentification",icon:Ts,iconColor:"blue",children:e.jsx("div",{className:"space-y-4",children:e.jsxs(M,{label:"DÃ©lai d'expiration de session",description:"DurÃ©e avant expiration de la session utilisateur (appliquÃ© aux nouvelles connexions uniquement)",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("input",{type:"number",min:"1",max:"168",value:x,onChange:p=>q(parseInt(p.target.value)||168),className:"w-20 px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:outline-none"}),e.jsx("span",{className:"text-sm text-gray-400",children:"heures"}),x>=24&&e.jsxs("span",{className:"text-sm text-blue-400 font-medium",children:["(",x%24===0?`${x/24} jour${x>=48?"s":""}`:`${Math.round(x/24*10)/10} jour${x>=48?"s":""}`,")"]})]}),v&&e.jsxs("div",{className:"mt-2 flex items-start gap-2 p-2 bg-yellow-900/20 rounded border border-yellow-700/50",children:[e.jsx(Be,{size:14,className:"text-yellow-400 mt-0.5 flex-shrink-0"}),e.jsxs("p",{className:"text-xs text-yellow-300",children:[e.jsx("strong",{children:"Attention :"})," Le nouveau dÃ©lai d'expiration s'appliquera uniquement aux nouvelles connexions. Les sessions actives conserveront leur dÃ©lai d'expiration d'origine."]})]}),e.jsxs("div",{className:"mt-2 flex items-start gap-2 p-2 bg-gray-900/50 rounded border border-gray-800",children:[e.jsx(De,{size:14,className:"text-gray-500 mt-0.5 flex-shrink-0"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["La configuration est stockÃ©e en base de donnÃ©es et remplace la variable d'environnement ",e.jsx("code",{className:"bg-gray-800 px-1 rounded",children:"JWT_EXPIRES_IN"})," si dÃ©finie."]})]})]})})}),e.jsx(V,{title:"SÃ©curitÃ© rÃ©seau",icon:ke,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs(M,{label:"Exiger HTTPS",description:"Forcer l'utilisation de HTTPS pour toutes les connexions",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:!1,disabled:!0,className:"w-4 h-4 text-blue-600 bg-[#1a1a1a] border-gray-700 rounded opacity-50 cursor-not-allowed"}),e.jsx("span",{className:"text-sm text-gray-500",children:"Non implÃ©mentÃ©"})]}),e.jsxs("div",{className:"mt-2 flex items-start gap-2 p-2 bg-gray-900/50 rounded border border-gray-800",children:[e.jsx(ts,{size:14,className:"text-gray-500 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-gray-500",children:"GÃ©nÃ©ralement gÃ©rÃ© par nginx/reverse proxy. Peut Ãªtre ajoutÃ© via middleware Express si nÃ©cessaire."})]})]}),e.jsxs(M,{label:"Limitation de dÃ©bit (Rate Limiting)",description:"Limiter le nombre de requÃªtes par IP pour prÃ©venir les attaques DDoS",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:!1,disabled:!0,className:"w-4 h-4 text-blue-600 bg-[#1a1a1a] border-gray-700 rounded opacity-50 cursor-not-allowed"}),e.jsx("span",{className:"text-sm text-gray-500",children:"Non implÃ©mentÃ©"})]}),e.jsxs("div",{className:"mt-2 flex items-start gap-2 p-2 bg-gray-900/50 rounded border border-gray-800",children:[e.jsx(ts,{size:14,className:"text-gray-500 mt-0.5 flex-shrink-0"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["NÃ©cessite l'installation de ",e.jsx("code",{className:"bg-gray-800 px-1 rounded",children:"express-rate-limit"})," et configuration des limites par endpoint."]})]})]})]})})]})]}),e.jsx(V,{title:"IPs et comptes bloquÃ©s",icon:ke,iconColor:"red",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Liste des adresses IP et noms d'utilisateur actuellement bloquÃ©s suite Ã  des tentatives de connexion Ã©chouÃ©es"}),e.jsxs("button",{onClick:l,disabled:s,className:"flex items-center gap-2 px-3 py-1.5 bg-gray-700 hover:bg-gray-600 text-white text-sm rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(de,{size:14,className:s?"animate-spin":""}),e.jsx("span",{children:"Actualiser"})]})]}),s?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(ie,{className:"animate-spin text-blue-400",size:20})}):f.length===0?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(Se,{size:32,className:"text-green-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Aucune IP ou compte bloquÃ© actuellement"})]}):e.jsx("div",{className:"space-y-2",children:f.map(p=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#1a1a1a] rounded-lg border border-gray-800 hover:border-red-700/50 transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-white font-mono",children:p.identifier}),e.jsxs("span",{className:"px-2 py-0.5 bg-red-900/30 text-red-400 text-xs rounded",children:[p.count," tentative",p.count>1?"s":""]})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["BloquÃ© pendant encore : ",e.jsx("span",{className:"text-orange-400 font-medium",children:O(p.remainingTime)})]})]}),e.jsxs("button",{onClick:()=>I(p.identifier),className:"flex items-center gap-2 px-3 py-1.5 bg-red-600 hover:bg-red-500 text-white text-sm rounded-lg transition-colors",title:"DÃ©bloquer cet identifiant",children:[e.jsx(we,{size:14}),e.jsx("span",{children:"DÃ©bloquer"})]})]},p.identifier))})]})}),e.jsx(V,{title:"Configuration CORS",icon:Re,iconColor:"cyan",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-3 bg-blue-900/10 border border-blue-700/30 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(De,{size:16,className:"text-blue-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs text-blue-300 mb-1",children:e.jsx("strong",{children:"Configuration CORS pour proxy et accÃ¨s externe"})}),e.jsx("p",{className:"text-xs text-gray-400",children:"Configurez les origines autorisÃ©es, mÃ©thodes HTTP et headers pour Ã©viter les erreurs CORS avec des proxies locaux ou des accÃ¨s externes."})]})]})}),e.jsx(M,{label:"Origines autorisÃ©es",description:"Liste des domaines/IP autorisÃ©s Ã  accÃ©der Ã  l'API. Utilisez * pour autoriser toutes les origines (non recommandÃ© en production).",children:e.jsxs("div",{className:"w-full space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:H,onChange:p=>Z(p.target.value),onKeyPress:p=>p.key==="Enter"&&We(),placeholder:"https://example.com ou http://192.168.1.100:3000",className:"flex-1 px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm placeholder-gray-500 focus:outline-none focus:border-blue-500"}),e.jsxs("button",{onClick:We,className:"px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(Pe,{size:14}),e.jsx("span",{children:"Ajouter"})]})]}),(t==null?void 0:t.allowedOrigins)&&t.allowedOrigins.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:t.allowedOrigins.map(p=>e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-[#1a1a1a] border border-gray-700 rounded-lg",children:[e.jsx("span",{className:"text-sm text-white font-mono",children:p}),e.jsx("button",{onClick:()=>Ce(p),className:"text-red-400 hover:text-red-300 transition-colors",title:"Supprimer",children:e.jsx(we,{size:14})})]},p))}),(!(t!=null&&t.allowedOrigins)||t.allowedOrigins.length===0)&&e.jsx("p",{className:"text-xs text-gray-500",children:"Aucune origine configurÃ©e. Les valeurs par dÃ©faut seront utilisÃ©es."})]})}),e.jsx(M,{label:"Autoriser les credentials",description:"Permet l'envoi de cookies et headers d'authentification dans les requÃªtes cross-origin",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:(t==null?void 0:t.allowCredentials)!==void 0?t.allowCredentials:!0,onChange:p=>D({...t,allowCredentials:p.target.checked,allowedOrigins:(t==null?void 0:t.allowedOrigins)||[],allowedMethods:(t==null?void 0:t.allowedMethods)||["GET","POST","PUT","DELETE","OPTIONS","PATCH"],allowedHeaders:(t==null?void 0:t.allowedHeaders)||["Content-Type","Authorization","X-Requested-With"]}),className:"w-4 h-4 text-blue-600 bg-[#1a1a1a] border-gray-700 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-400",children:(t==null?void 0:t.allowCredentials)!==void 0&&t.allowCredentials?"ActivÃ©":"DÃ©sactivÃ©"})]})}),e.jsx(M,{label:"MÃ©thodes HTTP autorisÃ©es",description:"MÃ©thodes HTTP autorisÃ©es pour les requÃªtes cross-origin",children:e.jsxs("div",{className:"w-full space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:se,onChange:p=>$(p.target.value),onKeyPress:p=>p.key==="Enter"&&te(),placeholder:"GET, POST, PUT, DELETE, etc.",className:"flex-1 px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm placeholder-gray-500 focus:outline-none focus:border-blue-500"}),e.jsxs("button",{onClick:te,className:"px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(Pe,{size:14}),e.jsx("span",{children:"Ajouter"})]})]}),(t==null?void 0:t.allowedMethods)&&t.allowedMethods.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:t.allowedMethods.map(p=>e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-[#1a1a1a] border border-gray-700 rounded-lg",children:[e.jsx("span",{className:"text-sm text-white font-mono",children:p}),e.jsx("button",{onClick:()=>ue(p),className:"text-red-400 hover:text-red-300 transition-colors",title:"Supprimer",children:e.jsx(we,{size:14})})]},p))})]})}),e.jsx(M,{label:"Headers autorisÃ©s",description:"Headers HTTP autorisÃ©s dans les requÃªtes cross-origin",children:e.jsxs("div",{className:"w-full space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:P,onChange:p=>U(p.target.value),onKeyPress:p=>p.key==="Enter"&&le(),placeholder:"Content-Type, Authorization, etc.",className:"flex-1 px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm placeholder-gray-500 focus:outline-none focus:border-blue-500"}),e.jsxs("button",{onClick:le,className:"px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(Pe,{size:14}),e.jsx("span",{children:"Ajouter"})]})]}),(t==null?void 0:t.allowedHeaders)&&t.allowedHeaders.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:t.allowedHeaders.map(p=>e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-[#1a1a1a] border border-gray-700 rounded-lg",children:[e.jsx("span",{className:"text-sm text-white font-mono",children:p}),e.jsx("button",{onClick:()=>ze(p),className:"text-red-400 hover:text-red-300 transition-colors",title:"Supprimer",children:e.jsx(we,{size:14})})]},p))})]})}),e.jsx("div",{className:"flex justify-end pt-2 border-t border-gray-800",children:e.jsxs("button",{onClick:xe,disabled:c,className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-500 text-white text-sm rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[c?e.jsx(ie,{size:16,className:"animate-spin"}):e.jsx(ne,{size:16}),e.jsx("span",{children:"Sauvegarder la configuration CORS"})]})})]})}),e.jsxs("div",{className:"p-4 bg-blue-900/10 border border-blue-700/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Se,{size:18,className:"text-blue-400"}),e.jsx("h4",{className:"text-sm font-medium text-blue-400",children:"FonctionnalitÃ©s actives"})]}),e.jsxs("ul",{className:"space-y-1 text-xs text-gray-400",children:[e.jsx("li",{children:"â€¢ Protection contre les attaques brute force"}),e.jsx("li",{children:"â€¢ Blocage automatique des IPs et comptes"}),e.jsx("li",{children:"â€¢ Notifications de sÃ©curitÃ©"})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-800",children:e.jsxs("button",{onClick:ee,disabled:c,className:"flex items-center gap-2 px-6 py-2.5 bg-blue-600 hover:bg-blue-700 rounded-lg text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:[c?e.jsx(ie,{size:18,className:"animate-spin"}):e.jsx(ne,{size:18}),e.jsx("span",{children:"Sauvegarder les paramÃ¨tres"})]})})]})},Le={dark:{accentPrimary:"#3b82f6",accentPrimaryHover:"#2563eb",accentSuccess:"#10b981",accentWarning:"#f59e0b",accentError:"#ef4444",accentInfo:"#06b6d4",bgPrimary:"#0f0f0f",bgSecondary:"#1a1a1a",bgTertiary:"#252525",bgCard:"#1a1a1a",bgHeader:"#111111",bgFooter:"rgba(10, 10, 10, 0.9)",textPrimary:"#e5e5e5",textSecondary:"#999999",textTertiary:"#666666",borderColor:"#333333",borderColorLight:"#444444",borderColorHover:"#555555",buttonBg:"#1a1a1a",buttonText:"#e5e5e5",buttonHoverBg:"#252525",buttonHoverText:"#ffffff",buttonActiveBg:"#3b82f6",buttonActiveText:"#ffffff",buttonBorder:"#333333"},glass:{accentPrimary:"#5b9bd5",accentPrimaryHover:"#4a8bc2",accentSuccess:"#6bbf8e",accentWarning:"#d4a574",accentError:"#d87a7a",accentInfo:"#6bb3d4",bgPrimary:"#0a0a0a",bgSecondary:"rgba(20, 20, 25, 0.75)",bgTertiary:"rgba(30, 30, 35, 0.65)",bgCard:"rgba(22, 22, 28, 0.8)",bgHeader:"#0f0f0f",bgFooter:"#0f0f0f",textPrimary:"#e8e8e8",textSecondary:"#b8b8b8",textTertiary:"#888888",borderColor:"rgba(255, 255, 255, 0.08)",borderColorLight:"rgba(255, 255, 255, 0.12)",borderColorHover:"rgba(255, 255, 255, 0.18)",buttonBg:"rgba(30, 30, 35, 0.7)",buttonText:"#e8e8e8",buttonHoverBg:"rgba(40, 40, 45, 0.8)",buttonHoverText:"#ffffff",buttonActiveBg:"#5b9bd5",buttonActiveText:"#ffffff",buttonBorder:"rgba(255, 255, 255, 0.1)"},modern:{accentPrimary:"#8b7cf6",accentPrimaryHover:"#7c6af0",accentSuccess:"#6bbf8e",accentWarning:"#d4a574",accentError:"#e88a8a",accentInfo:"#6bb3d4",bgPrimary:"#0a0d14",bgSecondary:"rgba(30, 25, 50, 0.4)",bgTertiary:"rgba(40, 35, 65, 0.35)",bgCard:"rgba(35, 30, 55, 0.5)",bgHeader:"rgba(15, 12, 25, 0.95)",bgFooter:"rgba(15, 12, 25, 0.95)",textPrimary:"#f0f2f8",textSecondary:"#c8d0e0",textTertiary:"#9aa5b8",borderColor:"transparent",borderColorLight:"transparent",borderColorHover:"transparent",buttonBg:"rgba(40, 35, 60, 0.6)",buttonText:"#f0f2f8",buttonHoverBg:"rgba(50, 45, 75, 0.7)",buttonHoverText:"#ffffff",buttonActiveBg:"#8b7cf6",buttonActiveText:"#ffffff",buttonBorder:"transparent"},nightly:{accentPrimary:"#3b82f6",accentPrimaryHover:"#2563eb",accentSuccess:"#10b981",accentWarning:"#f59e0b",accentError:"#ef4444",accentInfo:"#06b6d4",bgPrimary:"#0f0f0f",bgSecondary:"#1a1a1a",bgTertiary:"#252525",bgCard:"#1a1a1a",bgHeader:"#111111",bgFooter:"rgba(10, 10, 10, 0.9)",textPrimary:"#e5e5e5",textSecondary:"#999999",textTertiary:"#666666",borderColor:"rgba(255, 255, 255, 0.03)",borderColorLight:"rgba(255, 255, 255, 0.05)",borderColorHover:"rgba(255, 255, 255, 0.08)",buttonBg:"#1a1a1a",buttonText:"#e5e5e5",buttonHoverBg:"#252525",buttonHoverText:"#ffffff",buttonActiveBg:"#3b82f6",buttonActiveText:"#ffffff",buttonBorder:"#333333"},neon:{accentPrimary:"#c084fc",accentPrimaryHover:"#a855f7",accentSuccess:"#34d399",accentWarning:"#fbbf24",accentError:"#f87171",accentInfo:"#60a5fa",bgPrimary:"rgba(15, 15, 25, 0.7)",bgSecondary:"rgba(30, 25, 45, 0.6)",bgTertiary:"rgba(45, 35, 65, 0.5)",bgCard:"rgba(40, 30, 60, 0.5)",bgHeader:"rgba(20, 15, 35, 0.8)",bgFooter:"rgba(15, 15, 25, 0.75)",textPrimary:"#f8fafc",textSecondary:"#e2e8f0",textTertiary:"#cbd5e1",borderColor:"rgba(192, 132, 252, 0.25)",borderColorLight:"rgba(192, 132, 252, 0.35)",borderColorHover:"rgba(167, 139, 250, 0.4)",buttonBg:"rgba(192, 132, 252, 0.2)",buttonText:"#f8fafc",buttonHoverBg:"rgba(167, 139, 250, 0.25)",buttonHoverText:"#ffffff",buttonActiveBg:"rgba(192, 132, 252, 0.5)",buttonActiveText:"#ffffff",buttonBorder:"rgba(192, 132, 252, 0.4)"},elegant:{accentPrimary:"#a78bfa",accentPrimaryHover:"#8b5cf6",accentSuccess:"#10b981",accentWarning:"#f59e0b",accentError:"#ef4444",accentInfo:"#06b6d4",bgPrimary:"#1a1a2e",bgSecondary:"rgba(45, 35, 65, 0.6)",bgTertiary:"rgba(60, 50, 80, 0.5)",bgCard:"rgba(35, 30, 55, 0.7)",bgHeader:"rgba(30, 25, 50, 0.85)",bgFooter:"rgba(25, 20, 45, 0.9)",textPrimary:"#f0f2f8",textSecondary:"#d8d0e8",textTertiary:"#b8aed8",borderColor:"rgba(196, 181, 253, 0.4)",borderColorLight:"rgba(196, 181, 253, 0.5)",borderColorHover:"rgba(167, 139, 250, 0.6)",buttonBg:"rgba(196, 181, 253, 0.25)",buttonText:"#f0f2f8",buttonHoverBg:"rgba(167, 139, 250, 0.35)",buttonHoverText:"#ffffff",buttonActiveBg:"#a78bfa",buttonActiveText:"#ffffff",buttonBorder:"rgba(196, 181, 253, 0.5)"}},ot=()=>{const[n,c]=r.useState(()=>{const s=document.documentElement.getAttribute("data-theme");return s&&["dark","glass","modern","nightly","neon","elegant"].includes(s)?s:ds()}),[h,E]=r.useState({}),[A,L]=r.useState(!1),[S,y]=r.useState(!1),[u,C]=r.useState(!1),T=_s();r.useEffect(()=>{F()},[]),r.useEffect(()=>{const s=()=>{const t=document.documentElement.getAttribute("data-theme"),D=t&&["dark","glass","modern","nightly","neon","elegant"].includes(t)?t:ds();c(H=>D!==H?D:H)};s();const k=()=>{s()};return window.addEventListener("themechange",k),()=>{window.removeEventListener("themechange",k)}},[]);const F=async()=>{try{const s=document.documentElement.getAttribute("data-theme"),k=s&&["dark","glass","modern","nightly","neon","elegant"].includes(s)?s:ds();c(k);const t=await _.get("/api/settings/theme");if(t.success&&t.result){const D=t.result.theme;["dark","glass","modern","nightly","neon","elegant"].includes(D)?(E(t.result.customColors||{}),c(D===k?D:k)):(console.warn(`Invalid theme from server: ${D}, keeping current: ${k}`),c(k))}else c(k)}catch(s){console.error("Failed to load theme config:",s);const k=document.documentElement.getAttribute("data-theme"),t=k&&["dark","glass","modern","nightly","neon","elegant"].includes(k)?k:ds();c(t)}},b=s=>{c(s),us(s),E({});const k=document.documentElement;Object.keys(Le[s]).forEach(t=>{const D=`--${t.replace(/([A-Z])/g,"-$1").toLowerCase()}`;k.style.removeProperty(D)}),window.dispatchEvent(new CustomEvent("themechange",{detail:{theme:s}})),x(s,{})},x=async(s,k)=>{try{const t={theme:s,customColors:Object.keys(k).length>0?k:void 0};await _.post("/api/settings/theme",t)}catch(t){console.error("Failed to save theme config:",t)}},j=(s,k)=>{E(t=>({...t,[s]:k}))},v=()=>{const s=document.documentElement,k={...Le[n],...h},t={accentPrimary:"accent-primary",accentPrimaryHover:"accent-primary-hover",accentSuccess:"accent-success",accentWarning:"accent-warning",accentError:"accent-error",accentInfo:"accent-info",bgPrimary:"bg-primary",bgSecondary:"bg-secondary",bgTertiary:"bg-tertiary",bgCard:"bg-card",bgHeader:"bg-header",bgFooter:"bg-footer",textPrimary:"text-primary",textSecondary:"text-secondary",textTertiary:"text-tertiary",borderColor:"border-color",borderColorLight:"border-color-light",borderColorHover:"border-color-hover",buttonBg:"button-bg",buttonText:"button-text",buttonHoverBg:"button-hover-bg",buttonHoverText:"button-hover-text",buttonActiveBg:"button-active-bg",buttonActiveText:"button-active-text",buttonBorder:"button-border"};Object.entries(k).forEach(([D,H])=>{const Z=t[D]||D.replace(/([A-Z])/g,"-$1").toLowerCase();s.style.setProperty(`--${Z}`,H)}),n==="glass"?s.style.setProperty("--backdrop-blur","blur(20px)"):n==="modern"?s.style.setProperty("--backdrop-blur","blur(12px)"):s.style.setProperty("--backdrop-blur","none"),window.dispatchEvent(new CustomEvent("themeupdate"))};r.useEffect(()=>{if(Object.keys(h).length>0)v();else{const s=document.documentElement;Object.keys(Le[n]).forEach(k=>{const t=`--${k.replace(/([A-Z])/g,"-$1").toLowerCase()}`;s.style.removeProperty(t)}),us(n)}},[h,n]);const i=async()=>{L(!0);try{const s=Le[n],k={};Object.entries(h).forEach(([t,D])=>{const H=t;D!==s[H]&&(k[H]=D)}),await x(n,k),alert("ThÃ¨me sauvegardÃ© avec succÃ¨s"),v()}catch(s){alert(s instanceof Error?s.message:"Erreur lors de la sauvegarde")}finally{L(!1)}},f=()=>{E({});const s=document.documentElement;Object.keys(Le[n]).forEach(k=>{const t=`--${k.replace(/([A-Z])/g,"-$1").toLowerCase()}`;s.style.removeProperty(t)}),us(n),window.dispatchEvent(new CustomEvent("themeupdate"))},o=s=>h[s]||Le[n][s];return e.jsx(V,{title:"ThÃ¨me de l'interface",icon:gs,iconColor:"yellow",children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-base font-semibold text-theme-primary mb-1",children:"ThÃ¨me principal"}),e.jsx("p",{className:"text-sm text-theme-secondary",children:"SÃ©lectionnez le thÃ¨me de base pour l'interface"})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h4",{className:"text-sm font-semibold text-theme-primary mb-4 px-6",children:"Black"}),e.jsx("div",{className:"grid grid-cols-4 gap-8 px-6",children:T.filter(s=>["dark","glass","nightly"].includes(s.id)).map(s=>{const k=Le[s.id],t=n===s.id;return e.jsxs("button",{onClick:()=>b(s.id),className:`relative group rounded-xl border-2 transition-all overflow-hidden ${t?"border-yellow-500 shadow-xl shadow-yellow-500/30 scale-[1.02]":"border-theme hover:border-yellow-500/50 hover:shadow-lg hover:shadow-yellow-500/10"} ${s.id==="modern"?"backdrop-blur-md":""}`,style:{background:s.id==="glass"?"#0a0a0a":s.id==="modern"?"linear-gradient(135deg, #1a1a2e 0%, #16213e 25%, #0f3460 50%, #533483 75%, #1a1a2e 100%)":(s.id==="nightly","#0f0f0f"),backdropFilter:s.id==="glass"||s.id==="modern"?"blur(12px)":"none",color:k.textPrimary},children:[s.id==="dark"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0",style:{background:"#0f0f0f"}}),e.jsx("div",{className:"absolute inset-0 opacity-40",style:{background:"linear-gradient(135deg, rgba(26, 26, 26, 0.8) 0%, rgba(37, 37, 37, 0.6) 100%)",border:"1px solid rgba(56, 56, 56, 0.5)"}})]}),s.id==="glass"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0",style:{background:"rgba(20, 20, 25, 0.75)",backdropFilter:"blur(16px)"}}),e.jsx("div",{className:"absolute inset-0 rounded-xl",style:{border:"1px solid rgba(255, 255, 255, 0.08)",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.5)"}})]}),s.id==="nightly"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0",style:{background:"#0f0f0f"}}),e.jsx("div",{className:"absolute inset-0 opacity-50",style:{background:"linear-gradient(135deg, rgba(26, 26, 26, 0.9) 0%, rgba(37, 37, 37, 0.7) 100%)",border:"1px solid rgba(255, 255, 255, 0.03)"}}),e.jsx("div",{className:"absolute inset-0 rounded-xl",style:{boxShadow:"inset 0 0 30px rgba(0, 0, 0, 0.5), 0 4px 16px rgba(0, 0, 0, 0.4)"}})]}),s.id==="modern"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0",style:{background:"linear-gradient(135deg, rgba(91, 155, 213, 0.35) 0%, rgba(139, 124, 246, 0.32) 25%, rgba(236, 72, 153, 0.3) 50%, rgba(139, 124, 246, 0.32) 75%, rgba(91, 155, 213, 0.35) 100%)"}}),e.jsx("div",{className:"absolute inset-0 opacity-30",style:{background:"linear-gradient(135deg, rgba(35, 30, 55, 0.5) 0%, rgba(40, 35, 65, 0.4) 100%)",backdropFilter:"blur(8px)"}}),e.jsx("div",{className:"absolute inset-0 rounded-xl",style:{boxShadow:"inset 0 0 20px rgba(139, 124, 246, 0.2), 0 0 15px rgba(91, 155, 213, 0.15)"}})]}),s.id==="neon"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0",style:{background:"linear-gradient(135deg, #8b5cf626, #a78bfa1a, #3b82f626 80%, #8b5cf61a)"}}),e.jsx("div",{className:"absolute inset-0 opacity-60",style:{background:"rgba(40, 30, 60, 0.5)",backdropFilter:"blur(12px)",border:"1px solid rgba(192, 132, 252, 0.25)"}}),e.jsx("div",{className:"absolute inset-0 rounded-xl",style:{boxShadow:"inset 0 0 20px rgba(192, 132, 252, 0.15), 0 0 20px rgba(139, 92, 246, 0.3)"}})]}),t&&e.jsx("div",{className:"absolute top-3 right-3 w-5 h-5 rounded-full bg-yellow-500 shadow-lg shadow-yellow-500/50 flex items-center justify-center",children:e.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})}),e.jsxs("div",{className:"relative z-10 p-5",children:[e.jsx("div",{className:"flex items-center gap-2 mb-4",children:e.jsxs("div",{className:"flex gap-1.5",children:[e.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/30 shadow-sm",style:{backgroundColor:k.accentPrimary},title:"Couleur principale"}),e.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/30 shadow-sm",style:{backgroundColor:k.textPrimary},title:"Couleur texte"}),e.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/30 shadow-sm",style:{backgroundColor:k.accentSuccess},title:"Badge succÃ¨s"}),e.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/30 shadow-sm",style:{backgroundColor:k.buttonBg},title:"Couleur bouton"})]})}),e.jsx("div",{className:"text-lg font-semibold mb-1",style:{color:k.textPrimary},children:s.name}),e.jsx("div",{className:"text-xs",style:{color:k.textSecondary},children:s.description})]})]},s.id)})})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h4",{className:"text-sm font-semibold text-theme-primary mb-4 px-6",children:"Couleur"}),e.jsx("div",{className:"grid grid-cols-4 gap-8 px-6",children:T.filter(s=>["modern","neon"].includes(s.id)).map(s=>{const k=Le[s.id],t=n===s.id;return e.jsxs("button",{onClick:()=>b(s.id),className:`relative group rounded-xl border-2 transition-all overflow-hidden ${t?"border-yellow-500 shadow-xl shadow-yellow-500/30 scale-[1.02]":"border-theme hover:border-yellow-500/50 hover:shadow-lg hover:shadow-yellow-500/10"} ${s.id==="modern"?"backdrop-blur-md":""}`,style:{background:s.id==="glass"?"#0a0a0a":s.id==="modern"?"linear-gradient(135deg, #1a1a2e 0%, #16213e 25%, #0f3460 50%, #533483 75%, #1a1a2e 100%)":(s.id==="nightly","#0f0f0f"),backdropFilter:s.id==="glass"||s.id==="modern"?"blur(12px)":"none",color:k.textPrimary},children:[s.id==="modern"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0",style:{background:"linear-gradient(135deg, rgba(91, 155, 213, 0.35) 0%, rgba(139, 124, 246, 0.32) 25%, rgba(236, 72, 153, 0.3) 50%, rgba(139, 124, 246, 0.32) 75%, rgba(91, 155, 213, 0.35) 100%)"}}),e.jsx("div",{className:"absolute inset-0 opacity-30",style:{background:"linear-gradient(135deg, rgba(35, 30, 55, 0.5) 0%, rgba(40, 35, 65, 0.4) 100%)",backdropFilter:"blur(8px)"}}),e.jsx("div",{className:"absolute inset-0 rounded-xl",style:{boxShadow:"inset 0 0 20px rgba(139, 124, 246, 0.2), 0 0 15px rgba(91, 155, 213, 0.15)"}})]}),s.id==="neon"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0",style:{background:"linear-gradient(135deg, #8b5cf626, #a78bfa1a, #3b82f626 80%, #8b5cf61a)"}}),e.jsx("div",{className:"absolute inset-0 opacity-60",style:{background:"rgba(40, 30, 60, 0.5)",backdropFilter:"blur(12px)",border:"1px solid rgba(192, 132, 252, 0.25)"}}),e.jsx("div",{className:"absolute inset-0 rounded-xl",style:{boxShadow:"inset 0 0 20px rgba(192, 132, 252, 0.15), 0 0 20px rgba(139, 92, 246, 0.3)"}})]}),t&&e.jsx("div",{className:"absolute top-3 right-3 w-5 h-5 rounded-full bg-yellow-500 shadow-lg shadow-yellow-500/50 flex items-center justify-center",children:e.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})}),e.jsxs("div",{className:"relative z-10 p-5",children:[e.jsx("div",{className:"flex items-center gap-2 mb-4",children:e.jsxs("div",{className:"flex gap-1.5",children:[e.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/30 shadow-sm",style:{backgroundColor:k.accentPrimary},title:"Couleur principale"}),e.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/30 shadow-sm",style:{backgroundColor:k.textPrimary},title:"Couleur texte"}),e.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/30 shadow-sm",style:{backgroundColor:k.accentSuccess},title:"Badge succÃ¨s"}),e.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/30 shadow-sm",style:{backgroundColor:k.buttonBg},title:"Couleur bouton"})]})}),e.jsx("div",{className:"text-lg font-semibold mb-1",style:{color:k.textPrimary},children:s.name}),e.jsx("div",{className:"text-xs",style:{color:k.textSecondary},children:s.description})]})]},s.id)})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-theme-primary mb-4 px-6",children:"Animation"}),e.jsx("div",{className:"grid grid-cols-4 gap-8 px-6",children:T.filter(s=>["elegant"].includes(s.id)).map(s=>{const k=Le[s.id],t=n===s.id;return e.jsxs("button",{onClick:()=>b(s.id),className:`relative group rounded-xl border-2 transition-all overflow-hidden ${t?"border-yellow-500 shadow-xl shadow-yellow-500/30 scale-[1.02]":"border-theme hover:border-yellow-500/50 hover:shadow-lg hover:shadow-yellow-500/10"} backdrop-blur-md`,style:{background:"linear-gradient(135deg, rgba(147, 197, 253, 0.3) 0%, rgba(196, 181, 253, 0.28) 25%, rgba(251, 207, 232, 0.26) 50%, rgba(196, 181, 253, 0.28) 75%, rgba(147, 197, 253, 0.3) 100%)",backdropFilter:"blur(12px)",color:k.textPrimary,position:"relative",overflow:"hidden"},children:[e.jsx("div",{className:"absolute inset-0 elegant-gradient",style:{background:"linear-gradient(135deg, rgba(147, 197, 253, 0.4) 0%, rgba(196, 181, 253, 0.35) 25%, rgba(251, 207, 232, 0.3) 50%, rgba(196, 181, 253, 0.35) 75%, rgba(147, 197, 253, 0.4) 100%)",backgroundSize:"400% 400%",animation:"elegantGradientShift 12s ease infinite"}}),e.jsx("div",{className:"absolute inset-0 opacity-70",style:{background:"rgba(35, 30, 55, 0.6)",backdropFilter:"blur(12px)",border:"1px solid rgba(196, 181, 253, 0.4)"}}),e.jsx("div",{className:"absolute inset-0 rounded-xl elegant-preview-glow",style:{boxShadow:"inset 0 0 30px rgba(196, 181, 253, 0.3), 0 0 20px rgba(251, 207, 232, 0.25)",animation:"elegantPreviewGlow 3s ease-in-out infinite"}}),t&&e.jsx("div",{className:"absolute top-3 right-3 w-5 h-5 rounded-full bg-yellow-500 shadow-lg shadow-yellow-500/50 flex items-center justify-center",children:e.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})}),e.jsxs("div",{className:"relative z-10 p-5",children:[e.jsx("div",{className:"flex items-center gap-2 mb-4",children:e.jsxs("div",{className:"flex gap-1.5",children:[e.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/30 shadow-sm elegant-icon-pulse",style:{backgroundColor:k.accentPrimary},title:"Couleur principale"}),e.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/30 shadow-sm",style:{backgroundColor:k.textPrimary},title:"Couleur texte"}),e.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/30 shadow-sm elegant-icon-pulse",style:{backgroundColor:k.accentSuccess},title:"Badge succÃ¨s"}),e.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/30 shadow-sm",style:{backgroundColor:k.buttonBg},title:"Couleur bouton"})]})}),e.jsx("div",{className:"text-lg font-semibold mb-1",style:{color:k.textPrimary},children:s.name}),e.jsx("div",{className:"text-xs",style:{color:k.textSecondary},children:s.description})]})]},s.id)})})]})]}),e.jsxs("div",{className:"border-t border-theme pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-base font-semibold text-theme-primary mb-1 flex items-center gap-2",children:[e.jsx(Ws,{size:18,className:"text-yellow-400"}),"Personnalisation des couleurs"]}),e.jsx("p",{className:"text-sm text-theme-secondary",children:"Ajustez les couleurs selon vos prÃ©fÃ©rences"})]}),e.jsx("button",{onClick:()=>C(!u),className:"px-4 py-2 bg-theme-secondary border border-theme hover:border-yellow-500/50 rounded-lg transition-all flex items-center gap-2 text-sm text-theme-primary",children:u?e.jsxs(e.Fragment,{children:[e.jsx(Gs,{size:16}),e.jsx("span",{children:"Masquer"})]}):e.jsxs(e.Fragment,{children:[e.jsx(zs,{size:16}),e.jsx("span",{children:"Afficher"})]})})]}),u&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-end gap-3 pb-4 border-b border-theme",children:[e.jsxs("button",{onClick:f,className:"px-4 py-2 bg-theme-secondary border border-theme hover:border-red-500/50 rounded-lg transition-all flex items-center gap-2 text-sm text-theme-primary hover:bg-theme-primary",children:[e.jsx(de,{size:14}),"RÃ©initialiser"]}),e.jsx("button",{onClick:i,disabled:A,className:"px-4 py-2 bg-gradient-to-r from-yellow-600 to-yellow-500 hover:from-yellow-500 hover:to-yellow-400 rounded-lg text-white transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 text-sm font-medium shadow-lg shadow-yellow-500/20",children:A?e.jsxs(e.Fragment,{children:[e.jsx(de,{size:14,className:"animate-spin"}),e.jsx("span",{children:"Sauvegarde..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{size:14}),e.jsx("span",{children:"Sauvegarder"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-theme-secondary rounded-xl border border-theme p-4",children:[e.jsxs("h5",{className:"text-xs font-semibold text-theme-primary mb-3 flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-4 bg-blue-500 rounded-full"}),"Couleurs principales"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-medium text-theme-secondary mb-1.5",children:"Couleur primaire"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("input",{type:"color",value:o("accentPrimary"),onChange:s=>j("accentPrimary",s.target.value),className:"w-7 h-7 rounded border border-theme cursor-pointer"}),e.jsx("input",{type:"text",value:o("accentPrimary"),onChange:s=>j("accentPrimary",s.target.value),className:"w-20 px-1.5 py-0.5 bg-theme-primary border border-theme rounded text-theme-primary text-[10px] font-mono focus:outline-none focus:border-yellow-500/50",placeholder:"#3b82f6"}),e.jsx("div",{className:"w-8 h-8 rounded border border-theme/30 flex items-center justify-center text-[10px] font-medium transition-all",style:{backgroundColor:o("accentPrimary"),color:"#fff"},children:"Ex"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-medium text-theme-secondary mb-1.5",children:"Couleur primaire (hover)"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("input",{type:"color",value:o("accentPrimaryHover"),onChange:s=>j("accentPrimaryHover",s.target.value),className:"w-7 h-7 rounded border border-theme cursor-pointer"}),e.jsx("input",{type:"text",value:o("accentPrimaryHover"),onChange:s=>j("accentPrimaryHover",s.target.value),className:"w-20 px-1.5 py-0.5 bg-theme-primary border border-theme rounded text-theme-primary text-[10px] font-mono focus:outline-none focus:border-yellow-500/50",placeholder:"#2563eb"}),e.jsx("div",{className:"w-8 h-8 rounded border border-theme/30 flex items-center justify-center text-[10px] font-medium transition-all",style:{backgroundColor:o("accentPrimaryHover"),color:"#fff"},children:"Ex"})]})]})]})]}),e.jsxs("div",{className:"bg-theme-secondary rounded-xl border border-theme p-4",children:[e.jsxs("h5",{className:"text-xs font-semibold text-theme-primary mb-3 flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-4 bg-emerald-500 rounded-full"}),"Couleurs de statut"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-[10px] font-medium text-theme-secondary mb-1.5 flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-emerald-500"}),"SuccÃ¨s"]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("input",{type:"color",value:o("accentSuccess"),onChange:s=>j("accentSuccess",s.target.value),className:"w-7 h-7 rounded border border-theme cursor-pointer"}),e.jsx("input",{type:"text",value:o("accentSuccess"),onChange:s=>j("accentSuccess",s.target.value),className:"w-20 px-1.5 py-0.5 bg-theme-primary border border-theme rounded text-theme-primary text-[10px] font-mono focus:outline-none focus:border-yellow-500/50"}),e.jsx("div",{className:"w-8 h-8 rounded border border-theme/30 flex items-center justify-center text-[10px] font-medium transition-all",style:{backgroundColor:o("accentSuccess"),color:"#fff"},children:"âœ“"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-[10px] font-medium text-theme-secondary mb-1.5 flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-yellow-500"}),"Avertissement"]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("input",{type:"color",value:o("accentWarning"),onChange:s=>j("accentWarning",s.target.value),className:"w-7 h-7 rounded border border-theme cursor-pointer"}),e.jsx("input",{type:"text",value:o("accentWarning"),onChange:s=>j("accentWarning",s.target.value),className:"w-20 px-1.5 py-0.5 bg-theme-primary border border-theme rounded text-theme-primary text-[10px] font-mono focus:outline-none focus:border-yellow-500/50"}),e.jsx("div",{className:"w-8 h-8 rounded border border-theme/30 flex items-center justify-center text-[10px] font-medium transition-all",style:{backgroundColor:o("accentWarning"),color:"#000"},children:"âš "})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-[10px] font-medium text-theme-secondary mb-1.5 flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-red-500"}),"Erreur"]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("input",{type:"color",value:o("accentError"),onChange:s=>j("accentError",s.target.value),className:"w-7 h-7 rounded border border-theme cursor-pointer"}),e.jsx("input",{type:"text",value:o("accentError"),onChange:s=>j("accentError",s.target.value),className:"w-20 px-1.5 py-0.5 bg-theme-primary border border-theme rounded text-theme-primary text-[10px] font-mono focus:outline-none focus:border-yellow-500/50"}),e.jsx("div",{className:"w-8 h-8 rounded border border-theme/30 flex items-center justify-center text-[10px] font-medium transition-all",style:{backgroundColor:o("accentError"),color:"#fff"},children:"âœ•"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-[10px] font-medium text-theme-secondary mb-1.5 flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-cyan-500"}),"Information"]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("input",{type:"color",value:o("accentInfo"),onChange:s=>j("accentInfo",s.target.value),className:"w-7 h-7 rounded border border-theme cursor-pointer"}),e.jsx("input",{type:"text",value:o("accentInfo"),onChange:s=>j("accentInfo",s.target.value),className:"w-20 px-1.5 py-0.5 bg-theme-primary border border-theme rounded text-theme-primary text-[10px] font-mono focus:outline-none focus:border-yellow-500/50"}),e.jsx("div",{className:"w-8 h-8 rounded border border-theme/30 flex items-center justify-center text-[10px] font-medium transition-all",style:{backgroundColor:o("accentInfo"),color:"#fff"},children:"i"})]})]})]})]}),e.jsxs("div",{className:"bg-theme-secondary rounded-xl border border-theme p-4",children:[e.jsxs("h5",{className:"text-xs font-semibold text-theme-primary mb-3 flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-4 bg-purple-500 rounded-full"}),"ArriÃ¨re-plans"]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-medium text-theme-secondary mb-1.5",children:"ArriÃ¨re-plan principal"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("input",{type:"color",value:o("bgPrimary").replace(/rgba?\([^)]+\)/,"#0f0f0f"),onChange:s=>j("bgPrimary",s.target.value),className:"w-7 h-7 rounded border border-theme cursor-pointer"}),e.jsx("input",{type:"text",value:o("bgPrimary"),onChange:s=>j("bgPrimary",s.target.value),className:"w-20 px-1.5 py-0.5 bg-theme-primary border border-theme rounded text-theme-primary text-[10px] font-mono focus:outline-none focus:border-yellow-500/50"}),e.jsx("div",{className:"w-8 h-8 rounded border border-theme/30 transition-all",style:{backgroundColor:o("bgPrimary")}})]})]})})]}),e.jsxs("div",{className:"bg-theme-secondary rounded-xl border border-theme p-4",children:[e.jsxs("h5",{className:"text-xs font-semibold text-theme-primary mb-3 flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-4 bg-cyan-500 rounded-full"}),"Couleurs de texte"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-medium text-theme-secondary mb-1.5",children:"Texte principal"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("input",{type:"color",value:o("textPrimary"),onChange:s=>j("textPrimary",s.target.value),className:"w-7 h-7 rounded border border-theme cursor-pointer"}),e.jsx("input",{type:"text",value:o("textPrimary"),onChange:s=>j("textPrimary",s.target.value),className:"w-20 px-1.5 py-0.5 bg-theme-primary border border-theme rounded text-theme-primary text-[10px] font-mono focus:outline-none focus:border-yellow-500/50"}),e.jsx("div",{className:"w-8 h-8 rounded border border-theme/30 flex items-center justify-center text-[10px] font-medium transition-all",style:{backgroundColor:o("bgSecondary"),color:o("textPrimary")},children:"Aa"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-medium text-theme-secondary mb-1.5",children:"Texte secondaire"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("input",{type:"color",value:o("textSecondary"),onChange:s=>j("textSecondary",s.target.value),className:"w-7 h-7 rounded border border-theme cursor-pointer"}),e.jsx("input",{type:"text",value:o("textSecondary"),onChange:s=>j("textSecondary",s.target.value),className:"w-20 px-1.5 py-0.5 bg-theme-primary border border-theme rounded text-theme-primary text-[10px] font-mono focus:outline-none focus:border-yellow-500/50"}),e.jsx("div",{className:"w-8 h-8 rounded border border-theme/30 flex items-center justify-center text-[10px] font-medium transition-all",style:{backgroundColor:o("bgSecondary"),color:o("textSecondary")},children:"Aa"})]})]})]})]}),e.jsxs("div",{className:"bg-theme-secondary rounded-xl border border-theme p-4",children:[e.jsxs("h5",{className:"text-xs font-semibold text-theme-primary mb-3 flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-4 bg-gray-500 rounded-full"}),"Couleurs de bordure"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-medium text-theme-secondary mb-1.5",children:"Bordure"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("input",{type:"color",value:o("borderColor").replace(/rgba?\([^)]+\)/,"#333333"),onChange:s=>j("borderColor",s.target.value),className:"w-7 h-7 rounded border border-theme cursor-pointer"}),e.jsx("input",{type:"text",value:o("borderColor"),onChange:s=>j("borderColor",s.target.value),className:"w-20 px-1.5 py-0.5 bg-theme-primary border border-theme rounded text-theme-primary text-[10px] font-mono focus:outline-none focus:border-yellow-500/50"}),e.jsx("div",{className:"w-8 h-8 rounded border border-theme/30 transition-all",style:{backgroundColor:o("bgSecondary"),borderColor:o("borderColor")}})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-medium text-theme-secondary mb-1.5",children:"Bordure (light)"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("input",{type:"color",value:o("borderColorLight").replace(/rgba?\([^)]+\)/,"#444444"),onChange:s=>j("borderColorLight",s.target.value),className:"w-7 h-7 rounded border border-theme cursor-pointer"}),e.jsx("input",{type:"text",value:o("borderColorLight"),onChange:s=>j("borderColorLight",s.target.value),className:"w-20 px-1.5 py-0.5 bg-theme-primary border border-theme rounded text-theme-primary text-[10px] font-mono focus:outline-none focus:border-yellow-500/50"}),e.jsx("div",{className:"w-8 h-8 rounded border border-theme/30 transition-all",style:{backgroundColor:o("bgSecondary"),borderColor:o("borderColorLight")}})]})]})]})]}),e.jsxs("div",{className:"bg-theme-secondary rounded-xl border border-theme p-4",children:[e.jsxs("h5",{className:"text-xs font-semibold text-theme-primary mb-3 flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-4 bg-orange-500 rounded-full"}),"Couleurs des boutons"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-medium text-theme-secondary mb-1.5",children:"Fond du bouton"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("input",{type:"color",value:o("buttonBg").replace(/rgba?\([^)]+\)/,"#1a1a1a"),onChange:s=>j("buttonBg",s.target.value),className:"w-7 h-7 rounded border border-theme cursor-pointer"}),e.jsx("input",{type:"text",value:o("buttonBg"),onChange:s=>j("buttonBg",s.target.value),className:"w-20 px-1.5 py-0.5 bg-theme-primary border border-theme rounded text-theme-primary text-[10px] font-mono focus:outline-none focus:border-yellow-500/50"}),e.jsx("button",{className:"w-8 h-8 rounded border border-theme/30 flex items-center justify-center text-[10px] font-medium transition-all",style:{backgroundColor:o("buttonBg"),color:o("buttonText")},children:"Btn"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-medium text-theme-secondary mb-1.5",children:"Texte du bouton"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("input",{type:"color",value:o("buttonText"),onChange:s=>j("buttonText",s.target.value),className:"w-7 h-7 rounded border border-theme cursor-pointer"}),e.jsx("input",{type:"text",value:o("buttonText"),onChange:s=>j("buttonText",s.target.value),className:"w-20 px-1.5 py-0.5 bg-theme-primary border border-theme rounded text-theme-primary text-[10px] font-mono focus:outline-none focus:border-yellow-500/50"}),e.jsx("button",{className:"w-8 h-8 rounded border border-theme/30 flex items-center justify-center text-[10px] font-medium transition-all",style:{backgroundColor:o("buttonBg"),color:o("buttonText")},children:"Btn"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-medium text-theme-secondary mb-1.5",children:"Fond du bouton (actif)"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("input",{type:"color",value:o("buttonActiveBg"),onChange:s=>j("buttonActiveBg",s.target.value),className:"w-7 h-7 rounded border border-theme cursor-pointer"}),e.jsx("input",{type:"text",value:o("buttonActiveBg"),onChange:s=>j("buttonActiveBg",s.target.value),className:"w-20 px-1.5 py-0.5 bg-theme-primary border border-theme rounded text-theme-primary text-[10px] font-mono focus:outline-none focus:border-yellow-500/50"}),e.jsx("button",{className:"w-8 h-8 rounded border border-theme/30 flex items-center justify-center text-[10px] font-medium transition-all",style:{backgroundColor:o("buttonActiveBg"),color:o("buttonActiveText")},children:"Act"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-medium text-theme-secondary mb-1.5",children:"Texte du bouton (actif)"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("input",{type:"color",value:o("buttonActiveText"),onChange:s=>j("buttonActiveText",s.target.value),className:"w-7 h-7 rounded border border-theme cursor-pointer"}),e.jsx("input",{type:"text",value:o("buttonActiveText"),onChange:s=>j("buttonActiveText",s.target.value),className:"w-20 px-1.5 py-0.5 bg-theme-primary border border-theme rounded text-theme-primary text-[10px] font-mono focus:outline-none focus:border-yellow-500/50"}),e.jsx("button",{className:"w-8 h-8 rounded border border-theme/30 flex items-center justify-center text-[10px] font-medium transition-all",style:{backgroundColor:o("buttonActiveBg"),color:o("buttonActiveText")},children:"Act"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-medium text-theme-secondary mb-1.5",children:"Bordure du bouton"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("input",{type:"color",value:o("buttonBorder").replace(/rgba?\([^)]+\)/,"#333333"),onChange:s=>j("buttonBorder",s.target.value),className:"w-7 h-7 rounded border border-theme cursor-pointer"}),e.jsx("input",{type:"text",value:o("buttonBorder"),onChange:s=>j("buttonBorder",s.target.value),className:"w-20 px-1.5 py-0.5 bg-theme-primary border border-theme rounded text-theme-primary text-[10px] font-mono focus:outline-none focus:border-yellow-500/50"}),e.jsx("div",{className:"w-8 h-8 rounded border border-theme/30 transition-all",style:{backgroundColor:o("buttonBg"),borderColor:o("buttonBorder")}})]})]})]})]})]})]})]})]})})},pe=({enabled:n,onChange:c,disabled:h})=>e.jsx("button",{onClick:()=>!h&&c(!n),disabled:h,className:`relative w-11 h-6 rounded-full transition-colors ${h?"opacity-50 cursor-not-allowed":"cursor-pointer"} ${n?"bg-emerald-500":"bg-gray-600"}`,children:e.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 rounded-full bg-white transition-transform ${n?"translate-x-5":"translate-x-0"}`})}),M=({label:n,description:c,children:h})=>e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-800 last:border-b-0",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-white",children:n}),c&&e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:c})]}),e.jsx("div",{className:"ml-4",children:h})]}),V=({title:n,icon:c,children:h,permissionError:E,freeboxSettingsUrl:A,iconColor:L})=>{const y=L?{blue:"text-blue-400",purple:"text-purple-400",emerald:"text-emerald-400",cyan:"text-cyan-400",red:"text-red-400",amber:"text-amber-400",yellow:"text-yellow-400",violet:"text-violet-300",teal:"text-teal-300",orange:"text-orange-400"}[L]:"text-theme-secondary";return e.jsxs("div",{className:`bg-theme-card rounded-xl border border-theme overflow-hidden ${E?"opacity-60":""}`,style:{backdropFilter:"var(--backdrop-blur)"},children:[e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 border-b border-theme bg-theme-primary",children:[e.jsx(c,{size:18,className:y}),e.jsx("h3",{className:"font-medium theme-section-title",children:n})]}),E&&e.jsx("div",{className:"px-4 py-3 bg-amber-900/20 border-b border-amber-700/30",children:e.jsxs("p",{className:"text-amber-400 text-xs",children:[E,A&&e.jsxs(e.Fragment,{children:[" ",e.jsxs("a",{href:A,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-amber-300 hover:text-amber-200 underline",children:["Ouvrir les paramÃ¨tres Freebox",e.jsx(Ee,{size:12})]})]})]})}),e.jsx("div",{className:`px-4 py-4 ${E?"pointer-events-none":""}`,children:h})]})},ct=()=>{const[n,c]=r.useState([]),[h,E]=r.useState(!1),[A]=r.useState(!1),[L,S]=r.useState("all"),[y,u]=r.useState(!1),[C,T]=r.useState(0),F=r.useRef(null);r.useEffect(()=>{b()},[L,y]),r.useEffect(()=>{n.length>0&&F.current&&setTimeout(()=>{F.current&&(F.current.scrollTop=F.current.scrollHeight)},100)},[n]);const b=async()=>{E(!0);try{const f=y?"10000":"500",o=new URLSearchParams({limit:f});L!=="all"&&o.append("level",L);const s=await _.get(`/api/debug/logs?${o}`);s.success&&s.result&&(c(s.result.logs),T(s.result.total||0),setTimeout(()=>{F.current&&(F.current.scrollTop=F.current.scrollHeight)},100))}catch(f){console.error("[AppLogsSection] Error loading logs:",f)}finally{E(!1)}},x=async()=>{if(confirm(`Voulez-vous vraiment nettoyer la mÃ©moire ?

Cela supprimera tous les logs du buffer en mÃ©moire (max 1000 logs). Cette action est irrÃ©versible.`))try{await _.delete("/api/debug/logs"),c([]),T(0)}catch(f){console.error("[AppLogsSection] Error clearing logs:",f)}},j=f=>{switch(f){case"error":return"text-red-400";case"warn":return"text-yellow-400";case"info":return"text-cyan-400";case"debug":return"text-blue-400";case"verbose":return"text-magenta-400";default:return"text-gray-400"}},v=f=>new Date(f).toLocaleTimeString("fr-FR",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),i=r.useMemo(()=>L==="all"?n:n.filter(f=>f.level===L),[n,L]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("button",{onClick:()=>S("all"),className:`px-3 py-1.5 rounded-full text-xs font-medium transition-all ${L==="all"?"bg-gray-600 text-white border-2 border-gray-500":"bg-[#1a1a1a] text-gray-400 border border-gray-700 hover:bg-gray-800 hover:text-gray-300"}`,title:"Afficher tous les logs (tous niveaux confondus)",children:"Tous"}),e.jsx("button",{onClick:()=>S("error"),className:`px-3 py-1.5 rounded-full text-xs font-medium transition-all ${L==="error"?"bg-red-600 text-white border-2 border-red-400":"bg-[#1a1a1a] text-red-400 border border-red-800/50 hover:bg-red-900/20 hover:text-red-300"}`,title:"Afficher uniquement les logs d'erreur (niveau error)",children:"Erreurs"}),e.jsx("button",{onClick:()=>S("warn"),className:`px-3 py-1.5 rounded-full text-xs font-medium transition-all ${L==="warn"?"bg-yellow-600 text-white border-2 border-yellow-400":"bg-[#1a1a1a] text-yellow-400 border border-yellow-800/50 hover:bg-yellow-900/20 hover:text-yellow-300"}`,title:"Afficher uniquement les logs d'avertissement (niveau warn)",children:"Avertissements"}),e.jsx("button",{onClick:()=>S("info"),className:`px-3 py-1.5 rounded-full text-xs font-medium transition-all ${L==="info"?"bg-cyan-600 text-white border-2 border-cyan-400":"bg-[#1a1a1a] text-cyan-400 border border-cyan-800/50 hover:bg-cyan-900/20 hover:text-cyan-300"}`,title:"Afficher uniquement les logs informatifs (niveau info)",children:"Infos"}),e.jsx("button",{onClick:()=>S("debug"),className:`px-3 py-1.5 rounded-full text-xs font-medium transition-all ${L==="debug"?"bg-blue-600 text-white border-2 border-blue-400":"bg-[#1a1a1a] text-blue-400 border border-blue-800/50 hover:bg-blue-900/20 hover:text-blue-300"}`,title:"Afficher uniquement les logs de dÃ©bogage (niveau debug)",children:"Debug"}),e.jsx("button",{onClick:()=>S("verbose"),className:`px-3 py-1.5 rounded-full text-xs font-medium transition-all ${L==="verbose"?"bg-purple-600 text-white border-2 border-purple-400":"bg-[#1a1a1a] text-purple-400 border border-purple-800/50 hover:bg-purple-900/20 hover:text-purple-300"}`,title:"Afficher uniquement les logs verbeux (niveau verbose)",children:"Verbose"}),e.jsxs("span",{className:"text-xs text-gray-500 ml-2",title:`${i.length} log${i.length!==1?"s":""} affichÃ©${i.length!==1?"s":""}${C>i.length?` sur ${C} au total`:""}`,children:[i.length," log",i.length!==1?"s":"",C>i.length&&` / ${C} total`]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>{u(!y)},className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm transition-colors ${y?"bg-purple-600 hover:bg-purple-500 text-white":"bg-gray-700 hover:bg-gray-600 text-gray-300"}`,title:y?"Afficher les 500 derniers logs":`Afficher tous les logs (${C} au total)`,children:[e.jsx(rs,{size:14}),e.jsx("span",{children:y?"500 derniers":"Voir tout"})]}),e.jsx("button",{onClick:b,disabled:h,className:"px-3 py-1.5 bg-blue-600 hover:bg-blue-500 text-white rounded-lg text-sm transition-colors disabled:opacity-50",title:"RafraÃ®chir manuellement la liste des logs",children:e.jsx(de,{size:14,className:h?"animate-spin":""})}),e.jsxs("button",{onClick:x,className:"px-3 py-1.5 bg-orange-600 hover:bg-orange-500 text-white rounded-lg text-sm transition-colors flex items-center gap-2",title:"Nettoyer la mÃ©moire : supprime tous les logs du buffer en mÃ©moire (max 1000 logs). Utile pour libÃ©rer la mÃ©moire aprÃ¨s un dÃ©bogage.",children:[e.jsx(Zs,{size:14}),e.jsx("span",{children:"Nettoyer"})]})]})]}),y&&i.length>1e3&&e.jsx("div",{className:"mb-2 p-3 bg-yellow-500/10 border border-yellow-500/30 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2 text-yellow-400 text-sm",children:[e.jsx(ce,{size:16}),e.jsxs("span",{children:[e.jsx("strong",{children:"Attention :"})," Affichage de ",i.length.toLocaleString()," logs. Cela peut affecter les performances du navigateur."]})]})}),e.jsx("div",{className:"bg-[#0a0a0a] border border-gray-800 rounded-lg overflow-hidden mt-2",children:e.jsx("div",{ref:F,className:"h-96 overflow-y-auto p-4 font-mono text-xs",children:i.length===0?e.jsxs("div",{className:"text-center text-gray-500 py-8",children:[e.jsx(rs,{size:32,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"Aucun log disponible"}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:'Utilisez le bouton "RafraÃ®chir" pour charger les logs'})]}):e.jsx(e.Fragment,{children:i.map((f,o)=>e.jsxs("div",{className:`mb-1 flex items-start gap-2 ${j(f.level)}`,children:[e.jsx("span",{className:"text-gray-600 min-w-[80px]",children:v(f.timestamp)}),e.jsxs("span",{className:"text-gray-500 min-w-[80px]",children:["[",f.prefix,"]"]}),e.jsx("span",{className:"flex-1",children:f.message}),f.args&&f.args.length>0&&e.jsx("span",{className:"text-gray-600 text-[10px]",children:JSON.stringify(f.args).substring(0,100)})]},`${f.timestamp}-${o}`))})})})]})},dt=()=>{const[n,c]=r.useState(null),[h,E]=r.useState(!1),[A,L]=r.useState(!1);r.useEffect(()=>{S()},[]);const S=async()=>{E(!0);try{const u=await _.get("/api/debug/config");u.success&&u.result&&c(u.result)}catch(u){console.error("[DebugLogSection] Error loading config:",u)}finally{E(!1)}},y=async(u,C)=>{if(n){L(!0);try{const T={...n,[u]:C},F=await _.post("/api/debug/config",T);F.success&&F.result&&c(F.result)}catch(T){console.error("[DebugLogSection] Error setting config:",T)}finally{L(!1)}}};return h||!n?e.jsxs("div",{className:"py-4 text-center text-gray-500",children:[e.jsx(ie,{size:20,className:"mx-auto mb-2 animate-spin"}),e.jsx("p",{className:"text-sm",children:"Chargement..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(M,{label:"Logs de debug",description:"Active l'affichage des logs de debug dans la console du serveur (informations dÃ©taillÃ©es sur les opÃ©rations)",children:e.jsx(pe,{enabled:n.debug,onChange:u=>y("debug",u),disabled:A})}),e.jsx(M,{label:"Logs verbeux",description:"Active l'affichage des logs trÃ¨s dÃ©taillÃ©s (verbose) - nÃ©cessite que le mode debug soit activÃ©",children:e.jsx(pe,{enabled:n.verbose,onChange:u=>y("verbose",u),disabled:A||!n.debug})}),!n.debug&&e.jsx("div",{className:"mt-3 p-3 bg-blue-500/10 border border-blue-500/30 rounded-lg",children:e.jsx("p",{className:"text-xs text-blue-400",children:"Les logs de debug sont dÃ©sactivÃ©s. Activez-les pour voir les dÃ©tails des opÃ©rations dans les logs du serveur."})}),n.debug&&e.jsx("div",{className:"mt-3 p-3 bg-amber-500/10 border border-amber-500/30 rounded-lg",children:e.jsx("p",{className:"text-xs text-amber-400",children:"Les logs de debug sont activÃ©s. Les logs du serveur afficheront plus d'informations dÃ©taillÃ©es."})})]})},xt=()=>{const{updateConfig:n,updateInfo:c,loadConfig:h,setConfig:E,checkForUpdates:A,isLoading:L}=Rs(),[S,y]=r.useState(!1);r.useEffect(()=>{h(),n!=null&&n.enabled&&A()},[]);const u=async C=>{y(!0);try{await E(C)}catch(T){console.error("[UpdateCheckSection] Error setting config:",T)}finally{y(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(M,{label:"VÃ©rification automatique des mises Ã  jour",description:"Active la vÃ©rification des nouvelles versions disponibles sur GitHub Container Registry",children:e.jsx(pe,{enabled:(n==null?void 0:n.enabled)??!0,onChange:u,disabled:S})}),(n==null?void 0:n.enabled)&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"py-3 border-t border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Version actuelle"}),e.jsx("span",{className:"text-sm font-mono text-white",children:(c==null?void 0:c.currentVersion)||"0.0.0"})]}),(c==null?void 0:c.latestVersion)&&e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"DerniÃ¨re version disponible"}),e.jsx("span",{className:"text-sm font-mono text-amber-400",children:c.latestVersion})]}),(c==null?void 0:c.updateAvailable)&&e.jsxs("div",{className:"mt-3 p-3 bg-amber-500/10 border border-amber-500/30 rounded-lg",children:[e.jsx("p",{className:"text-xs text-amber-400 font-semibold mb-1",children:"Nouvelle version disponible !"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Une mise Ã  jour est disponible. Pour mettre Ã  jour, utilisez :"}),e.jsx("code",{className:"block mt-2 text-xs text-cyan-300 bg-[#0a0a0a] p-2 rounded border border-gray-800",children:"docker-compose pull && docker-compose up -d"})]}),(c==null?void 0:c.error)&&e.jsx("div",{className:"mt-3 p-3 bg-red-500/10 border border-red-500/30 rounded-lg",children:e.jsxs("p",{className:"text-xs text-red-400",children:["Erreur lors de la vÃ©rification : ",c.error]})}),e.jsx("div",{className:"mt-3 p-3 bg-gray-500/10 border border-gray-500/30 rounded-lg",children:e.jsx("p",{className:"text-xs text-gray-400",children:"La vÃ©rification manuelle des mises Ã  jour est temporairement dÃ©sactivÃ©e."})}),e.jsxs("button",{onClick:()=>{},disabled:!0,className:"mt-3 flex items-center gap-2 px-3 py-1.5 bg-gray-600 text-gray-400 text-sm rounded-lg transition-colors opacity-50 cursor-not-allowed",children:[e.jsx(de,{size:14}),"VÃ©rifier maintenant"]})]})})]})},ut=()=>{var T,F;const{freeboxUrl:n,isRegistered:c}=Qe(),{plugins:h}=bs(),E=h.find(b=>b.id==="unifi"),A=(T=E==null?void 0:E.settings)==null?void 0:T.url,L=((F=E==null?void 0:E.settings)==null?void 0:F.site)||"default",S=(E==null?void 0:E.configured)||!1,y=n?Ds(n):null,C=(()=>{if(!A)return null;try{const b=new URL(A),x=L||"default";return`${`${b.protocol}//${b.host}${b.port?`:${b.port}`:""}`}/manage/${x}/settings/system/backups`}catch{return null}})();return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"p-4 bg-amber-500/10 border border-amber-500/30 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ce,{size:20,className:"text-amber-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-amber-400 mb-2",children:"Important : Sauvegardes manuelles recommandÃ©es"}),e.jsx("p",{className:"text-sm text-gray-300 mb-2",children:"Il est difficile de crÃ©er des sauvegardes automatiques via cette application pour les Ã©quipements rÃ©seau (Freebox, UniFi Controller). Les APIs de ces Ã©quipements ne fournissent pas d'endpoints officiels pour dÃ©clencher des exports de configuration de maniÃ¨re automatisÃ©e."}),e.jsxs("p",{className:"text-sm text-gray-300",children:[e.jsx("strong",{className:"text-amber-400",children:"Recommandation :"})," Pensez Ã  effectuer rÃ©guliÃ¨rement des sauvegardes manuelles de vos configurations d'Ã©quipements rÃ©seau via les interfaces web natives. Les liens ci-dessous vous permettent d'accÃ©der directement aux pages de sauvegarde."]})]})]})}),e.jsx(V,{title:"Sauvegarde Freebox",icon:Ve,iconColor:"cyan",children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"p-4 bg-blue-500/10 border border-blue-500/30 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-300 mb-3",children:"La Freebox permet d'exporter et d'importer sa configuration via l'interface web native. Cette fonctionnalitÃ© est disponible depuis la version 4.5.3 du firmware Freebox OS."}),e.jsxs("p",{className:"text-xs text-gray-400 mb-4",children:[e.jsx("strong",{className:"text-gray-300",children:"Note :"})," L'export contient une partie de la configuration de votre Freebox Server. L'import nÃ©cessite un redÃ©marrage de la Freebox Server."]}),y&&c?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs text-gray-500 font-mono break-all",children:y}),e.jsxs("a",{href:y,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors font-medium",children:[e.jsx(Ee,{size:16}),"Ouvrir la page de backup Freebox"]})]}):e.jsx("div",{className:"p-3 bg-amber-500/10 border border-amber-500/30 rounded-lg",children:e.jsx("p",{className:"text-xs text-amber-400",children:c?"URL Freebox non disponible.":"La Freebox n'est pas enregistrÃ©e. Veuillez vous connecter d'abord."})})]})})}),e.jsx(V,{title:"Sauvegarde UniFi Controller",icon:Me,iconColor:"purple",children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"p-4 bg-purple-500/10 border border-purple-500/30 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-300 mb-3",children:"Le contrÃ´leur UniFi permet de crÃ©er des sauvegardes de configuration via l'interface web. Les sauvegardes incluent les paramÃ¨tres du contrÃ´leur, les sites, et les configurations rÃ©seau."}),e.jsxs("p",{className:"text-xs text-gray-400 mb-4",children:[e.jsx("strong",{className:"text-gray-300",children:"Note :"}),' AccÃ©dez Ã  la section "Maintenance" ou "Settings" de votre contrÃ´leur UniFi pour crÃ©er et tÃ©lÃ©charger des sauvegardes de configuration.']}),C&&S?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs text-gray-500 font-mono break-all",children:C}),e.jsxs("a",{href:C,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors font-medium",children:[e.jsx(Ee,{size:16}),"Ouvrir la page de backup UniFi"]})]}):e.jsx("div",{className:"p-3 bg-amber-500/10 border border-amber-500/30 rounded-lg",children:e.jsx("p",{className:"text-xs text-amber-400",children:S?"URL du contrÃ´leur UniFi non disponible.":"Le plugin UniFi n'est pas configurÃ©. Configurez-le dans l'onglet Plugins."})})]})})}),e.jsx(V,{title:"Informations",icon:De,iconColor:"teal",children:e.jsxs("div",{className:"space-y-3 text-sm text-gray-400",children:[e.jsxs("p",{children:[e.jsx("strong",{className:"text-gray-300",children:"Freebox :"})," Les sauvegardes Freebox sont des fichiers ",e.jsx("code",{className:"text-xs bg-gray-800 px-1 py-0.5 rounded",children:".bin"})," qui contiennent une partie de la configuration de votre Freebox Server. Stockez ces fichiers dans un endroit sÃ»r."]}),e.jsxs("p",{children:[e.jsx("strong",{className:"text-gray-300",children:"UniFi :"})," Les sauvegardes UniFi peuvent Ãªtre crÃ©Ã©es depuis l'interface web du contrÃ´leur. Consultez la documentation UniFi pour plus d'informations sur la restauration de sauvegardes."]})]})})]})},mt=()=>{const[n,c]=r.useState(""),[h,E]=r.useState(!0),[A,L]=r.useState(!1),[S,y]=r.useState(null),[u,C]=r.useState("");r.useEffect(()=>{(async()=>{try{const x=await _.get("/api/system/general");if(x.success&&x.result){const j=x.result.publicUrl||"";c(j),C(j)}}catch(x){console.error("Failed to fetch general settings:",x)}finally{E(!1)}})()},[]);const T=n!==u,F=async()=>{var b,x,j,v;L(!0),y(null);try{const i=await _.put("/api/system/general",{publicUrl:n.trim()||""});i.success&&(y({type:"success",text:((b=i.result)==null?void 0:b.message)||"Configuration sauvegardÃ©e avec succÃ¨s"}),setTimeout(()=>y(null),3e3),C(n.trim()||""))}catch(i){y({type:"error",text:((v=(j=(x=i==null?void 0:i.response)==null?void 0:x.data)==null?void 0:j.error)==null?void 0:v.message)||"Erreur lors de la sauvegarde"})}finally{L(!1)}};return h?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx(ie,{className:"animate-spin text-blue-400",size:20})}):e.jsxs("div",{className:"space-y-4",children:[T&&e.jsxs("div",{className:"p-4 bg-amber-900/20 border border-amber-700/50 rounded-lg flex items-start gap-3",children:[e.jsx(ce,{size:20,className:"text-amber-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-amber-400 mb-1",children:"Modifications non sauvegardÃ©es"}),e.jsxs("p",{className:"text-xs text-amber-300",children:["Vous avez modifiÃ© l'URL publique. N'oubliez pas de cliquer sur ",e.jsx("strong",{children:'"Sauvegarder"'})," pour enregistrer vos changements."]})]})]}),S&&e.jsx("div",{className:`p-3 rounded-lg text-sm ${S.type==="success"?"bg-green-900/30 border border-green-700 text-green-400":"bg-red-900/30 border border-red-700 text-red-400"}`,children:S.text}),e.jsxs("div",{className:"py-3 border-b border-gray-800",children:[e.jsx("h4",{className:"text-sm font-medium text-white mb-2",children:"URL publique (Domaine)"}),e.jsxs("div",{className:"flex items-center gap-2 w-full",children:[e.jsx("input",{type:"url",value:n,onChange:b=>c(b.target.value),placeholder:"https://votre-domaine.com",className:"flex-1 w-full px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm placeholder-gray-500 focus:outline-none focus:border-blue-500"}),e.jsx("button",{onClick:F,disabled:A,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:opacity-50 text-white text-sm rounded-lg transition-colors flex items-center gap-2 whitespace-nowrap",children:A?e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"animate-spin",size:16}),e.jsx("span",{children:"Sauvegarde..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{size:16}),e.jsx("span",{children:"Sauvegarder"})]})})]})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2 p-3 bg-[#1a1a1a] rounded-lg border border-gray-800",children:[e.jsx("p",{className:"font-medium text-gray-400 mb-1",children:"ğŸ’¡ Note :"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsxs("li",{children:["Format attendu : ",e.jsx("code",{className:"text-blue-400",children:"https://votre-domaine.com"})," ou ",e.jsx("code",{className:"text-blue-400",children:"http://votre-domaine.com"})]}),e.jsx("li",{children:"Laissez vide pour utiliser l'IP locale ou les valeurs par dÃ©faut"})]})]})]})},pt=()=>{var ee;const{user:n,checkAuth:c}=as(),[h,E]=r.useState(""),[A,L]=r.useState(""),[S,y]=r.useState(""),[u,C]=r.useState(""),[T,F]=r.useState(""),[b,x]=r.useState(!1),[j,v]=r.useState(null),[i,f]=r.useState(null),[o,s]=r.useState(!1),[k,t]=r.useState(!1),[D,H]=r.useState(!1),[Z,se]=r.useState(!1),[$,P]=r.useState(null),[U,d]=r.useState(null),[R,Q]=r.useState(null),[z,X]=r.useState(!1);r.useEffect(()=>{n&&(E(n.username),L(n.email||""),n.avatar?Q(n.avatar):Q(null))},[n]);const N=q=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(q),g=q=>{const l=q.target.value;if(L(l),!l||l.trim().length===0){P(null);return}N(l)?P(null):P("Format d'email invalide")},K=async()=>{var q;x(!0),v(null),f(null),P(null);try{if(!n||!n.id){v("Vous devez Ãªtre connectÃ© pour modifier votre profil"),x(!1);return}if(!h||h.trim().length===0){v("Le nom d'utilisateur ne peut pas Ãªtre vide"),x(!1);return}if(h.length<3){v("Le nom d'utilisateur doit contenir au moins 3 caractÃ¨res"),x(!1);return}if(A!==(n==null?void 0:n.email)){if(!A||A.trim().length===0){P("L'email ne peut pas Ãªtre vide"),v("Veuillez corriger les erreurs avant de sauvegarder"),x(!1);return}if(!N(A)){P("Format d'email invalide"),v("Veuillez corriger les erreurs avant de sauvegarder"),x(!1);return}}if(o&&u){if(u.length<8){v("Le mot de passe doit contenir au moins 8 caractÃ¨res"),x(!1);return}if(u!==T){v("Les mots de passe ne correspondent pas"),x(!1);return}if(!S){v("Veuillez entrer votre mot de passe actuel"),x(!1);return}}const l={};if(h!==(n==null?void 0:n.username)&&(l.username=h),A!==(n==null?void 0:n.email)&&A&&N(A)&&(l.email=A),o&&u&&S&&(l.password=u,l.oldPassword=S),Object.keys(l).length===0){v("Aucune modification Ã  sauvegarder"),x(!1);return}const I=await _.put(`/api/users/${n==null?void 0:n.id}`,l);if(I.success)f("Profil mis Ã  jour avec succÃ¨s"),y(""),C(""),F(""),s(!1),t(!1),H(!1),se(!1),await c();else{const O=((q=I.error)==null?void 0:q.message)||"Ã‰chec de la mise Ã  jour";v(O),console.error("[UserProfile] Update failed:",I.error)}}catch(l){console.error("[UserProfile] Exception during save:",l),l instanceof Error?l.message.includes("fetch")||l.message.includes("network")?v("Impossible de contacter le serveur. VÃ©rifiez que le serveur backend est dÃ©marrÃ©."):v(l.message):v("Erreur lors de la mise Ã  jour du profil")}finally{x(!1)}};return e.jsxs(e.Fragment,{children:[j&&e.jsxs("div",{className:"mb-4 p-3 bg-red-900/30 border border-red-700 rounded-lg text-red-400 text-sm flex items-center gap-2",children:[e.jsx(ce,{size:16,className:"text-red-400"}),j]}),i&&e.jsxs("div",{className:"mb-4 p-3 bg-emerald-900/30 border border-emerald-700 rounded-lg text-emerald-400 text-sm flex items-center gap-2",children:[e.jsx(ne,{size:16,className:"text-emerald-400"}),i]}),e.jsx(M,{label:"Avatar",description:"Changer votre photo de profil",children:e.jsxs("div",{className:"flex items-center gap-4 w-full",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-semibold text-xl overflow-hidden",children:R?e.jsx("img",{src:R,alt:"Avatar",className:"w-full h-full object-cover"}):e.jsx("span",{children:((ee=n==null?void 0:n.username)==null?void 0:ee.split(" ").map(q=>q[0]).join("").toUpperCase().slice(0,2))||"U"})}),U&&e.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 bg-emerald-500 rounded-full flex items-center justify-center border-2 border-[#1a1a1a]",children:e.jsx(ne,{size:12,className:"text-white"})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:"block",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:q=>{var I;const l=(I=q.target.files)==null?void 0:I[0];if(l){d(l);const O=new FileReader;O.onloadend=()=>{Q(O.result)},O.readAsDataURL(l)}},className:"hidden"}),e.jsx("span",{className:"inline-block px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg text-sm cursor-pointer transition-colors",children:"Choisir une image"})]}),U&&e.jsx("button",{onClick:async()=>{var q;if(!(!n||z)){X(!0),v(null),f(null);try{const l=await new Promise((O,ae)=>{const xe=new FileReader;xe.onerror=()=>ae(new Error("Erreur lors de la lecture du fichier")),xe.onloadend=()=>{xe.result&&typeof xe.result=="string"?O(xe.result):ae(new Error("Impossible de convertir le fichier en base64"))},xe.readAsDataURL(U)});if(l.length>10*1024*1024){v("L'image est trop volumineuse aprÃ¨s conversion"),X(!1);return}const I=await _.put(`/api/users/${n.id}`,{avatar:l});if(I.success)f("Avatar mis Ã  jour avec succÃ¨s"),d(null),await c();else{const O=((q=I.error)==null?void 0:q.message)||"Ã‰chec de la mise Ã  jour de l'avatar";v(O)}}catch(l){l instanceof Error?l.message.includes("Network")||l.message.includes("fetch")?v("Impossible de contacter le serveur. VÃ©rifiez votre connexion rÃ©seau."):v(l.message):v("Erreur lors de la mise Ã  jour de l'avatar")}finally{X(!1)}}},disabled:z,className:"mt-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-500 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg text-sm transition-colors flex items-center gap-2",children:z?e.jsxs(e.Fragment,{children:[e.jsx(ie,{size:16,className:"animate-spin"}),e.jsx("span",{children:"Enregistrement..."})]}):e.jsx("span",{children:"Enregistrer l'avatar"})})]})]})}),e.jsx(M,{label:"Nom d'utilisateur",description:"Votre nom d'utilisateur (minimum 3 caractÃ¨res)",children:e.jsxs("div",{className:"flex items-center gap-3 w-full",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg border border-blue-500/20 flex-shrink-0",children:e.jsx(ms,{size:18,className:"text-blue-400"})}),e.jsx("input",{type:"text",value:h,onChange:q=>E(q.target.value),className:"flex-1 px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:outline-none transition-colors",placeholder:"Nom d'utilisateur"})]})}),e.jsx(M,{label:"Email",description:"Votre adresse email",children:e.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[e.jsxs("div",{className:"flex items-center gap-3 w-full",children:[e.jsx("div",{className:"p-2 bg-purple-500/10 rounded-lg border border-purple-500/20 flex-shrink-0",children:e.jsx(Js,{size:18,className:"text-purple-400"})}),e.jsx("input",{type:"email",value:A,onChange:g,className:`flex-1 px-3 py-2 bg-[#1a1a1a] border rounded-lg text-white text-sm focus:outline-none transition-colors ${$?"border-red-500 focus:border-red-500":"border-gray-700 focus:border-purple-500"}`,placeholder:"votre@email.com"})]}),$&&e.jsx("p",{className:"text-xs text-red-400 ml-12",children:$})]})}),e.jsx(M,{label:"Mot de passe",description:o?"Modifier votre mot de passe":"Cliquez pour modifier votre mot de passe",children:e.jsx("div",{className:"flex flex-col gap-3 w-full",children:o?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3 w-full",children:[e.jsx("div",{className:"p-2 bg-amber-500/10 rounded-lg border border-amber-500/20 flex-shrink-0",children:e.jsx(Ye,{size:18,className:"text-amber-400"})}),e.jsx("input",{type:k?"text":"password",placeholder:"Mot de passe actuel",value:S,onChange:q=>y(q.target.value),className:"flex-1 px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:border-amber-500 transition-colors"}),e.jsx("button",{type:"button",onClick:()=>t(!k),className:"p-2 text-gray-400 hover:text-amber-400 transition-colors",title:k?"Masquer le mot de passe":"Afficher le mot de passe",children:k?e.jsx(Ke,{size:18}):e.jsx(Je,{size:18})})]}),e.jsxs("div",{className:"flex items-center gap-3 w-full",children:[e.jsx("div",{className:"p-2 bg-emerald-500/10 rounded-lg border border-emerald-500/20 flex-shrink-0",children:e.jsx(Ye,{size:18,className:"text-emerald-400"})}),e.jsx("input",{type:D?"text":"password",placeholder:"Nouveau mot de passe (min. 8 caractÃ¨res)",value:u,onChange:q=>C(q.target.value),className:"flex-1 px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:border-emerald-500 transition-colors"}),e.jsx("button",{type:"button",onClick:()=>H(!D),className:"p-2 text-gray-400 hover:text-emerald-400 transition-colors",title:D?"Masquer le mot de passe":"Afficher le mot de passe",children:D?e.jsx(Ke,{size:18}):e.jsx(Je,{size:18})})]}),e.jsxs("div",{className:"flex items-center gap-3 w-full",children:[e.jsx("div",{className:"p-2 bg-emerald-500/10 rounded-lg border border-emerald-500/20 flex-shrink-0",children:e.jsx(Ye,{size:18,className:"text-emerald-400"})}),e.jsx("input",{type:Z?"text":"password",placeholder:"Confirmer le nouveau mot de passe",value:T,onChange:q=>F(q.target.value),className:"flex-1 px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:border-emerald-500 transition-colors"}),e.jsx("button",{type:"button",onClick:()=>se(!Z),className:"p-2 text-gray-400 hover:text-emerald-400 transition-colors",title:Z?"Masquer le mot de passe":"Afficher le mot de passe",children:Z?e.jsx(Ke,{size:18}):e.jsx(Je,{size:18})})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs("button",{onClick:K,disabled:b,className:"flex-1 px-4 py-2 bg-emerald-600 hover:bg-emerald-500 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg text-white text-sm transition-colors flex items-center justify-center gap-2",children:[e.jsx(ne,{size:16}),b?"Enregistrement...":"Enregistrer"]}),e.jsx("button",{onClick:()=>{s(!1),y(""),C(""),F(""),v(null)},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-white text-sm transition-colors",children:"Annuler"})]})]}):e.jsxs("button",{onClick:()=>s(!0),className:"flex items-center gap-3 px-4 py-3 bg-[#1a1a1a] hover:bg-[#252525] border border-gray-700 rounded-lg text-white text-sm transition-colors group",children:[e.jsx("div",{className:"p-2 bg-amber-500/10 rounded-lg border border-amber-500/20 group-hover:bg-amber-500/20 transition-colors",children:e.jsx(Ye,{size:18,className:"text-amber-400"})}),e.jsx("span",{className:"flex-1 text-left",children:"Modifier le mot de passe"}),e.jsx(hs,{size:16,className:"text-gray-400 group-hover:text-amber-400 transition-colors"})]})})}),!o&&e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs("button",{onClick:K,disabled:b||A===(n==null?void 0:n.email)&&h===(n==null?void 0:n.username)||!!$,className:"px-6 py-2.5 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg text-white text-sm font-medium transition-all flex items-center gap-2 shadow-lg shadow-blue-500/20",children:[e.jsx(ne,{size:18}),b?"Enregistrement...":"Enregistrer les modifications"]})})]})},gt=()=>e.jsx("div",{className:"space-y-6",children:e.jsx(V,{title:"Informations du projet",icon:De,iconColor:"teal",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-theme-secondary rounded-lg border border-theme",children:[e.jsx("h3",{className:"text-lg font-semibold text-theme-primary mb-3",children:"MynetworK"}),e.jsx("p",{className:"text-sm text-theme-secondary mb-4",children:"Dashboard multi-sources pour la gestion de votre rÃ©seau. IntÃ©gration avec Freebox, UniFi Controller et autres systÃ¨mes rÃ©seau."}),e.jsx("div",{className:"space-y-1",children:e.jsxs("div",{className:"flex items-center justify-start gap-2 py-2 border-b border-gray-700",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Version"}),e.jsx("span",{className:"text-sm font-mono text-theme-primary",children:Es()}),e.jsx("span",{className:"text-sm text-gray-400",children:"Licence"}),e.jsx("span",{className:"text-sm text-theme-primary",children:"PrivÃ©e"})]})}),e.jsx("br",{}),e.jsxs("a",{href:"https://github.com/Erreur32/MynetworK",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg text-sm transition-colors",children:[e.jsx(Xs,{size:16}),e.jsx("span",{children:"Voir sur GitHub"}),e.jsx(Ee,{size:14})]})]}),e.jsxs("div",{className:"p-4 bg-theme-secondary rounded-lg border border-theme",children:[e.jsx("h3",{className:"text-lg font-semibold text-theme-primary mb-3",children:"Auteur"}),e.jsx("div",{className:"space-y-2",children:e.jsxs("p",{className:"text-sm text-theme-secondary",children:["DÃ©veloppÃ© par ",e.jsx("span",{className:"text-theme-primary font-medium",children:"Erreur32"})]})})]}),e.jsxs("div",{className:"p-4 bg-theme-secondary rounded-lg border border-theme",children:[e.jsx("h3",{className:"text-lg font-semibold text-theme-primary mb-3",children:"Technologies"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"px-3 py-1 bg-blue-900/30 border border-blue-700 rounded text-xs text-blue-400",children:"React"}),e.jsx("span",{className:"px-3 py-1 bg-blue-900/30 border border-blue-700 rounded text-xs text-blue-400",children:"TypeScript"}),e.jsx("span",{className:"px-3 py-1 bg-green-900/30 border border-green-700 rounded text-xs text-green-400",children:"Node.js"}),e.jsx("span",{className:"px-3 py-1 bg-cyan-900/30 border border-cyan-700 rounded text-xs text-cyan-400",children:"Express"}),e.jsx("span",{className:"px-3 py-1 bg-purple-900/30 border border-purple-700 rounded text-xs text-purple-400",children:"SQLite"}),e.jsx("span",{className:"px-3 py-1 bg-yellow-900/30 border border-yellow-700 rounded text-xs text-yellow-400",children:"Docker"})]})]})]})})}),bt=()=>{const{user:n}=as(),[c,h]=r.useState([]),[E,A]=r.useState(!0),[L,S]=r.useState(null);r.useEffect(()=>{(n==null?void 0:n.role)==="admin"&&y()},[n]);const y=async()=>{var C,T,F;A(!0),S(null);try{const b=await _.get("/api/users");if(b.success&&b.result)h(b.result);else{const x=((C=b.error)==null?void 0:C.message)||"Ã‰chec du chargement des utilisateurs";S(x)}}catch(b){let x="Ã‰chec du chargement des utilisateurs";b.message?b.message.includes("socket")||b.message.includes("ended")||b.message.includes("ECONNRESET")?x="Connexion interrompue. Veuillez rÃ©essayer.":b.message.includes("timeout")||b.message.includes("TIMEOUT")?x="La requÃªte a expirÃ©. Veuillez rÃ©essayer.":(T=b.error)!=null&&T.message?x=b.error.message:x=b.message:(F=b.error)!=null&&F.message&&(x=b.error.message),S(x)}finally{A(!1)}},u=async C=>{var T,F,b;if(confirm("Voulez-vous vraiment supprimer cet utilisateur ?"))try{const x=await _.delete(`/api/users/${C}`);if(x.success)await y();else{const j=((T=x.error)==null?void 0:T.message)||"Ã‰chec de la suppression";alert(j)}}catch(x){let j="Ã‰chec de la suppression";x.message?x.message.includes("socket")||x.message.includes("ended")||x.message.includes("ECONNRESET")?j="Connexion interrompue. Veuillez rÃ©essayer.":x.message.includes("timeout")||x.message.includes("TIMEOUT")?j="La requÃªte a expirÃ©. Veuillez rÃ©essayer.":(F=x.error)!=null&&F.message?j=x.error.message:j=x.message:(b=x.error)!=null&&b.message&&(j=x.error.message),alert(j)}};return e.jsxs(e.Fragment,{children:[L&&e.jsx("div",{className:"mb-4 p-3 bg-red-900/30 border border-red-700 rounded text-red-400 text-sm",children:L}),E?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(ie,{size:24,className:"mx-auto mb-2 animate-spin"}),e.jsx("p",{children:"Chargement des utilisateurs..."})]}):e.jsx("div",{className:"space-y-3",children:c.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(_e,{size:32,className:"mx-auto mb-2"}),e.jsx("p",{children:"Aucun utilisateur trouvÃ©"})]}):c.map(C=>{const F=(b=>b&&b.split(" ").map(x=>x[0]).join("").toUpperCase().slice(0,2)||"U")(C.username);return e.jsxs("div",{className:"flex items-start gap-3 py-3 px-4 bg-theme-secondary rounded-lg border border-theme",children:[e.jsx("div",{className:"flex-shrink-0",children:C.avatar?e.jsx("img",{src:C.avatar,alt:C.username,className:"w-12 h-12 rounded-full object-cover border-2 border-gray-700"}):e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-semibold text-sm border-2 border-gray-700",children:F})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx("span",{className:"font-medium text-theme-primary",children:C.username}),C.role==="admin"&&e.jsx("span",{className:"px-2 py-0.5 bg-blue-900/30 border border-blue-700 rounded text-xs text-blue-400 whitespace-nowrap",children:"Admin"})]}),e.jsx("p",{className:"text-sm text-theme-secondary truncate",children:C.email}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-1.5 text-xs text-theme-tertiary",children:[e.jsxs("span",{children:["CrÃ©Ã© le ",new Date(C.createdAt).toLocaleDateString("fr-FR")]}),C.lastLogin&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-600",children:"â€¢"}),e.jsxs("span",{children:["DerniÃ¨re connexion: ",new Date(C.lastLogin).toLocaleDateString("fr-FR",{day:"2-digit",month:"short",year:"numeric"})," ",new Date(C.lastLogin).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})]})]}),C.lastLoginIp&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-600",children:"â€¢"}),e.jsxs("span",{className:"font-mono text-gray-400",children:["IP: ",C.lastLoginIp]})]})]})]}),e.jsx("div",{className:"flex items-center gap-2 flex-shrink-0",children:C.id!==(n==null?void 0:n.id)&&e.jsx("button",{onClick:()=>u(C.id),className:"p-2 hover:bg-red-900/20 rounded text-red-400 hover:text-red-300 transition-colors",title:"Supprimer",children:e.jsx(we,{size:16})})})]},C.id)})})]})},wt=({onBack:n,mode:c="freebox",initialAdminTab:h="general",onNavigateToPage:E,onUsersClick:A,onSettingsClick:L,onAdminClick:S,onProfileClick:y,onLogout:u})=>{const{user:C}=as(),[T,F]=r.useState("network"),b=sessionStorage.getItem("adminTab"),[x,j]=r.useState(b||h);r.useEffect(()=>{const a=sessionStorage.getItem("adminTab");a?(j(a),sessionStorage.removeItem("adminTab")):h&&h!=="general"&&j(h),window.location.hash==="#admin"&&window.history.replaceState(null,"",window.location.pathname)},[h]);const[v,i]=r.useState(!1),[f,o]=r.useState(null),[s,k]=r.useState(null),[t,D]=r.useState(new Date),[H,Z]=r.useState(!1),[se,$]=r.useState(!1),[P,U]=r.useState(!1),[d,R]=r.useState(!1),{devices:Q}=Fs(),{reboot:z}=Ps(),{permissions:X,freeboxUrl:N}=Qe(),g=a=>X[a]===!0,[K,ee]=r.useState(null),[q,l]=r.useState(null),[I,O]=r.useState(null),[ae,xe]=r.useState([]),[We,Ce]=r.useState(!1),[te,ue]=r.useState(null),[le,ze]=r.useState(null),[Y,je]=r.useState(null),[ve,Oe]=r.useState(null),[Fe,Ge]=r.useState([]),[p,W]=r.useState([]),[re,Ne]=r.useState(null),[he,Ie]=r.useState([]);r.useEffect(()=>{Te()},[T]);const Te=async()=>{i(!0),o(null);try{switch(T){case"network":{const a=await _.get(J.CONNECTION_CONFIG);a.success&&a.result&&(ee(a.result),l(a.result));break}case"dhcp":{const a=await _.get(J.SETTINGS_DHCP);a.success&&a.result&&O(a.result);const G=await _.get(J.DHCP_STATIC_LEASES);G.success&&G.result&&xe(Array.isArray(G.result)?G.result:[]);break}case"storage":{const a=await _.get(J.SETTINGS_FTP);a.success&&a.result&&ze(a.result);break}case"system":{const a=await _.get(J.SETTINGS_LCD);a.success&&a.result&&je(a.result);break}case"wifi":{const a=await _.get(J.WIFI_PLANNING);a.success&&a.result&&Oe(a.result);break}case"security":{try{const a=await _.get(J.PROFILES);a.success&&a.result&&Ge(a.result)}catch{}try{const a=await _.get(`${J.SETTINGS_NAT}/redirections`);a.success&&a.result&&W(a.result)}catch{}try{const a=await _.get(J.SETTINGS_VPN_SERVER);a.success&&a.result&&Ne(a.result)}catch{}try{const a=await _.get(`${J.SETTINGS_VPN_SERVER.replace("/server","/users")}`);a.success&&a.result&&Ie(a.result)}catch{}break}}}catch{o("Erreur lors du chargement des paramÃ¨tres")}finally{i(!1)}},ge=a=>{k(a),setTimeout(()=>k(null),3e3)},ns=async()=>{var G;if(!K||!q)return;const a={};for(const oe of Object.keys(K))K[oe]!==q[oe]&&(a[oe]=K[oe]);if(Object.keys(a).length===0){ge("Aucune modification Ã  enregistrer");return}i(!0);try{const oe=await _.put(J.CONNECTION_CONFIG,a);oe.success?(ge("ParamÃ¨tres rÃ©seau enregistrÃ©s"),l({...K})):o(((G=oe.error)==null?void 0:G.message)||"Erreur lors de la sauvegarde")}catch{o("Erreur lors de la sauvegarde")}finally{i(!1)}},is=async()=>{var a;if(I){i(!0);try{const G=await _.put(J.SETTINGS_DHCP,I);G.success?ge("ParamÃ¨tres DHCP enregistrÃ©s"):o(((a=G.error)==null?void 0:a.message)||"Erreur lors de la sauvegarde")}catch{o("Erreur lors de la sauvegarde")}finally{i(!1)}}},os=()=>{ue({mac:"",ip:"",comment:""}),Ce(!0)},m=a=>{ue({id:a.id,mac:a.mac,ip:a.ip,comment:a.comment}),Ce(!0)},w=async()=>{var a;if(te){i(!0);try{let G;te.id?G=await _.put(`${J.DHCP_STATIC_LEASES}/${te.id}`,{mac:te.mac,ip:te.ip,comment:te.comment}):G=await _.post(J.DHCP_STATIC_LEASES,{mac:te.mac,ip:te.ip,comment:te.comment}),G.success?(ge(te.id?"Bail statique modifiÃ©":"Bail statique ajoutÃ©"),Ce(!1),ue(null),Te()):o(((a=G.error)==null?void 0:a.message)||"Erreur lors de la sauvegarde")}catch{o("Erreur lors de la sauvegarde")}finally{i(!1)}}},B=async a=>{var G;if(confirm("Voulez-vous vraiment supprimer ce bail statique ?")){i(!0);try{const oe=await _.delete(`${J.DHCP_STATIC_LEASES}/${a}`);oe.success?(ge("Bail statique supprimÃ©"),Te()):o(((G=oe.error)==null?void 0:G.message)||"Erreur lors de la suppression")}catch{o("Erreur lors de la suppression")}finally{i(!1)}}},me=async()=>{var a;if(le){i(!0);try{const G=await _.put(J.SETTINGS_FTP,le);G.success?ge("ParamÃ¨tres FTP enregistrÃ©s"):o(((a=G.error)==null?void 0:a.message)||"Erreur lors de la sauvegarde")}catch{o("Erreur lors de la sauvegarde")}finally{i(!1)}}},fe=async()=>{var a;if(Y){i(!0);try{const G=await _.put(J.SETTINGS_LCD,Y);G.success?ge("ParamÃ¨tres Ã©cran enregistrÃ©s"):o(((a=G.error)==null?void 0:a.message)||"Erreur lors de la sauvegarde")}catch{o("Erreur lors de la sauvegarde")}finally{i(!1)}}},Ue=async()=>{var a;if(ve){i(!0);try{const G=await _.put(J.WIFI_PLANNING,ve);G.success?ge("Planification WiFi enregistrÃ©e"):o(((a=G.error)==null?void 0:a.message)||"Erreur lors de la sauvegarde")}catch{o("Erreur lors de la sauvegarde")}finally{i(!1)}}},xs=async()=>{if(confirm("ÃŠtes-vous sÃ»r de vouloir redÃ©marrer la Freebox ?")){i(!0);const a=await z();i(!1),a?ge("RedÃ©marrage en cours..."):o("Ã‰chec du redÃ©marrage")}},cs=[{id:"network",label:"RÃ©seau",icon:Re,color:"blue"},{id:"wifi",label:"WiFi",icon:ss,color:"cyan"},{id:"dhcp",label:"DHCP",icon:Me,color:"emerald"},{id:"storage",label:"Stockage",icon:Ss,color:"amber"},{id:"security",label:"SÃ©curitÃ©",icon:ke,color:"red"},{id:"system",label:"SystÃ¨me",icon:Ve,color:"purple"}];r.useEffect(()=>{const a=()=>D(new Date);a();const G=setInterval(a,6e4);return()=>clearInterval(G)},[]);const As=[{id:"general",label:"GÃ©nÃ©ral",icon:$e,color:"blue"},{id:"plugins",label:"Plugins",icon:Ks,color:"emerald"},{id:"logs",label:"Logs",icon:rs,color:"cyan"},{id:"security",label:"SÃ©curitÃ©",icon:ke,color:"red"},{id:"exporter",label:"Exporter",icon:Cs,color:"amber"},{id:"theme",label:"ThÃ¨me",icon:gs,color:"yellow"},{id:"backup",label:"Backup",icon:fs,color:"orange"},{id:"debug",label:"Debug",icon:Ze,color:"violet"},{id:"info",label:"Info",icon:De,color:"teal"}];return e.jsxs("div",{className:"min-h-screen bg-theme-primary text-theme-primary",children:[e.jsx("header",{className:"sticky top-0 z-40 bg-theme-header backdrop-blur-sm border-b border-theme",style:{backdropFilter:"var(--backdrop-blur)"},children:e.jsx("div",{className:"max-w-[1920px] mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between relative",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:n,className:"p-2 hover:bg-theme-tertiary rounded-lg transition-colors",children:e.jsx(ws,{size:24})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-theme-secondary/50 rounded-lg",children:e.jsx($e,{size:24,className:"text-theme-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-theme-primary",children:c==="administration"?"Administration":"ParamÃ¨tres"}),e.jsx("p",{className:"text-sm text-theme-secondary",children:c==="administration"?"Gestion de l'application":"Configuration de la Freebox"})]})]})]}),c==="administration"&&e.jsxs("div",{className:"absolute left-1/2 transform -translate-x-1/2 flex items-center gap-3",children:[e.jsx("img",{src:Is,alt:"MynetworK",className:"w-12 h-12 flex-shrink-0"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-theme-primary text-lg",children:"MynetworK"}),e.jsxs("span",{className:"text-sm text-theme-secondary font-mono",children:["v",Ms]})]})]}),c==="administration"?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-theme-secondary px-4 py-2 rounded-lg border border-theme",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-400 shadow-lg shadow-yellow-400/50 animate-pulse"}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("div",{className:"text-sm font-mono text-theme-primary font-semibold",children:t.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})}),e.jsx("div",{className:"text-xs text-theme-secondary",children:t.toLocaleDateString("fr-FR",{weekday:"short",day:"2-digit",month:"short"})})]})]}),C&&e.jsx($s,{user:C,onSettingsClick:L,onAdminClick:S,onProfileClick:y,onUsersClick:A,onLogout:u})]}):e.jsx("button",{onClick:Te,className:"p-2 hover:bg-theme-tertiary rounded-lg transition-colors",title:"Actualiser",children:e.jsx(de,{size:20,className:v?"animate-spin":""})})]})})}),e.jsxs("main",{className:"max-w-[1920px] mx-auto px-4 py-6 pb-24",children:[c==="administration"?e.jsx("div",{className:"flex items-center gap-2 mb-6 overflow-x-auto pb-2",children:As.map(a=>{const G=a.icon,oe=x===a.id,Ae={blue:{active:"bg-blue-500/20 border-blue-500/50 text-blue-400",inactive:"border-gray-700 text-gray-400 hover:border-blue-500/50 hover:text-blue-400",icon:"text-blue-400"},purple:{active:"bg-purple-500/20 border-purple-500/50 text-purple-400",inactive:"border-gray-700 text-gray-400 hover:border-purple-500/50 hover:text-purple-400",icon:"text-purple-400"},emerald:{active:"bg-emerald-500/20 border-emerald-500/50 text-emerald-400",inactive:"border-gray-700 text-gray-400 hover:border-emerald-500/50 hover:text-emerald-400",icon:"text-emerald-400"},cyan:{active:"bg-cyan-500/20 border-cyan-500/50 text-cyan-400",inactive:"border-gray-700 text-gray-400 hover:border-cyan-500/50 hover:text-cyan-400",icon:"text-cyan-400"},red:{active:"bg-red-500/20 border-red-500/50 text-red-400",inactive:"border-gray-700 text-gray-400 hover:border-red-500/50 hover:text-red-400",icon:"text-red-400"},amber:{active:"bg-amber-500/20 border-amber-500/50 text-amber-400",inactive:"border-gray-700 text-gray-400 hover:border-amber-500/50 hover:text-amber-400",icon:"text-amber-400"},yellow:{active:"bg-yellow-500/20 border-yellow-500/50 text-yellow-400",inactive:"border-gray-700 text-gray-400 hover:border-yellow-500/50 hover:text-yellow-400",icon:"text-yellow-400"},violet:{active:"bg-violet-500/20 border-violet-500/50 text-violet-300",inactive:"border-gray-700 text-gray-400 hover:border-violet-500/50 hover:text-violet-300",icon:"text-violet-300"},teal:{active:"bg-teal-500/20 border-teal-500/50 text-teal-300",inactive:"border-gray-700 text-gray-400 hover:border-teal-500/50 hover:text-teal-300",icon:"text-teal-300"}},qe=Ae[a.color]||Ae.blue;return e.jsxs("button",{onClick:()=>j(a.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg border transition-all whitespace-nowrap ${oe?`${qe.active} shadow-lg shadow-${a.color}-500/20`:`bg-theme-secondary ${qe.inactive}`}`,children:[e.jsx(G,{size:16,className:oe?"text-white":"text-gray-400"}),e.jsx("span",{className:"text-sm font-medium",children:a.label})]},a.id)})}):e.jsx("div",{className:"flex items-center gap-2 mb-6 overflow-x-auto pb-2",children:cs.map(a=>{const G=a.icon,oe=T===a.id,Ae={blue:{active:"bg-blue-500/20 border-blue-500/50 text-blue-400",inactive:"border-gray-700 text-gray-400 hover:border-blue-500/50 hover:text-blue-400",icon:"text-blue-400"},cyan:{active:"bg-cyan-500/20 border-cyan-500/50 text-cyan-400",inactive:"border-gray-700 text-gray-400 hover:border-cyan-500/50 hover:text-cyan-400",icon:"text-cyan-400"},emerald:{active:"bg-emerald-500/20 border-emerald-500/50 text-emerald-400",inactive:"border-gray-700 text-gray-400 hover:border-emerald-500/50 hover:text-emerald-400",icon:"text-emerald-400"},amber:{active:"bg-amber-500/20 border-amber-500/50 text-amber-400",inactive:"border-gray-700 text-gray-400 hover:border-amber-500/50 hover:text-amber-400",icon:"text-amber-400"},red:{active:"bg-red-500/20 border-red-500/50 text-red-400",inactive:"border-gray-700 text-gray-400 hover:border-red-500/50 hover:text-red-400",icon:"text-red-400"},purple:{active:"bg-purple-500/20 border-purple-500/50 text-purple-400",inactive:"border-gray-700 text-gray-400 hover:border-purple-500/50 hover:text-purple-400",icon:"text-purple-400"}},qe=Ae[a.color]||Ae.blue;return e.jsxs("button",{onClick:()=>F(a.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg border transition-all whitespace-nowrap ${oe?`${qe.active} shadow-lg shadow-${a.color}-500/20`:`bg-theme-secondary ${qe.inactive}`}`,children:[e.jsx(G,{size:16,className:oe?"text-white":"text-gray-400"}),e.jsx("span",{className:"text-sm font-medium",children:a.label})]},a.id)})}),s&&e.jsxs("div",{className:"mb-6 p-4 bg-emerald-900/20 border border-emerald-700/50 rounded-xl flex items-center gap-3",children:[e.jsx(ne,{className:"text-emerald-400",size:18}),e.jsx("p",{className:"text-emerald-400",children:s})]}),c==="administration"&&e.jsxs(e.Fragment,{children:[x==="general"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(V,{title:"Mon Profil",icon:_e,iconColor:"blue",children:e.jsx(pt,{})}),(C==null?void 0:C.role)==="admin"&&e.jsx(V,{title:"Gestion des utilisateurs",icon:_e,iconColor:"purple",children:e.jsx(bt,{})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(V,{title:"Configuration rÃ©seau",icon:Me,iconColor:"blue",children:e.jsx(mt,{})}),e.jsx(V,{title:"Localisation",icon:Re,iconColor:"cyan",children:e.jsx(M,{label:"Fuseau horaire",description:"DÃ©finit le fuseau horaire de l'application",children:e.jsxs("select",{className:"px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm",children:[e.jsx("option",{value:"Europe/Paris",children:"Europe/Paris (UTC+1)"}),e.jsx("option",{value:"UTC",children:"UTC (UTC+0)"}),e.jsx("option",{value:"America/New_York",children:"America/New_York (UTC-5)"})]})})}),e.jsx(V,{title:"Langue",icon:Re,iconColor:"cyan",children:e.jsx(M,{label:"Langue de l'interface",description:"SÃ©lectionnez la langue d'affichage",children:e.jsxs("select",{className:"px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm",children:[e.jsx("option",{value:"fr",children:"FranÃ§ais"}),e.jsx("option",{value:"en",children:"English"})]})})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(V,{title:"Mises Ã  jour",icon:de,iconColor:"amber",children:e.jsx(xt,{})}),e.jsx(V,{title:"Informations",icon:Ye,iconColor:"purple",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsx("div",{className:"p-3 bg-[#1a1a1a] rounded-lg border border-gray-800",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Version"}),e.jsx("span",{className:"text-sm text-white font-mono",children:Es()})]})}),e.jsx("div",{className:"p-3 bg-[#1a1a1a] rounded-lg border border-gray-800",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Base de donnÃ©es"}),e.jsx("span",{className:"text-sm text-white",children:"SQLite"})]})}),e.jsx("div",{className:"p-3 bg-[#1a1a1a] rounded-lg border border-gray-800",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Authentification"}),e.jsx("span",{className:"text-sm text-white",children:"JWT"})]})})]})})]})]}),x==="theme"&&e.jsx("div",{className:"space-y-6",children:e.jsx(ot,{})}),x==="plugins"&&e.jsx("div",{className:"space-y-6",children:e.jsx(lt,{})}),x==="logs"&&e.jsx("div",{className:"space-y-6",children:e.jsx(nt,{})}),x==="security"&&e.jsx(it,{}),x==="exporter"&&e.jsx(at,{}),x==="backup"&&e.jsx(ut,{}),x==="info"&&e.jsx(gt,{}),x==="debug"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(V,{title:"Logs de l'application",icon:rs,iconColor:"cyan",children:e.jsx(ct,{})}),e.jsx(V,{title:"Niveaux de Log",icon:Ze,iconColor:"violet",children:e.jsx(dt,{})}),e.jsx(V,{title:"Debug & Diagnostics",icon:Ze,iconColor:"violet",children:e.jsxs("div",{className:"py-4 space-y-2 text-xs text-gray-400",children:[e.jsx("p",{children:"Cette section regroupe des informations utiles pour le debug de MynetworKÂ : utilisation des logs, configuration externe et mÃ©triques techniques."}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsxs("li",{children:[e.jsx("span",{className:"text-gray-300 font-semibold",children:"Logs applicatifs"}),"Â : utilisables via l'ongletÂ ",e.jsx("span",{className:"text-gray-100",children:"Logs"})," (recherches, filtres, export)."]}),e.jsxs("li",{children:[e.jsx("span",{className:"text-gray-300 font-semibold",children:"Configuration externe"}),"Â : fichier ",e.jsx("code",{className:"text-[11px] text-emerald-300",children:"config/mynetwork.conf"})," si montÃ©, import/export via la section ",e.jsx("span",{className:"text-gray-100",children:"Exporter"}),"."]}),e.jsxs("li",{children:[e.jsx("span",{className:"text-gray-300 font-semibold",children:"MÃ©triques Prometheus"}),"Â : endpoint ",e.jsx("code",{className:"text-[11px] text-sky-300",children:"/api/metrics/prometheus"})," sur le backend."]}),e.jsxs("li",{children:[e.jsx("span",{className:"text-gray-300 font-semibold",children:"MÃ©triques InfluxDB"}),"Â : endpoint ",e.jsx("code",{className:"text-[11px] text-sky-300",children:"/api/metrics/influxdb"})," si activÃ©."]})]})]})})]})]}),c==="freebox"&&e.jsxs(e.Fragment,{children:[f&&e.jsxs("div",{className:"mb-6 p-4 bg-red-900/20 border border-red-700/50 rounded-xl flex items-center gap-3",children:[e.jsx(ce,{className:"text-red-400"}),e.jsx("p",{className:"text-red-400",children:f})]}),v&&e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(ie,{size:32,className:"text-gray-400 animate-spin"})}),!v&&T==="network"&&K&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(V,{title:"AccÃ¨s distant",icon:Re,permissionError:g("settings")?null:ye("settings"),freeboxSettingsUrl:g("settings")?null:be(N),children:[e.jsx(M,{label:"AccÃ¨s distant",description:"Permet l'accÃ¨s Ã  la Freebox depuis Internet",children:e.jsx(pe,{enabled:K.remote_access,onChange:a=>ee({...K,remote_access:a})})}),e.jsx(M,{label:"Port d'accÃ¨s distant",description:"Port HTTP pour l'accÃ¨s distant Ã  la Freebox",children:e.jsx("input",{type:"number",value:K.remote_access_port,onChange:a=>ee({...K,remote_access_port:parseInt(a.target.value)}),className:"w-24 px-3 py-1.5 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:outline-none"})})]}),e.jsxs(V,{title:"Options rÃ©seau",icon:Me,permissionError:g("settings")?null:ye("settings"),freeboxSettingsUrl:g("settings")?null:be(N),children:[e.jsx(M,{label:"RÃ©ponse au ping",description:"RÃ©pond aux requÃªtes ping depuis Internet",children:e.jsx(pe,{enabled:K.ping,onChange:a=>ee({...K,ping:a})})}),e.jsx(M,{label:"Wake on LAN",description:"Permet de rÃ©veiller les appareils depuis Internet",children:e.jsx(pe,{enabled:K.wol,onChange:a=>ee({...K,wol:a})})}),e.jsx(M,{label:"Blocage de publicitÃ©s",description:"Active le blocage DNS des publicitÃ©s",children:e.jsx(pe,{enabled:K.adblock,onChange:a=>ee({...K,adblock:a})})})]}),e.jsxs("button",{onClick:ns,disabled:!g("settings"),className:`flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors ${g("settings")?"":"opacity-50 cursor-not-allowed"}`,children:[e.jsx(ne,{size:16}),"Enregistrer"]})]}),!v&&T==="wifi"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(V,{title:"Planification WiFi",icon:es,permissionError:g("settings")?null:ye("settings"),freeboxSettingsUrl:g("settings")?null:be(N),children:[e.jsx(M,{label:"Planification active",description:"Active les horaires d'extinction automatique du WiFi",children:e.jsx(pe,{enabled:(ve==null?void 0:ve.enabled)||!1,onChange:a=>Oe({...ve,enabled:a})})}),e.jsxs("div",{className:"py-4 text-sm text-gray-500",children:[e.jsx("p",{children:"Configurez les plages horaires dans l'interface dÃ©taillÃ©e."}),e.jsx("p",{className:"mt-2",children:"Le WiFi peut Ãªtre automatiquement dÃ©sactivÃ© la nuit pour Ã©conomiser l'Ã©nergie."})]})]}),e.jsx(V,{title:"Filtrage MAC",icon:ke,permissionError:g("settings")?null:ye("settings"),freeboxSettingsUrl:g("settings")?null:be(N),children:e.jsxs("div",{className:"py-4 text-sm text-gray-500",children:[e.jsx("p",{children:"Le filtrage MAC permet de restreindre l'accÃ¨s au WiFi Ã  des appareils spÃ©cifiques."}),e.jsx("p",{className:"mt-2",children:"Mode liste blanche : seuls les appareils autorisÃ©s peuvent se connecter."}),e.jsx("p",{children:"Mode liste noire : les appareils listÃ©s sont bloquÃ©s."})]})}),ve&&e.jsxs("button",{onClick:Ue,disabled:!g("settings"),className:`flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors ${g("settings")?"":"opacity-50 cursor-not-allowed"}`,children:[e.jsx(ne,{size:16}),"Enregistrer"]})]}),!v&&T==="dhcp"&&I&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(V,{title:"Serveur DHCP",icon:Me,permissionError:g("settings")?null:ye("settings"),freeboxSettingsUrl:g("settings")?null:be(N),children:[e.jsx(M,{label:"DHCP activÃ©",description:"Attribution automatique des adresses IP",children:e.jsx(pe,{enabled:I.enabled,onChange:a=>O({...I,enabled:a})})}),e.jsx(M,{label:"DÃ©but de plage IP",children:e.jsx("input",{type:"text",value:I.ip_range_start,onChange:a=>O({...I,ip_range_start:a.target.value}),className:"w-40 px-3 py-1.5 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm font-mono focus:outline-none focus:outline-none"})}),e.jsx(M,{label:"Fin de plage IP",children:e.jsx("input",{type:"text",value:I.ip_range_end,onChange:a=>O({...I,ip_range_end:a.target.value}),className:"w-40 px-3 py-1.5 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm font-mono focus:outline-none focus:outline-none"})}),e.jsx(M,{label:"Serveurs DNS",description:"Serveurs DNS distribuÃ©s aux clients DHCP",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[(I.dns||[]).map((a,G)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:a,onChange:oe=>{const Ae=[...I.dns||[]];Ae[G]=oe.target.value,O({...I,dns:Ae})},placeholder:"192.168.1.254",className:"w-40 px-3 py-1.5 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm font-mono focus:outline-none focus:outline-none"}),e.jsx("button",{onClick:()=>{const oe=(I.dns||[]).filter((Ae,qe)=>qe!==G);O({...I,dns:oe})},className:"p-1.5 hover:bg-gray-800 rounded text-red-400 hover:text-red-300 transition-colors",title:"Supprimer",children:e.jsx(we,{size:14})})]},G)),(I.dns||[]).length<3&&e.jsxs("button",{onClick:()=>{const a=[...I.dns||[],""];O({...I,dns:a})},className:"flex items-center gap-2 px-3 py-1.5 bg-[#1a1a1a] hover:bg-[#252525] border border-gray-700 rounded-lg text-gray-400 hover:text-white text-sm transition-colors w-fit",children:[e.jsx(Pe,{size:14}),"Ajouter DNS"]})]})}),e.jsx(M,{label:"Attribution persistante",description:"Conserver l'attribution IP entre les redÃ©marrages",children:e.jsx(pe,{enabled:I.sticky_assign,onChange:a=>O({...I,sticky_assign:a})})})]}),e.jsxs("button",{onClick:is,disabled:!g("settings"),className:`flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors ${g("settings")?"":"opacity-50 cursor-not-allowed"}`,children:[e.jsx(ne,{size:16}),"Enregistrer"]}),e.jsxs(V,{title:"Baux DHCP statiques",icon:Me,permissionError:g("settings")?null:ye("settings"),freeboxSettingsUrl:g("settings")?null:be(N),children:[e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:["(",ae.length," bail",ae.length!==1?"x":"",")"]}),e.jsxs("button",{onClick:os,disabled:!g("settings"),className:`flex items-center gap-2 px-3 py-1.5 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded-lg transition-colors ${g("settings")?"":"opacity-50 cursor-not-allowed"}`,children:[e.jsx(Pe,{size:14}),"Ajouter"]})]}),e.jsx("div",{className:"overflow-x-auto",children:ae.length>0?e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-[#0a0a0a] border-b border-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Adresse MAC"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"IP"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Commentaire"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Hostname"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-400 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-800",children:ae.map(a=>e.jsxs("tr",{className:"hover:bg-[#0a0a0a] transition-colors",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-mono text-white",children:a.mac}),e.jsx("td",{className:"px-4 py-3 text-sm font-mono text-white",children:a.ip}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:a.comment||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-400",children:a.hostname||"-"}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>m(a),className:"p-1.5 hover:bg-gray-800 rounded text-blue-400 hover:text-blue-300 transition-colors",title:"Modifier",children:e.jsx(hs,{size:14})}),e.jsx("button",{onClick:()=>B(a.id),className:"p-1.5 hover:bg-gray-800 rounded text-red-400 hover:text-red-300 transition-colors",title:"Supprimer",children:e.jsx(we,{size:14})})]})})]},a.id))})]}):e.jsxs("div",{className:"py-8 text-center text-gray-500",children:[e.jsx(Me,{size:32,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Aucun bail statique configurÃ©"}),e.jsx("p",{className:"text-xs mt-1",children:'Cliquez sur "Ajouter" pour en crÃ©er un'})]})})]})]}),!v&&T==="storage"&&le&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(V,{title:"Serveur FTP",icon:Cs,permissionError:g("settings")?null:ye("settings"),freeboxSettingsUrl:g("settings")?null:be(N),children:[e.jsx(M,{label:"FTP activÃ©",description:"Permet l'accÃ¨s aux fichiers via FTP",children:e.jsx(pe,{enabled:le.enabled,onChange:a=>ze({...le,enabled:a})})}),e.jsx(M,{label:"AccÃ¨s anonyme",description:"Permet l'accÃ¨s sans authentification",children:e.jsx(pe,{enabled:le.allow_anonymous,onChange:a=>ze({...le,allow_anonymous:a})})}),e.jsx(M,{label:"Ã‰criture anonyme",description:"Permet aux anonymes de crÃ©er/modifier des fichiers",children:e.jsx(pe,{enabled:le.allow_anonymous_write,onChange:a=>ze({...le,allow_anonymous_write:a})})}),e.jsx(M,{label:"Port FTP",children:e.jsx("input",{type:"number",value:le.port_ctrl,onChange:a=>ze({...le,port_ctrl:parseInt(a.target.value)}),className:"w-24 px-3 py-1.5 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:outline-none"})})]}),e.jsxs("button",{onClick:me,disabled:!g("settings"),className:`flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors ${g("settings")?"":"opacity-50 cursor-not-allowed"}`,children:[e.jsx(ne,{size:16}),"Enregistrer"]})]}),!v&&T==="security"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(V,{title:"ContrÃ´le parental",icon:_e,permissionError:g("parental")?null:ye("parental"),freeboxSettingsUrl:g("parental")?null:be(N),children:[e.jsx(M,{label:"RÃ¨gles de filtrage",description:"RÃ¨gles de contrÃ´le parental pour limiter l'accÃ¨s Internet",children:e.jsxs("button",{onClick:()=>Z(!0),disabled:!g("parental"),className:`flex items-center gap-2 px-3 py-1.5 bg-purple-600 hover:bg-purple-500 text-white text-sm rounded-lg transition-colors ${g("parental")?"":"opacity-50 cursor-not-allowed"}`,children:[e.jsx(Ee,{size:14}),"GÃ©rer"]})}),Fe.length>0&&e.jsx("div",{className:"py-2 space-y-2",children:Fe.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#1a1a1a] rounded-lg",children:[e.jsx("span",{className:"text-sm text-white",children:a.name}),e.jsxs("span",{className:"text-xs text-gray-500",children:["ID: ",a.id]})]},a.id))}),Fe.length===0&&e.jsxs("div",{className:"py-4 text-sm text-gray-500",children:[e.jsx("p",{children:'Cliquez sur "GÃ©rer" pour configurer les rÃ¨gles de contrÃ´le parental.'}),e.jsx("p",{className:"mt-2",children:"Limitez l'accÃ¨s Internet pour certains appareils par horaires ou de faÃ§on permanente."})]})]}),e.jsxs(V,{title:"Pare-feu - Redirection de ports",icon:ke,permissionError:g("settings")?null:ye("settings"),freeboxSettingsUrl:g("settings")?null:be(N),children:[e.jsx(M,{label:"RÃ¨gles actives",description:"Redirections de ports configurÃ©es sur la Freebox",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"px-3 py-1 bg-emerald-500/20 text-emerald-400 rounded-full text-sm",children:[p.filter(a=>a.enabled).length," / ",p.length]}),e.jsxs("button",{onClick:()=>$(!0),disabled:!g("settings"),className:`flex items-center gap-2 px-3 py-1.5 bg-orange-600 hover:bg-orange-500 text-white text-sm rounded-lg transition-colors ${g("settings")?"":"opacity-50 cursor-not-allowed"}`,children:[e.jsx(Ee,{size:14}),"GÃ©rer"]})]})}),p.length>0&&e.jsxs("div",{className:"py-2 space-y-2",children:[p.slice(0,5).map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#1a1a1a] rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm text-white",children:a.comment||`Port ${a.wan_port_start}`}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:[a.ip_proto.toUpperCase()," ",a.wan_port_start,a.wan_port_end?`-${a.wan_port_end}`:""," â†’ ",a.lan_ip,":",a.lan_port]})]}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${a.enabled?"bg-emerald-500/20 text-emerald-400":"bg-gray-700 text-gray-400"}`,children:a.enabled?"Actif":"Inactif"})]},a.id)),p.length>5&&e.jsxs("p",{className:"text-xs text-gray-500 text-center py-2",children:["+ ",p.length-5," autres rÃ¨gles"]})]}),p.length===0&&e.jsxs("div",{className:"py-4 text-sm text-gray-500",children:[e.jsx("p",{children:"Aucune redirection de port configurÃ©e."}),e.jsx("p",{className:"mt-2",children:"Les redirections permettent d'exposer des services internes sur Internet."})]})]}),e.jsxs(V,{title:"Serveur VPN",icon:Ts,permissionError:g("settings")?null:ye("settings"),freeboxSettingsUrl:g("settings")?null:be(N),children:[e.jsx(M,{label:"Serveur VPN",description:"Permet de se connecter au rÃ©seau local depuis l'extÃ©rieur",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-sm ${re!=null&&re.enabled?"bg-emerald-500/20 text-emerald-400":"bg-gray-700 text-gray-400"}`,children:re!=null&&re.enabled?"ActivÃ©":"DÃ©sactivÃ©"}),e.jsxs("button",{onClick:()=>U(!0),disabled:!g("settings"),className:`flex items-center gap-2 px-3 py-1.5 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded-lg transition-colors ${g("settings")?"":"opacity-50 cursor-not-allowed"}`,children:[e.jsx(Ee,{size:14}),"GÃ©rer"]})]})}),he.length>0&&e.jsx(M,{label:"Utilisateurs VPN",description:"Comptes configurÃ©s pour l'accÃ¨s VPN",children:e.jsxs("span",{className:"px-3 py-1 bg-blue-500/20 text-blue-400 rounded-full text-sm",children:[he.length," utilisateur",he.length!==1?"s":""]})}),he.length>0&&e.jsx("div",{className:"py-2 space-y-2",children:he.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#1a1a1a] rounded-lg",children:[e.jsx("span",{className:"text-sm text-white",children:a.login}),a.ip_reservation&&e.jsx("span",{className:"text-xs text-gray-500 font-mono",children:a.ip_reservation})]},a.login))}),!re&&he.length===0&&e.jsxs("div",{className:"py-4 text-sm text-gray-500",children:[e.jsx("p",{children:"Le serveur VPN n'est pas configurÃ©."}),e.jsx("p",{className:"mt-2",children:"Protocoles supportÃ©s : OpenVPN, WireGuard, PPTP."})]})]})]}),!v&&T==="system"&&Y&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(V,{title:"Ã‰cran LCD",icon:Ze,permissionError:g("settings")?null:ye("settings"),freeboxSettingsUrl:g("settings")?null:be(N),children:[e.jsx(M,{label:"LuminositÃ©",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"range",min:"0",max:"100",value:Y.brightness,onChange:a=>je({...Y,brightness:parseInt(a.target.value)}),className:"w-32"}),e.jsxs("span",{className:"text-sm text-gray-400 w-12",children:[Y.brightness,"%"]})]})}),e.jsx(M,{label:"Orientation",children:e.jsxs("select",{value:Y.orientation,onChange:a=>je({...Y,orientation:parseInt(a.target.value)}),className:"px-3 py-1.5 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:outline-none",children:[e.jsx("option",{value:0,children:"Normal"}),e.jsx("option",{value:90,children:"90Â°"}),e.jsx("option",{value:180,children:"180Â°"}),e.jsx("option",{value:270,children:"270Â°"})]})}),e.jsx(M,{label:"Forcer l'orientation",description:"EmpÃªche la rotation automatique",children:e.jsx(pe,{enabled:Y.orientation_forced,onChange:a=>je({...Y,orientation_forced:a})})})]}),Y.led_strip_enabled!==void 0&&e.jsxs(V,{title:"Bandeau LED",icon:gs,permissionError:g("settings")?null:ye("settings"),freeboxSettingsUrl:g("settings")?null:be(N),children:[e.jsx(M,{label:"Bandeau LED activÃ©",description:"Active ou dÃ©sactive le bandeau LED",children:e.jsx(pe,{enabled:Y.led_strip_enabled??!1,onChange:a=>je({...Y,led_strip_enabled:a})})}),Y.led_strip_enabled&&e.jsxs(e.Fragment,{children:[e.jsx(M,{label:"LuminositÃ© LED",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"range",min:"0",max:"100",value:Y.led_strip_brightness??50,onChange:a=>je({...Y,led_strip_brightness:parseInt(a.target.value)}),className:"w-32"}),e.jsxs("span",{className:"text-sm text-gray-400 w-12",children:[Y.led_strip_brightness??50,"%"]})]})}),e.jsx(M,{label:"Animation",children:e.jsx("select",{value:Y.led_strip_animation??"breathing",onChange:a=>je({...Y,led_strip_animation:a.target.value}),className:"px-3 py-1.5 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:outline-none",children:(Y.available_led_strip_animations||["organic","static","breathing","rain","trail","wave"]).map(a=>e.jsx("option",{value:a,children:a.charAt(0).toUpperCase()+a.slice(1)},a))})})]})]}),e.jsx(V,{title:"Actions systÃ¨me",icon:He,permissionError:g("settings")?null:ye("settings"),freeboxSettingsUrl:g("settings")?null:be(N),children:e.jsxs("div",{className:"py-4 space-y-3",children:[e.jsxs("button",{onClick:xs,disabled:!g("settings"),className:`w-full flex items-center justify-between px-4 py-3 bg-[#1a1a1a] hover:bg-[#252525] border border-gray-700 rounded-lg transition-colors ${g("settings")?"":"opacity-50 cursor-not-allowed"}`,children:[e.jsx("span",{className:"text-sm text-white",children:"RedÃ©marrer la Freebox"}),e.jsx(He,{size:16,className:"text-orange-400"})]}),e.jsxs("button",{onClick:()=>R(!0),className:"w-full flex items-center justify-between px-4 py-3 bg-[#1a1a1a] hover:bg-[#252525] border border-gray-700 rounded-lg transition-colors",children:[e.jsx("span",{className:"text-sm text-white",children:"Programmer le redÃ©marrage"}),e.jsx(ps,{size:16,className:"text-blue-400"})]}),e.jsx("p",{className:"text-xs text-gray-600 px-1",children:"Le redÃ©marrage prend environ 2-3 minutes. Toutes les connexions seront interrompues."})]})}),e.jsxs("button",{onClick:fe,disabled:!g("settings"),className:`flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors ${g("settings")?"":"opacity-50 cursor-not-allowed"}`,children:[e.jsx(ne,{size:16}),"Enregistrer"]})]}),!v&&T==="network"&&!K&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(ce,{size:48,className:"text-gray-600 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"ParamÃ¨tres non disponibles"}),e.jsx("p",{className:"text-gray-500 text-center max-w-md",children:"Impossible de charger les paramÃ¨tres. VÃ©rifiez que vous Ãªtes connectÃ© Ã  la Freebox."})]}),!v&&T==="dhcp"&&!I&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(Me,{size:48,className:"text-gray-600 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"DHCP non disponible"}),e.jsx("p",{className:"text-gray-500 text-center max-w-md",children:"Impossible de charger la configuration DHCP."})]}),!v&&T==="storage"&&!le&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(Ss,{size:48,className:"text-gray-600 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Stockage non disponible"}),e.jsx("p",{className:"text-gray-500 text-center max-w-md",children:"Aucun disque n'est connectÃ© Ã  la Freebox."})]}),!v&&T==="system"&&!Y&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(Ze,{size:48,className:"text-gray-600 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"ParamÃ¨tres systÃ¨me"}),e.jsx("p",{className:"text-gray-500 text-center max-w-md",children:"Impossible de charger les paramÃ¨tres de l'Ã©cran LCD."})]})]})]}),e.jsx(et,{isOpen:H,onClose:()=>Z(!1),devices:Q}),e.jsx(st,{isOpen:se,onClose:()=>$(!1),devices:Q}),e.jsx(tt,{isOpen:P,onClose:()=>U(!1)}),e.jsx(rt,{isOpen:d,onClose:()=>R(!1)}),We&&te&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-[#151515] w-full max-w-md rounded-xl border border-gray-800 shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-800",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white",children:[te.id?"Modifier":"Ajouter"," un bail statique"]}),e.jsx("button",{onClick:()=>{Ce(!1),ue(null)},className:"p-2 hover:bg-gray-800 rounded-lg text-gray-400 hover:text-white transition-colors",children:e.jsx(ws,{size:20})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Adresse MAC *"}),e.jsx("input",{type:"text",value:te.mac,onChange:a=>ue({...te,mac:a.target.value}),placeholder:"AA:BB:CC:DD:EE:FF",className:"w-full px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white font-mono text-sm focus:outline-none focus:outline-none"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Format: XX:XX:XX:XX:XX:XX"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Adresse IP *"}),e.jsx("input",{type:"text",value:te.ip,onChange:a=>ue({...te,ip:a.target.value}),placeholder:"192.168.1.100",className:"w-full px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white font-mono text-sm focus:outline-none focus:outline-none"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Doit Ãªtre dans la plage DHCP"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Commentaire"}),e.jsx("input",{type:"text",value:te.comment,onChange:a=>ue({...te,comment:a.target.value}),placeholder:"Ex: PC Bureau, NAS, Imprimante...",className:"w-full px-3 py-2 bg-[#1a1a1a] border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:outline-none"})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 p-4 border-t border-gray-800",children:[e.jsx("button",{onClick:()=>{Ce(!1),ue(null)},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Annuler"}),e.jsxs("button",{onClick:w,disabled:!te.mac||!te.ip||v,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[v?e.jsx(ie,{size:16,className:"animate-spin"}):e.jsx(ne,{size:16}),te.id?"Modifier":"Ajouter"]})]})]})})]})};export{V as Section,M as SettingRow,wt as SettingsPage,wt as default};
