import{q as $e,j as e,E as C,o as Ee,F as De,G as Re}from"./index-D769t3SB.js";import{R as te,r as z}from"./vendor-charts-fy94SsLU.js";import{P as We}from"./PluginSummaryCard-BVc5nQnY.js";import{Y as E,f as ae,aS as fe,a0 as ie,_ as ce,b as de,aO as oe,aU as Be,S as xe,W as Le,R as qe}from"./vendor-icons-Wr2_Nvt-.js";import"./vendor-D9iDNHsv.js";import"./vendor-state-CiM9n9np.js";function Oe(A){return typeof A!="number"?"-":A>=-60?"Excellent":A>=-70?"Bon":A>=-80?"Moyen":"Faible"}function Ge(A){return typeof A!="number"?"bg-gray-500":A>=-60?"bg-green-500":A>=-70?"bg-yellow-500":A>=-80?"bg-orange-500":"bg-red-500"}function me(A){if(!A)return"text-gray-500";const q=["text-emerald-300","text-sky-300","text-purple-300","text-amber-300","text-pink-300","text-indigo-300"];let R=0;for(let S=0;S<A.length;S++)R=R*31+A.charCodeAt(S)>>>0;const I=R%q.length;return q[I]}const He=({twoColumns:A=!1,cardClassName:q})=>{const{pluginStats:R}=$e(),I=R.unifi,S=te.useMemo(()=>(Array.isArray(I==null?void 0:I.devices)?I.devices:[]).filter(b=>(b.type||"").toString().toLowerCase()==="client").map(b=>{const M=b.ip||b.ipv4||"",H=b.hostname||b.name||b.friendly_name||"",Z=b.ssid||b.essid||"",pe=b.mac||b._id||"",ee=typeof b.tx_rate=="number"?b.tx_rate:0,he=typeof b.rx_rate=="number"?b.rx_rate:0;let W;typeof b.rssi=="number"&&(W=b.rssi>0?-b.rssi:b.rssi);let V;return typeof b.sess_duration=="number"&&b.sess_duration>0?V=b.sess_duration:typeof b.uptime=="number"&&b.uptime>0?V=b.uptime:typeof b.first_seen=="number"&&b.first_seen>0&&(V=Math.floor(Date.now()/1e3)-b.first_seen),{id:pe||M||`client-${M}`,name:H||M||"Client rÃ©seau",ip:M,ssid:Z,uploadKbps:ee,downloadKbps:he,rssi:W,connectionTime:V}}),[I]),F=te.useMemo(()=>S.filter(d=>d.uploadKbps>0).sort((d,_)=>_.uploadKbps-d.uploadKbps).slice(0,5),[S]),Q=te.useMemo(()=>S.filter(d=>d.downloadKbps>0).sort((d,_)=>_.downloadKbps-d.downloadKbps).slice(0,5),[S]),X=te.useMemo(()=>S.filter(d=>typeof d.rssi=="number").sort((d,_)=>d.rssi-_.rssi).slice(0,3),[S]),O=te.useMemo(()=>S.filter(d=>typeof d.connectionTime=="number"&&d.connectionTime>0).sort((d,_)=>_.connectionTime-d.connectionTime).slice(0,3),[S]),Y=F.length>0||Q.length>0||X.length>0||O.length>0,re=d=>Ee(d*1024),G=d=>{if(d<60)return`${d}s`;if(d<3600)return`${Math.floor(d/60)}min`;if(d<86400){const M=Math.floor(d/3600),H=Math.floor(d%3600/60);return H>0?`${M}h ${H}min`:`${M}h`}const _=Math.floor(d/86400),b=Math.floor(d%86400/3600);return b>0?`${_}j ${b}h`:`${_}j`};return e.jsx(C,{className:q,title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{size:16,className:"text-accent-info"}),e.jsx("span",{children:"Analyse trafic UniFi"})]}),children:Y?e.jsxs("div",{className:"space-y-4 text-xs",children:[e.jsxs("div",{className:A?"grid grid-cols-1 lg:grid-cols-2 gap-4":"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-1",children:e.jsx("span",{className:"text-gray-400",children:"Top 5 upload (clients)"})}),e.jsx("div",{className:"rounded border border-gray-800 overflow-hidden",children:e.jsxs("table",{className:"w-full text-[11px] text-gray-300 table-fixed",children:[e.jsx("thead",{className:"bg-[#181818] text-gray-400",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-1 text-left",style:{width:"25%"},children:"Client"}),e.jsx("th",{className:"px-2 py-1 text-left",style:{width:"28%"},children:"IP"}),e.jsx("th",{className:"px-2 py-1 text-left",style:{width:"22%"},children:"SSID"}),e.jsx("th",{className:"px-2 py-1 text-right",style:{width:"25%"},children:"Up"})]})}),e.jsx("tbody",{children:F.map((d,_)=>e.jsxs("tr",{className:_%2===0?"bg-[#101010]":"bg-[#141414]",children:[e.jsx("td",{className:"px-2 py-1 text-gray-200 truncate",children:d.name}),e.jsx("td",{className:"px-2 py-1 text-gray-400 whitespace-nowrap",children:d.ip||"-"}),e.jsx("td",{className:"px-2 py-1 truncate",children:d.ssid?e.jsx("span",{className:`text-[10px] ${me(d.ssid)}`,children:d.ssid}):e.jsx("span",{className:"text-gray-500",children:"-"})}),e.jsx("td",{className:"px-2 py-1 text-right text-emerald-300 font-semibold",children:re(d.uploadKbps)})]},d.id))})]})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-1",children:e.jsx("span",{className:"text-gray-400",children:"Top 5 download (clients)"})}),e.jsx("div",{className:"rounded border border-gray-800 overflow-hidden",children:e.jsxs("table",{className:"w-full text-[11px] text-gray-300 table-fixed",children:[e.jsx("thead",{className:"bg-[#181818] text-gray-400",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-1 text-left",style:{width:"25%"},children:"Client"}),e.jsx("th",{className:"px-2 py-1 text-left",style:{width:"28%"},children:"IP"}),e.jsx("th",{className:"px-2 py-1 text-left",style:{width:"22%"},children:"SSID"}),e.jsx("th",{className:"px-2 py-1 text-right",style:{width:"25%"},children:"Down"})]})}),e.jsx("tbody",{children:Q.map((d,_)=>e.jsxs("tr",{className:_%2===0?"bg-[#101010]":"bg-[#141414]",children:[e.jsx("td",{className:"px-2 py-1 text-gray-200 truncate",children:d.name}),e.jsx("td",{className:"px-2 py-1 text-gray-400 whitespace-nowrap",children:d.ip||"-"}),e.jsx("td",{className:"px-2 py-1 truncate",children:d.ssid?e.jsx("span",{className:`text-[10px] ${me(d.ssid)}`,children:d.ssid}):e.jsx("span",{className:"text-gray-500",children:"-"})}),e.jsx("td",{className:"px-2 py-1 text-right text-sky-300 font-semibold",children:re(d.downloadKbps)})]},d.id))})]})})]})]}),e.jsxs("div",{className:A?"grid grid-cols-1 lg:grid-cols-2 gap-4":"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-1",children:e.jsx("span",{className:"text-gray-400",children:"3 pires signaux Wiâ€‘Fi (clients)"})}),e.jsx("div",{className:"rounded border border-gray-800 overflow-hidden",children:e.jsxs("table",{className:"w-full text-[11px] text-gray-300 table-fixed",children:[e.jsx("thead",{className:"bg-[#181818] text-gray-400",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-1 text-left",style:{width:"25%"},children:"Client"}),e.jsx("th",{className:"px-2 py-1 text-left",style:{width:"28%"},children:"IP"}),e.jsx("th",{className:"px-2 py-1 text-left",style:{width:"22%"},children:"SSID"}),e.jsx("th",{className:"px-2 py-1 text-right",style:{width:"12.5%"},children:"RSSI"}),e.jsx("th",{className:"px-2 py-1 text-right",style:{width:"12.5%"},children:"QualitÃ©"})]})}),e.jsx("tbody",{children:X.map((d,_)=>e.jsxs("tr",{className:_%2===0?"bg-[#101010]":"bg-[#141414]",children:[e.jsx("td",{className:"px-2 py-1 text-gray-200 truncate",children:d.name}),e.jsx("td",{className:"px-2 py-1 text-gray-400 whitespace-nowrap",children:d.ip||"-"}),e.jsx("td",{className:"px-2 py-1 truncate",children:d.ssid?e.jsx("span",{className:`text-[10px] ${me(d.ssid)}`,children:d.ssid}):e.jsx("span",{className:"text-gray-500",children:"-"})}),e.jsx("td",{className:"px-2 py-1 text-right whitespace-nowrap",children:typeof d.rssi=="number"?e.jsxs("span",{className:"inline-flex items-center justify-end gap-1 text-[10px]",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${Ge(d.rssi)}`}),e.jsxs("span",{className:"text-gray-200 font-medium",children:[d.rssi," dBm"]})]}):e.jsx("span",{className:"text-gray-500",children:"-"})}),e.jsx("td",{className:"px-2 py-1 text-right text-[10px] text-gray-500 whitespace-nowrap",children:typeof d.rssi=="number"?Oe(d.rssi):"-"})]},d.id))})]})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-1",children:e.jsx("span",{className:"text-gray-400",children:"Top 3 des temps de client connectÃ©"})}),e.jsx("div",{className:"rounded border border-gray-800 overflow-hidden",children:e.jsxs("table",{className:"w-full text-[11px] text-gray-300 table-fixed",children:[e.jsx("thead",{className:"bg-[#181818] text-gray-400",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-1 text-left",style:{width:"25%"},children:"Client"}),e.jsx("th",{className:"px-2 py-1 text-left",style:{width:"28%"},children:"IP"}),e.jsx("th",{className:"px-2 py-1 text-left",style:{width:"22%"},children:"SSID"}),e.jsx("th",{className:"px-2 py-1 text-right",style:{width:"25%"},children:"Temps"})]})}),e.jsxs("tbody",{children:[O.map((d,_)=>e.jsxs("tr",{className:_%2===0?"bg-[#101010]":"bg-[#141414]",children:[e.jsx("td",{className:"px-2 py-1 text-gray-200 truncate",children:d.name}),e.jsx("td",{className:"px-2 py-1 text-gray-400 whitespace-nowrap",children:d.ip||"-"}),e.jsx("td",{className:"px-2 py-1 truncate",children:d.ssid?e.jsx("span",{className:`text-[10px] ${me(d.ssid)}`,children:d.ssid}):e.jsx("span",{className:"text-gray-500",children:"-"})}),e.jsx("td",{className:"px-2 py-1 text-right text-emerald-300 font-semibold whitespace-nowrap",children:d.connectionTime?G(d.connectionTime):"-"})]},d.id)),O.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-2 py-3 text-center text-gray-500 text-[10px]",children:"Aucune donnÃ©e de temps de connexion disponible"})})]})]})})]})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-6 text-xs text-gray-500",children:[e.jsx(E,{size:20,className:"mb-2 text-gray-600"}),e.jsx("span",{children:"Aucune donnÃ©e de trafic disponible pour lâ€™instant."}),e.jsx("span",{className:"mt-1 text-[11px] text-gray-600",children:"Les clients UniFi actifs apparaÃ®tront ici avec leur trafic en temps rÃ©el."})]})})},Ze=({onBack:A})=>{var be,ve,we,Ce,_e,ke,Ae,Se;const{plugins:q,pluginStats:R,fetchPlugins:I,fetchPluginStats:S}=$e(),[F,Q]=z.useState("overview"),[X,O]=z.useState(!1),[Y,re]=z.useState("ip"),[G,d]=z.useState("asc"),[_,b]=z.useState(""),[M,H]=z.useState("active"),[Z,pe]=z.useState("wireless"),[ee,he]=z.useState("all"),[W,V]=z.useState("all"),[B,Fe]=z.useState(null),ye=z.useRef(null),[ue,ze]=z.useState(!1),N=q.find(r=>r.id==="unifi"),l=R.unifi,D=(N==null?void 0:N.enabled)&&(N==null?void 0:N.connectionStatus),je=!!(N&&((be=N.settings)!=null&&be.url)&&((ve=N.settings)!=null&&ve.username)&&((we=N.settings)!=null&&we.password)),K=l==null?void 0:l.system,J=(l==null?void 0:l.devices)||[],Te=J.filter(r=>(r.type||"").toString().toLowerCase()==="client"),Ue=(K==null?void 0:K.name)||(K==null?void 0:K.siteName),ne=!!D,le=!!(Ue||(Ce=N==null?void 0:N.settings)!=null&&Ce.site),Ne=J.length>0||Te.length>0,T={};z.useEffect(()=>{I()},[I]),z.useEffect(()=>{(F==="sites"||F==="accesspoints"||F==="sites-aps"||F==="sites-aps-switches")&&Q("overview")},[F]),z.useEffect(()=>{D&&S("unifi")},[D,S]),De(()=>{D&&S("unifi")},{enabled:D,interval:Re.system}),z.useEffect(()=>{const r=l==null?void 0:l.network;if(!r)return;const o=Date.now(),t=typeof r.totalDownload=="number"?r.totalDownload:r.download||0,m=typeof r.totalUpload=="number"?r.totalUpload:r.upload||0,f=ye.current;if(f){const n=(o-f.timestamp)/1e3;if(n>.5&&t>=f.downBytes&&m>=f.upBytes){const i=(t-f.downBytes)*8/n,a=(m-f.upBytes)*8/n;Fe({downBps:i,upBps:a})}}ye.current={timestamp:o,downBytes:t,upBytes:m}},[l]);const Me=async()=>{O(!0),await I(),D&&await S("unifi"),setTimeout(()=>O(!1),1e3)},Ie=[{id:"overview",label:"Vue d'ensemble",icon:ae},{id:"clients",label:"Clients",icon:de},{id:"switches",label:"Switch",icon:oe},{id:"analyse",label:"Analyse",icon:ae},{id:"traffic",label:"Trafic",icon:Be},{id:"events",label:"Ã‰vÃ©nements",icon:E},{id:"debug",label:"Debug",icon:E}];return N?D?e.jsx("div",{className:"text-gray-300",children:e.jsxs("div",{className:"max-w-[96rem] mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:A,className:"p-2 hover:bg-[#1a1a1a] rounded transition-colors",children:e.jsx(fe,{size:20})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-semibold flex items-center gap-3",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"w-6 h-6",children:e.jsx("path",{fill:"#1fb0ec",d:"M5.343 4.222h1.099v1.1H5.343zm7.438 14.435a7.2 7.2 0 0 1-3.51-.988a6.5 6.5 0 0 0 2.947 3.936l.66.364c5.052-.337 8.009-3.6 8.009-7.863v-.924c-1.201 3.918-3.995 5.66-8.106 5.475m-4.107-2.291V8.355H7.562v4.1H6.448V10h-1.11v1.1H4.225V5.042H3.113v9.063c0 4.508 3.3 7.9 8.888 7.9a6.82 6.82 0 0 1-3.327-5.639M7.562 4.772h1.112v1.1H7.562zM3.113 2h1.112v1.111H3.113zm2.231 5.805h1.1v1.1h-1.1zm1.111-1.649h1.1v1.1h-1.1zm-.006-3.045h1.113V4.21H6.449zm8.876 2.677v10.577a9 9 0 0 1-.164 1.7c2.671-.486 4.414-2.137 5.3-5.014l.431-1.407V2.012c-5.042 0-5.567 1.931-5.567 3.776"})}),"UniFi"]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:((_e=N.settings)==null?void 0:_e.url)||"Non configurÃ©"})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-[#050b14] border border-gray-800 rounded-lg text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[ne?e.jsx(ce,{size:12,className:"text-green-400"}):je?e.jsx(E,{size:12,className:"text-yellow-400"}):e.jsx(ie,{size:12,className:"text-red-400"}),e.jsx("span",{className:ne?"text-green-400":je?"text-yellow-400":"text-red-400",children:"Connexion"})]}),e.jsx("span",{className:"text-gray-500",children:"â€¢"}),e.jsxs("div",{className:"flex items-center gap-1",children:[le?e.jsx(ce,{size:12,className:"text-green-400"}):ne?e.jsx(E,{size:12,className:"text-yellow-400"}):e.jsx(ie,{size:12,className:"text-red-400"}),e.jsx("span",{className:le?"text-green-400":ne?"text-yellow-400":"text-red-400",children:"Site"})]}),e.jsx("span",{className:"text-gray-500",children:"â€¢"}),e.jsxs("div",{className:"flex items-center gap-1",children:[Ne?e.jsx(ce,{size:12,className:"text-green-400"}):le?e.jsx(E,{size:12,className:"text-yellow-400"}):e.jsx(ie,{size:12,className:"text-red-400"}),e.jsx("span",{className:Ne?"text-green-400":le?"text-yellow-400":"text-red-400",children:"DonnÃ©es"})]})]})})]}),e.jsx("div",{className:"flex border-b border-gray-800 mb-6 overflow-x-auto",children:Ie.map(r=>{const o=r.icon,t=F===r.id;return e.jsxs("button",{onClick:()=>Q(r.id),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap border-b-2 ${t?"text-unifi-accent border-unifi-accent":"border-transparent text-gray-400 hover:text-white hover:border-unifi-accent"}`,children:[e.jsx(o,{size:16}),r.label]},r.id)})}),e.jsxs("div",{className:"space-y-6",children:[F==="overview"&&e.jsxs(e.Fragment,{children:[(()=>{const o=((l==null?void 0:l.devices)||[]).filter(g=>(g.type||"").toString().toLowerCase()!=="client"),t=(l==null?void 0:l.system)||{},m=g=>{if(g.unsupported===!0||g.unsupported_reason)return"critical";const u=!!g.upgrade_to_firmware&&g.upgrade_to_firmware!==g.version&&g.upgrade_to_firmware!==g.firmware_version;return g.upgradable===!0||u?"update":"ok"};let f=0,n=0,i=0;for(const g of o){const u=m(g);u==="ok"?f+=1:u==="update"?n+=1:u==="critical"&&(i+=1)}t.updateAvailable===!0&&n===0&&t.updateDownloaded!==!0&&(n=1);const a=o.length,y=o.filter(g=>g.active===!1);return T.upToDateCount=f,T.updateAvailableCount=n,T.criticalCount=i+(t.unsupportedDeviceCount||0),T.totalEquipments=a,T.offlineDevices=y,T.controller=t,null})(),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx(C,{title:"InfoSystÃ¨me",className:"bg-unifi-card border border-gray-800 rounded-xl",children:e.jsxs("div",{className:"flex flex-col justify-center text-sm text-gray-300 space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Uptime contrÃ´leur:"}),e.jsx("span",{children:(()=>{var m;const r=(m=T.controller)==null?void 0:m.uptime;if(!r||r<=0)return"N/A";const o=Math.floor(r/3600),t=Math.floor(o/24);return t>0?`${t} j ${o%24} h`:`${o} h`})()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Ã‰quipements gÃ©rÃ©s:"}),e.jsx("span",{children:T.totalEquipments??0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Clients connectÃ©s:"}),e.jsx("span",{children:((l==null?void 0:l.devices)||[]).filter(r=>(r.type||"").toLowerCase()==="client").length})]}),e.jsxs("div",{className:"mt-3 border-t border-gray-800 pt-2 space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"URL:"}),e.jsx("span",{className:"text-white font-mono",children:((ke=N.settings)==null?void 0:ke.url)||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"IP:"}),e.jsx("span",{className:"text-white font-mono",children:(()=>{var o,t;const r=(o=N.settings)==null?void 0:o.url;if(r)try{return new URL(r).hostname}catch{return((t=r.split("://")[1])==null?void 0:t.split(":")[0])||"N/A"}return"N/A"})()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Port:"}),e.jsx("span",{className:"text-white font-mono",children:(()=>{var o,t;const r=(o=N.settings)==null?void 0:o.url;if(r)try{const m=new URL(r);return m.port||(m.protocol==="https:"?"8443":"8080")}catch{return((t=r.split(":").pop())==null?void 0:t.split("/")[0])||"N/A"}return"N/A"})()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Utilisateur:"}),e.jsx("span",{className:"text-white",children:((Ae=N.settings)==null?void 0:Ae.username)||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Site:"}),e.jsx("span",{className:"text-white",children:(()=>{var o,t,m;const r=((o=l==null?void 0:l.system)==null?void 0:o.name)||((t=l==null?void 0:l.system)==null?void 0:t.siteName);return r&&typeof r=="string"?r:((m=N.settings)==null?void 0:m.site)||"default"})()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Mode:"}),e.jsx("span",{className:"text-white",children:((Se=N.settings)==null?void 0:Se.apiMode)==="site-manager"?"Site Manager API":"Controller Local"})]})]})]})}),e.jsx(C,{title:"Alertes RÃ©seau",className:"bg-unifi-card border border-gray-800 rounded-xl",children:e.jsxs("div",{className:"flex flex-col justify-center text-sm text-gray-300 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"Niveau:"}),e.jsx("div",{className:"flex gap-1",children:[{id:"all",label:"Tous"},{id:"info",label:"Infos"},{id:"warning",label:"Avertissements"},{id:"critical",label:"Critiques"}].map(r=>{const o=ee===r.id;let t="bg-sky-500/20 border-sky-400 text-sky-200";return r.id==="warning"?t="bg-amber-500/20 border-amber-400 text-amber-100":r.id==="critical"?t="bg-red-600/20 border-red-500 text-red-200":r.id==="all"&&(t="bg-purple-500/20 border-purple-400 text-purple-100"),e.jsx("button",{type:"button",onClick:()=>he(r.id),className:`px-2 py-0.5 rounded-full text-[10px] border ${o?t:"bg-transparent border-gray-700 text-gray-400 hover:bg-gray-800"}`,children:r.label},r.id)})})]}),(()=>{const r=T.offlineDevices,o=T.updateAvailableCount,t=T.criticalCount,m=[];r&&r.length>0&&m.push({label:"Ã‰quipements hors ligne",value:r.length,level:"warning"}),o>0&&m.push({label:"Mises Ã  jour disponibles",value:o,level:"warning"}),t>0&&m.push({label:"Mises Ã  jour critiques / appareils non supportÃ©s",value:t,level:"critical"});const f=m.filter(n=>ee==="all"?!0:n.level===ee);return m.length===0?e.jsx("span",{className:"text-xs text-gray-500",children:"Aucune alerte active dÃ©tectÃ©e."}):f.length===0?e.jsx("span",{className:"text-xs text-gray-500",children:"Aucune alerte pour ce niveau de filtrage."}):e.jsx("div",{className:"space-y-2",children:f.map(n=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${n.level==="critical"?"bg-red-500":n.level==="warning"?"bg-amber-400":"bg-sky-400"}`}),e.jsx("span",{className:"text-gray-400",children:n.label})]}),e.jsx("span",{className:n.level==="critical"?"text-red-400":n.level==="warning"?"text-amber-400":"text-sky-300",children:n.value})]},n.label))})})()]})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-4",children:[e.jsx(C,{className:"bg-unifi-card border border-gray-800 rounded-xl",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-4 gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-emerald-900/40 border border-emerald-500 flex items-center justify-center text-emerald-400",children:e.jsx(ce,{size:18})}),e.jsx("div",{className:"text-2xl font-semibold text-white",children:T.upToDateCount??0}),e.jsx("div",{className:"text-xs text-gray-400",children:"Ã€ jour"})]})}),e.jsx(C,{className:"bg-unifi-card border border-gray-800 rounded-xl",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-4 gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-amber-900/40 border border-amber-500 flex items-center justify-center text-amber-400",children:e.jsx("span",{className:"text-lg leading-none",children:"ðŸ•’"})}),e.jsx("div",{className:"text-2xl font-semibold text-white",children:T.updateAvailableCount??0}),e.jsx("div",{className:"text-xs text-gray-400",children:"Mise Ã  jour disponible"})]})}),e.jsx(C,{className:"bg-unifi-card border border-gray-800 rounded-xl",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-4 gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-red-900/40 border border-red-500 flex items-center justify-center text-red-400",children:e.jsx(E,{size:18})}),e.jsx("div",{className:"text-2xl font-semibold text-white",children:T.criticalCount??0}),e.jsx("div",{className:"text-xs text-gray-400",children:"Mise Ã  jour critique"})]})}),e.jsx(C,{className:"bg-unifi-card border border-gray-800 rounded-xl",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-4 gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-sky-900/40 border border-sky-500 flex items-center justify-center text-sky-400",children:e.jsx("span",{className:"text-lg leading-none",children:"i"})}),e.jsx("div",{className:"text-2xl font-semibold text-white",children:T.totalEquipments??(l!=null&&l.devices?l.devices.length:0)}),e.jsx("div",{className:"text-xs text-gray-400",children:"Total Ã©quipements"})]})})]}),e.jsxs("div",{className:"col-span-full space-y-6",children:[e.jsx(C,{title:"Sites UniFi",children:(()=>{const r=l==null?void 0:l.sites;return!r||r.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(xe,{size:32,className:"mx-auto mb-2"}),e.jsx("p",{children:"Aucun site dÃ©tectÃ© pour l'instant"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:r.map((o,t)=>e.jsxs("div",{className:"bg-unifi-card rounded-xl px-4 py-3 border border-gray-800 flex flex-col gap-2 relative",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-gray-300"}),e.jsx("span",{className:"text-sm font-semibold text-white truncate",children:o.name||o.id||"Site UniFi"})]}),e.jsx("span",{className:`w-2 h-2 rounded-full ${o.status==="online"?"bg-emerald-400":"bg-gray-500"}`})]}),e.jsxs("div",{className:"text-xs space-y-0.5 mt-1 flex-1",children:[o.hostname&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Hostname:Â "}),e.jsx("span",{className:"text-gray-300",children:o.hostname})]}),o.devices&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Ã‰quipements:Â "}),e.jsx("span",{className:"text-gray-300",children:o.devices.total??0})]})]}),o.devices&&e.jsxs("div",{className:"flex items-center justify-end gap-2 mt-auto pt-2",children:[o.devices.clients!==void 0&&e.jsxs("span",{className:"px-2.5 py-1 rounded-lg bg-purple-500/20 border border-purple-500/50 text-purple-300 font-semibold text-sm",children:[o.devices.clients??0," Clients"]}),o.devices.aps!==void 0&&e.jsxs("span",{className:"px-2.5 py-1 rounded-lg bg-cyan-500/20 border border-cyan-500/50 text-cyan-300 font-semibold text-sm",children:[o.devices.aps??0," APs"]}),o.devices.switches!==void 0&&e.jsxs("span",{className:"px-2.5 py-1 rounded-lg bg-blue-500/20 border border-blue-500/50 text-blue-300 font-semibold text-sm",children:[o.devices.switches??0," Switches"]})]})]},o.id||t))})})()}),e.jsx(C,{title:"Points d'AccÃ¨s",className:"bg-unifi-card border border-gray-800 rounded-xl",children:l!=null&&l.devices?(()=>{const r=l.devices.filter(i=>{const a=(i.type||"").toLowerCase(),y=(i.model||"").toLowerCase();return(a==="uap"||a.includes("uap")||a==="accesspoint"||a==="ap"||y.includes("uap")||y.includes("ap"))&&a!=="client"});if(r.length===0)return e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Le,{size:32,className:"mx-auto mb-2"}),e.jsx("p",{children:"Aucun point d'accÃ¨s dÃ©tectÃ©"}),e.jsxs("p",{className:"text-xs mt-2 text-gray-600",children:["Total devices: ",l.devices.length,l.devices.length>0&&e.jsxs("span",{className:"block mt-1",children:["Types: ",Array.from(new Set(l.devices.map(i=>i.type||"unknown"))).join(", ")]})]})]});const o=l.devices.filter(i=>(i.type||"").toLowerCase()==="client"),t=i=>{const a=(i.model||"").toString().toLowerCase();return a.includes("be")||a.includes("wifi 7")||a.includes("wi-fi 7")?"Wiâ€‘Fi 7":a.includes("6e")?"Wiâ€‘Fi 6E":a.includes("6")||a.includes("ax")?"Wiâ€‘Fi 6":a.includes("ac")?"Wiâ€‘Fi 5":a.includes("n")?"Wiâ€‘Fi 4":"Wiâ€‘Fi"},m=i=>{const a=[];return i.radio_table&&Array.isArray(i.radio_table)&&i.radio_table.forEach(y=>{const g=y.radio||y.name||"";if(g){const u=g.toLowerCase();u.includes("ng")||u.includes("2.4")||u==="2g"?a.includes("2.4GHz")||a.push("2.4GHz"):u.includes("na")||u.includes("5")||u==="5g"?a.includes("5GHz")||a.push("5GHz"):(u.includes("6")||u==="6g")&&(a.includes("6GHz")||a.push("6GHz"))}}),a.length===0&&((i.radio_ng||i.radio_2g)&&a.push("2.4GHz"),(i.radio_na||i.radio_5g)&&a.push("5GHz"),i.radio_6g&&a.push("6GHz")),a.length>0?a:["N/A"]},f=i=>{const a=(i.name||i.model||"").toString(),y=(i.mac||"").toString().toLowerCase();return o.filter(g=>{const u=g.last_uplink_name||g.uplink_name||"",x=g.last_uplink_mac||g.sw_mac||"";return u===a||x.toLowerCase()===y}).length},n=i=>{if(!i||i<=0)return"N/A";const a=Math.floor(i/86400),y=Math.floor(i%86400/3600),g=Math.floor(i%3600/60);return a>0?`${a}j ${y}h`:y>0?`${y}h ${g}min`:`${g}min`};return e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-4",children:r.map(i=>{var v;const a=f(i),y=t(i),g=i.firmware_version||i.version||i.firmware,u=m(i),x=i.uptime,c=i.cpu_usage||((v=i.cpu)==null?void 0:v.usage)||i.proc_usage,h=i.power||i.watt||i.poe_power;return e.jsxs("div",{className:`bg-unifi-card rounded-xl px-4 py-3 border border-gray-800 flex flex-col gap-2 ${i.active===!1?"opacity-60":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-gray-300"}),e.jsx("span",{className:"text-sm font-semibold text-white truncate",children:i.name||i.model||i.id})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-0.5 rounded-full text-[10px] font-semibold border ${i.active===!1?"bg-gray-900 text-gray-400 border-gray-700":"bg-emerald-900/60 text-emerald-300 border-emerald-600/70"}`,children:i.active===!1?"OFFLINE":"ONLINE"}),e.jsx("span",{className:`w-2 h-2 rounded-full ${i.active!==!1?"bg-emerald-400":"bg-gray-500"}`,title:i.active!==!1?"Point d'accÃ¨s en ligne (Ã©tat de mise Ã  jour dÃ©taillÃ© visible dans Vue d'ensemble)":"Point d'accÃ¨s hors ligne"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-3 gap-y-1.5 mt-2 text-xs",children:[e.jsxs("div",{className:"space-y-1",children:[i.ip&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"IP"}),e.jsx("span",{className:"text-gray-300 font-mono text-[10px]",children:i.ip})]}),x!==void 0&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Uptime"}),e.jsx("span",{className:"text-gray-300",children:n(x)})]}),g&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Firmware"}),e.jsxs("span",{className:"text-gray-300",children:["v",g]})]}),c!==void 0&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"CPU"}),e.jsxs("span",{className:"text-gray-300",children:[c,"%"]})]}),h!==void 0&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Puissance"}),e.jsxs("span",{className:"text-gray-300",children:[h,"W"]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Type Wiâ€‘Fi"}),e.jsx("span",{className:"text-gray-300",children:y})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-gray-500",children:"Bandes"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:u.map((L,$)=>e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] bg-cyan-900/40 border border-cyan-700/50 text-cyan-300",children:L},`band-${$}`))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Clients"}),e.jsx("span",{className:"text-gray-300 font-semibold",children:a})]})]})]})]},i.id)})})})():e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Le,{size:32,className:"mx-auto mb-2"}),e.jsx("p",{children:"Aucune donnÃ©e disponible"})]})}),e.jsx(C,{title:"Switches",className:"bg-unifi-card border border-gray-800 rounded-xl",children:l!=null&&l.devices?(()=>{const r=l.devices.filter(n=>(n.type||"").toLowerCase().startsWith("usw"));if(r.length===0)return e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(xe,{size:32,className:"mx-auto mb-2"}),e.jsx("p",{children:"Aucun switch dÃ©tectÃ©"}),e.jsxs("p",{className:"text-xs mt-2 text-gray-600",children:["Total devices: ",l.devices.length]})]});const o=l.devices.filter(n=>(n.type||"").toLowerCase()==="client"),t=n=>{const i=n.port_table||n.eth_port_table||n.ports||n.port_overrides||[],a=Array.isArray(i)?i:[];let y=a.length;return y===0&&typeof n.num_port=="number"&&(y=n.num_port),{active:a.filter(u=>{const x=u.up===!0||u.enable===!0,c=u.link_state==="up"||u.media==="GE"||u.media==="10GE",h=typeof u.speed=="number"&&u.speed>0;return x||c||h}).length,total:y}},m=n=>{const i=(n.name||n.model||"").toString(),a=(n.mac||"").toString().toLowerCase();return o.filter(y=>{const g=y.last_uplink_name||y.uplink_name||"",u=y.last_uplink_mac||y.sw_mac||"";return g===i||u.toLowerCase()===a}).length},f=n=>{if(!n||n<=0)return"N/A";const i=Math.floor(n/86400),a=Math.floor(n%86400/3600),y=Math.floor(n%3600/60);return i>0?`${i}j ${a}h`:a>0?`${a}h ${y}min`:`${y}min`};return e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-4",children:r.map(n=>{var h;const{active:i,total:a}=t(n),y=m(n),g=n.firmware_version||n.version||n.firmware,u=n.uptime,x=n.cpu_usage||((h=n.cpu)==null?void 0:h.usage)||n.proc_usage,c=n.power||n.watt||n.poe_power;return e.jsxs("div",{className:`bg-unifi-card rounded-xl px-3 py-2.5 border border-gray-800 flex flex-col ${n.active===!1?"opacity-60":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-gray-300"}),e.jsx("span",{className:"text-sm font-semibold text-white truncate",children:n.name||n.model||n.id})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-0.5 rounded-full text-[10px] font-semibold border ${n.active===!1?"bg-gray-900 text-gray-400 border-gray-700":"bg-emerald-900/60 text-emerald-300 border-emerald-600/70"}`,children:n.active===!1?"OFFLINE":"ONLINE"}),e.jsx("span",{className:`w-2 h-2 rounded-full ${n.active!==!1?"bg-emerald-400":"bg-gray-500"}`,title:n.active!==!1?"Switch en ligne (Ã©tat de mise Ã  jour dÃ©taillÃ© visible dans Vue d'ensemble)":"Switch hors ligne"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-3 gap-y-1.5 mt-2 text-xs",children:[e.jsxs("div",{className:"space-y-1",children:[n.ip&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"IP"}),e.jsx("span",{className:"text-gray-300 font-mono text-[10px]",children:n.ip})]}),u!==void 0&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Uptime"}),e.jsx("span",{className:"text-gray-300",children:f(u)})]}),g&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Firmware"}),e.jsxs("span",{className:"text-gray-300",children:["v",g]})]}),x!==void 0&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"CPU"}),e.jsxs("span",{className:"text-gray-300",children:[x,"%"]})]}),c!==void 0&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Puissance"}),e.jsxs("span",{className:"text-gray-300",children:[c,"W"]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Ports actifs"}),e.jsx("span",{className:"text-gray-300 font-semibold",children:a>0?`${i} / ${a}`:"-"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Clients"}),e.jsx("span",{className:"text-gray-300 font-semibold",children:y})]})]})]})]},n.id)})})})():e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(xe,{size:32,className:"mx-auto mb-2"}),e.jsx("p",{children:"Aucune donnÃ©e disponible"})]})})]})]})]}),!1,F==="switches"&&e.jsx("div",{className:"col-span-full space-y-6",children:e.jsx(C,{title:"Ports des Switches UniFi",className:"bg-unifi-card border border-gray-800 rounded-xl",children:l!=null&&l.devices?(()=>{const r=J.filter(t=>{const m=(t.type||"").toString().toLowerCase(),f=(t.model||"").toString().toLowerCase();return m.startsWith("usw")||m.includes("switch")||f.includes("usw")||f.includes("switch")});if(r.length===0)return e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(oe,{size:32,className:"mx-auto mb-2"}),e.jsx("p",{children:"Aucun switch dÃ©tectÃ©"}),e.jsxs("p",{className:"text-xs mt-2 text-gray-600",children:["Total devices: ",J.length,J.length>0&&e.jsxs("span",{className:"block mt-1",children:["Types: ",Array.from(new Set(J.map(t=>t.type||"unknown"))).join(", ")]})]})]});const o=[];return r.forEach(t=>{const m=t.name||t.model||"Switch",f=t.ip||"N/A",n=t.eth_port_table||t.port_table||t.ports||t.port_overrides||[],i=Array.isArray(n)?n:[];if(i.length===0&&typeof t.num_port=="number"&&t.num_port>0)for(let a=1;a<=t.num_port;a++)o.push({switchName:m,switchIp:f,port:a,speed:null,poe:"N/A",errors:"N/A",portName:"n/a"});else i.length>0?i.forEach((a,y)=>{const g=a.port_idx!==void 0?a.port_idx:a.portnum!==void 0?a.portnum:y+1;let u=null;if(typeof a.speed=="number"&&a.speed>0)u=a.speed;else if(typeof a.current_speed=="number"&&a.current_speed>0)u=a.current_speed;else if(typeof a.link_speed=="number"&&a.link_speed>0)u=a.link_speed;else if(a.media){const U=a.media.toString().toUpperCase();U.includes("10GE")||U.includes("10G")?u=1e4:U.includes("2.5GE")||U.includes("2.5G")?u=2500:U.includes("GE")||U.includes("1G")?u=1e3:U.includes("100M")||U.includes("100")?u=100:(U.includes("10M")||U.includes("10"))&&(u=10)}let x="off";a.poe_enable===!0||a.poe_enable==="auto"?x="auto":a.poe_mode&&a.poe_mode!=="off"?x=a.poe_mode.toString().toLowerCase():(a.poe_caps&&a.poe_caps>0||typeof a.poe_power=="number"&&a.poe_power>0||a.poe_class)&&(x="auto");let c="N/A";const h=typeof a.rx_errors=="number"?a.rx_errors:0,v=typeof a.tx_errors=="number"?a.tx_errors:0,L=h+v;L>0&&(c=L.toString());const $=a.name||a.port_name||"n/a";o.push({switchName:m,switchIp:f,port:g,speed:u,poe:x,errors:c,portName:$})}):o.push({switchName:m,switchIp:f,port:1,speed:null,poe:"N/A",errors:"N/A",portName:"DonnÃ©es non disponibles"})}),o.sort((t,m)=>t.switchName!==m.switchName?t.switchName.localeCompare(m.switchName):t.port-m.port),o.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(oe,{size:32,className:"mx-auto mb-2"}),e.jsx("p",{children:"Aucune donnÃ©e de ports disponible"}),e.jsxs("p",{className:"text-xs mt-2 text-gray-600",children:[r.length," switch(es) dÃ©tectÃ©(s) mais aucune information de ports trouvÃ©e."]}),!1]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm table-fixed",children:[e.jsx("thead",{className:"bg-[#0a1929] text-gray-300",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left font-semibold",style:{width:"20%"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex gap-0.5",children:[e.jsx("div",{className:"w-2.5 h-2.5 bg-gray-400 rounded-sm"}),e.jsx("div",{className:"w-2.5 h-2.5 bg-gray-400 rounded-sm"})]}),e.jsx("span",{children:"SWITCH"})]})}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold",style:{width:"15%"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})}),e.jsx("span",{children:"IP"})]})}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold",style:{width:"12%"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),e.jsx("span",{children:"VITESSE"})]})}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold",style:{width:"10%"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),e.jsx("span",{children:"POE"})]})}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold",style:{width:"8%"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),e.jsx("span",{children:"PORT"})]})}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold",style:{width:"10%"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("span",{children:"ERREURS"})]})}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold",style:{width:"25%"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),e.jsx("span",{children:"NOM PORT"})]})})]})}),e.jsx("tbody",{children:o.map((t,m)=>e.jsxs("tr",{className:m%2===0?"bg-[#0f1729]":"bg-[#1a1f2e]",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-cyan-400 font-semibold",children:t.switchName})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-blue-400 font-mono",children:t.switchIp})}),e.jsx("td",{className:"px-4 py-3",children:t.speed!==null?e.jsx("span",{className:"text-emerald-400",children:t.speed>=1e3?`${t.speed/1e3}G`:`${t.speed}`}):e.jsx("span",{className:"text-gray-500",children:"-"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:t.poe==="auto"||t.poe==="passthrough"||t.poe==="24v"?"text-yellow-400":t.poe==="off"||t.poe==="N/A"?"text-gray-500":"text-yellow-300",children:t.poe==="N/A"?"N/A":t.poe})}),e.jsx("td",{className:"px-4 py-3 text-white",children:t.port}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:t.errors!=="N/A"&&parseInt(t.errors)>0?"text-red-400":"text-emerald-400",children:t.errors})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-yellow-400",children:t.portName})})]},`${t.switchName}-${t.port}-${m}`))})]})})})():e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(oe,{size:32,className:"mx-auto mb-2"}),e.jsx("p",{children:"Aucune donnÃ©e disponible"})]})})}),F==="analyse"&&e.jsxs("div",{className:"col-span-full space-y-6",children:[e.jsx(We,{pluginId:"unifi",onViewDetails:void 0,hideController:!0,cardClassName:"bg-unifi-card border border-gray-800 rounded-xl",showDeviceTables:!0}),e.jsx(He,{twoColumns:!0,cardClassName:"bg-unifi-card border border-gray-800 rounded-xl"})]}),F==="clients"&&e.jsx("div",{className:"col-span-full",children:e.jsx(C,{title:"Clients",className:"bg-unifi-card border border-gray-800 rounded-xl",children:l!=null&&l.devices?(()=>{const r=l.devices.filter(s=>(s.type||"").toLowerCase()==="client");if(r.length===0)return e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(de,{size:32,className:"mx-auto mb-2"}),e.jsx("p",{children:"Aucun client dÃ©tectÃ©"}),e.jsxs("p",{className:"text-xs mt-2 text-gray-600",children:["Total devices: ",l.devices.length]})]});const o=s=>{if(!s)return 0;const p=s.split(".").map(j=>parseInt(j,10));return p.length!==4||p.some(isNaN)?0:(p[0]<<24>>>0)+(p[1]<<16)+(p[2]<<8)+p[3]},t=s=>{const p=s.tx_rate||s.rx_rate||s.phy_tx_rate||s.phy_rx_rate||s.sw_tx_rate||s.sw_rx_rate||s.current_speed||s.speed||0;return typeof p=="number"?p:0},m=s=>s.is_wired===!0?"WIRED":"WIRELESS",f=s=>{const p=typeof s.signal=="number"?s.signal:s.rssi;if(p==null||Number.isNaN(p))return{};let j;return p>=-50?j="Excellent":p>=-60?j="TrÃ¨s bon":p>=-70?j="Bon":p>=-80?j="Moyen":j="Faible",{rssi:p,quality:j}},n=s=>s.sw_mac||s.last_uplink_mac||"-",i=s=>s.ap_name||s.last_uplink_name||"n/a",a=s=>(s.sw_port||s.sw_port_idx||"-").toString(),y=Date.now()/1e3,g=s=>typeof s.is_online=="boolean"?s.is_online:typeof s.active=="boolean"?s.active:typeof s.last_seen=="number"?y-s.last_seen<300:!0,u=Z==="all"?r:r.filter(s=>{const p=s.is_wired===!0;return Z==="wired"?p:!p}),x=M==="all"?u:u.filter(s=>M==="active"?g(s):!g(s)),c=_.trim().toLowerCase(),h=c?x.filter(s=>{const p=(s.name||s.hostname||"").toString().toLowerCase(),j=(s.ip||"").toString().toLowerCase(),w=(s.mac||"").toString().toLowerCase(),k=(s.ssid||s.essid||"").toString().toLowerCase(),P=(s.ap_name||s.last_uplink_name||"").toString().toLowerCase();return p.includes(c)||j.includes(c)||w.includes(c)||k.includes(c)||P.includes(c)}):x,v=[...h].sort((s,p)=>{let j,w;switch(Y){case"ip":j=o(s.ip),w=o(p.ip);break;case"name":j=(s.name||s.hostname||"").toString().toLowerCase(),w=(p.name||p.hostname||"").toString().toLowerCase();break;case"mac":j=(s.mac||"").toString().toLowerCase(),w=(p.mac||"").toString().toLowerCase();break;case"switch":j=n(s).toLowerCase(),w=n(p).toLowerCase();break;case"port":j=parseInt(a(s),10)||0,w=parseInt(a(p),10)||0;break;case"speed":j=t(s),w=t(p);break;case"ap":j=i(s).toLowerCase(),w=i(p).toLowerCase();break;case"ssid":j=(s.ssid||s.essid||"").toString().toLowerCase(),w=(p.ssid||p.essid||"").toString().toLowerCase();break;case"type":j=m(s),w=m(p);break;default:j=0,w=0}return j<w?G==="asc"?-1:1:j>w?G==="asc"?1:-1:0}),L=s=>{Y===s?d(G==="asc"?"desc":"asc"):(re(s),d("asc"))},$=(s,p,j="left")=>e.jsxs("button",{type:"button",onClick:()=>L(p),className:`w-full flex items-center ${j==="right"?"justify-end":"justify-start"} gap-1 text-xs text-gray-300 hover:text-white`,children:[e.jsx("span",{children:s}),Y===p&&e.jsx("span",{className:"text-[10px]",children:G==="asc"?"â–²":"â–¼"})]}),U=s=>{const p=t(s);return!p||p<=0?"-":p>=1e6?`${(p/1e6).toFixed(2)} Gb/s`:p>=1e3?`${(p/1e3).toFixed(2)} Mb/s`:`${p} kb/s`},Pe=s=>{if(s==="-")return"text-gray-300";let p=0;for(let k=0;k<s.length;k++)p=(p<<5)-p+s.charCodeAt(k),p|=0;const j=["text-sky-300","text-purple-300","text-emerald-300","text-amber-300","text-pink-300","text-lime-300","text-cyan-300"],w=Math.abs(p)%j.length;return j[w]};return e.jsxs("div",{className:"overflow-auto",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 mb-2 text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:[h.length," client(s) affichÃ©(s) sur ",r.length]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-[11px] text-gray-500 mr-1",children:"Connexion:"}),["wireless","wired","all"].map(s=>e.jsx("button",{type:"button",onClick:()=>pe(s),className:`px-2 py-0.5 rounded-full border text-[11px] transition-colors ${Z===s?"bg-cyan-500/20 border-cyan-400 text-cyan-200":"bg-transparent border-gray-700 text-gray-400 hover:bg-gray-800"}`,title:s==="wireless"?"Afficher uniquement les clients sans fil":s==="wired"?"Afficher uniquement les clients filaires":"Afficher tous les clients",children:s==="wireless"?"Sans fil":s==="wired"?"Filaire":"Tous"},s))]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-[11px] text-gray-500 mr-1",children:"Ã‰tat:"}),["active","inactive","all"].map(s=>e.jsx("button",{type:"button",onClick:()=>H(s),className:`px-2 py-0.5 rounded-full border text-[11px] transition-colors ${M===s?"bg-sky-500/20 border-sky-400 text-sky-200":"bg-transparent border-gray-700 text-gray-400 hover:bg-gray-800"}`,title:s==="active"?"Afficher uniquement les clients considÃ©rÃ©s comme actifs":s==="inactive"?"Afficher uniquement les clients considÃ©rÃ©s comme inactifs":"Afficher tous les clients",children:s==="active"?"Actifs":s==="inactive"?"Inactifs":"Tous"},s))]})]}),e.jsx("input",{type:"text",value:_,onChange:s=>b(s.target.value),placeholder:"Rechercher par nom, IP, MAC, SSID, AP...",className:"bg-theme-card border border-gray-700 rounded px-2 py-1 text-[12px] text-gray-200 placeholder:text-gray-500 focus:outline-none focus:ring-1 focus:ring-sky-500 focus:border-sky-500 w-64"})]}),e.jsxs("table",{className:"min-w-[1200px] w-full text-[14px] text-gray-200",children:[e.jsx("thead",{className:"bg-theme-card text-gray-200 text-sm",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left sticky top-0 bg-theme-card",children:$("Nom","name","left")}),e.jsx("th",{className:"px-3 py-2 text-left sticky top-0 bg-theme-card",children:$("IP","ip","left")}),e.jsx("th",{className:"px-3 py-2 text-left sticky top-0 bg-theme-card",children:$("MAC","mac","left")}),e.jsx("th",{className:"px-3 py-2 text-left sticky top-0 bg-theme-card",children:$("Switch","switch","left")}),e.jsx("th",{className:"px-3 py-2 text-right sticky top-0 bg-theme-card",children:$("Vitesse","speed","right")}),e.jsx("th",{className:"px-3 py-2 text-left sticky top-0 bg-theme-card",children:$("AP","ap","left")}),e.jsx("th",{className:"px-3 py-2 text-left sticky top-0 bg-theme-card",children:$("SSID / Ports","ssid","left")}),e.jsx("th",{className:"px-3 py-2 text-left sticky top-0 bg-theme-card",children:$("Type","type","left")}),e.jsx("th",{className:"px-3 py-2 text-left sticky top-0 bg-theme-card",children:e.jsx("span",{className:"text-xs text-gray-300",children:"Signal / Port"})})]})}),e.jsx("tbody",{children:v.map((s,p)=>e.jsxs("tr",{className:p%2===0?"bg-unifi-card/30":"bg-unifi-card/20",children:[e.jsx("td",{className:"px-3 py-1.5 text-left font-semibold text-[13px] text-gray-300",children:(()=>{const j=(s.name||s.hostname||"").toString().trim();if(!j){const w=(s.ip||"").toString(),k=(s.mac||"").toString();return w||k||"-"}return j.charAt(0).toUpperCase()+j.slice(1)})()}),e.jsx("td",{className:"px-3 py-1.5 text-left text-sky-300 font-mono text-[12px]",children:s.ip||"-"}),e.jsx("td",{className:"px-3 py-1.5 text-left font-mono text-[11px]",children:s.mac||"-"}),e.jsx("td",{className:"px-3 py-1.5 text-left font-mono text-[11px] text-gray-400",children:n(s)}),e.jsx("td",{className:"px-3 py-1.5 text-right",children:U(s)}),e.jsx("td",{className:"px-3 py-1.5 text-left",children:i(s)}),e.jsx("td",{className:"px-3 py-1.5 text-left",children:(()=>{const w=(s.ssid||s.essid||"").trim()||"-",k=a(s),P=w!=="-",se=k!=="-";if(!P&&!se)return e.jsx("span",{className:"text-[11px] text-gray-500",children:"-"});const ge=Pe(w);return e.jsxs("div",{className:"flex flex-col gap-1",children:[P&&e.jsx("span",{className:`text-[11px] font-medium ${ge}`,children:w}),se&&e.jsxs("span",{className:"text-[11px] text-gray-400",children:["Port:Â ",e.jsx("span",{className:"text-gray-200",children:k})]})]})})()}),e.jsx("td",{className:"px-3 py-1.5 text-left",children:(()=>{const j=m(s),w=j==="WIRED",k=w?"bg-emerald-900/40 border-emerald-500 text-emerald-300":"bg-sky-900/40 border-sky-500 text-sky-300",P=w?"âŸ·":"ðŸ“¶";return e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full border text-[11px] ${k}`,children:[e.jsx("span",{children:P}),e.jsx("span",{children:j})]})})()}),e.jsx("td",{className:"px-3 py-1.5 text-left",children:(()=>{if(m(s)==="WIRED"){const se=t(s),ge=U(s);return!se||se<=0?e.jsx("span",{className:"text-[11px] text-gray-500",children:"Vitesse port: -"}):e.jsxs("span",{className:"text-[11px] text-gray-400",children:["Vitesse port:Â ",e.jsx("span",{className:"text-gray-200",children:ge})]})}const k=f(s);if(k.rssi==null)return e.jsx("span",{className:"text-[11px] text-gray-500",children:"RSSI: -"});let P="bg-red-500";return k.rssi>=-60?P="bg-emerald-400":k.rssi>=-70?P="bg-amber-400":k.rssi>=-80&&(P="bg-orange-500"),e.jsxs("span",{className:"text-[11px] text-gray-400 flex items-center gap-1",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${P}`}),e.jsxs("span",{children:["RSSI:Â ",e.jsxs("span",{className:"text-gray-200",children:[k.rssi," dBm"]}),k.quality&&e.jsxs("span",{className:"ml-1 text-gray-500",children:["(",k.quality,")"]})]})]})})()})]},s.id||s.mac||p))})]})]})})():e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(de,{size:32,className:"mx-auto mb-2"}),e.jsx("p",{children:"Aucune donnÃ©e disponible"})]})})}),F==="traffic"&&e.jsx("div",{className:"col-span-full",children:e.jsx(C,{title:"Trafic RÃ©seau (UniFi)",className:"bg-unifi-card border border-gray-800 rounded-xl",children:l!=null&&l.devices?(()=>{const r=l.devices,o=r.filter(c=>(c.type||"").toLowerCase()==="client");r.filter(c=>(c.type||"").toLowerCase()!=="client");const t=c=>{const h=c.tx_rate||c.rx_rate||c.phy_tx_rate||c.phy_rx_rate||c.sw_tx_rate||c.sw_rx_rate||c.current_speed||c.speed||0;return typeof h=="number"?h:0},m=c=>{if(!c||c<=0)return"-";const h=c/1e3,v=c/1e6,L=c/1e9;return L>=1?`${L.toFixed(2)} Gb/s`:v>=1?`${v.toFixed(2)} Mb/s`:h>=1?`${h.toFixed(0)} kb/s`:`${c.toFixed(0)} b/s`},f=c=>{const h=t(c);return!h||h<=0?"-":h>=1e6?`${(h/1e6).toFixed(2)} Gb/s`:h>=1e3?`${(h/1e3).toFixed(2)} Mb/s`:`${h} kb/s`},n=c=>(c.ap_name||c.last_uplink_name||"").toString(),i=c=>{const h=typeof c.signal=="number"?c.signal:c.rssi;if(h==null||Number.isNaN(h))return{};let v;return h>=-50?v="Excellent":h>=-60?v="TrÃ¨s bon":h>=-70?v="Bon":h>=-80?v="Moyen":v="Faible",{rssi:h,quality:v}},a=[...o].sort((c,h)=>t(h)-t(c)),y=ue?a:a.slice(0,16),g=new Map;for(const c of o){const h=t(c);if(!h||h<=0)continue;const L=n(c)||"Inconnu",$=g.get(L)||{down:0,up:0,ref:null};$.down+=h,$.ref=$.ref||c,g.set(L,$)}const u=Array.from(g.entries()).sort((c,h)=>h[1].down-c[1].down).slice(0,8),x=o.length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-unifi-card rounded-xl px-4 py-3 border border-gray-800 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"DÃ©bit WAN actuel"}),e.jsx(ae,{size:16,className:"text-sky-400"})]}),e.jsxs("div",{className:"mt-1 space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Descendant:"}),e.jsx("span",{className:"text-sky-300 font-semibold",children:m(B==null?void 0:B.downBps)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Montant:"}),e.jsx("span",{className:"text-emerald-300 font-semibold",children:m(B==null?void 0:B.upBps)})]}),e.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Estimation basÃ©e sur les compteurs WAN cumulÃ©s UniFi (pas encore historique Prometheus / Influx)."})]})]}),e.jsxs("div",{className:"bg-unifi-card rounded-xl px-4 py-3 border border-gray-800 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"Clients actifs (UniFi)"}),e.jsx(de,{size:16,className:"text-purple-400"})]}),e.jsx("div",{className:"mt-1 text-3xl font-semibold text-white",children:x}),e.jsxs("p",{className:"text-[11px] text-gray-500",children:['Nombre de clients vus comme "clients" par le contrÃ´leur UniFi (type ',e.jsx("code",{className:"text-[10px]",children:"client"}),")."]})]}),e.jsxs("div",{className:"bg-unifi-card rounded-xl px-4 py-3 border border-gray-800 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"Sources principales"}),e.jsx(xe,{size:16,className:"text-amber-400"})]}),e.jsxs("div",{className:"mt-1 space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"AP / Switch suivis:"}),e.jsx("span",{className:"text-gray-200 font-semibold",children:u.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Top clients listÃ©s:"}),e.jsx("span",{className:"text-gray-200 font-semibold",children:y.length})]}),e.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"BasÃ© sur les vitesses instantanÃ©es des clients (tx/rx_rate)."})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-unifi-card rounded-xl px-4 py-3 border border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h3",{className:"text-sm font-semibold text-white",children:"Clients par dÃ©bit"}),e.jsx("span",{className:"text-[11px] text-gray-500",children:"TriÃ©s par vitesse instantanÃ©e"})]}),e.jsx("button",{type:"button",onClick:()=>ze(!ue),className:"px-3 py-1 rounded-full border border-gray-700 text-[11px] text-gray-200 hover:bg-gray-800 transition-colors",children:ue?"Afficher top 16":"Voir tous les clients"})]}),y.length===0?e.jsx("p",{className:"text-xs text-gray-500",children:"Aucun client avec dÃ©bit mesurable pour le moment."}):e.jsxs("table",{className:"min-w-full text-[12px] text-gray-200",children:[e.jsx("thead",{className:"bg-theme-card text-gray-300 text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-1 text-left",children:"Nom"}),e.jsx("th",{className:"px-2 py-1 text-left",children:"IP"}),e.jsx("th",{className:"px-2 py-1 text-left",children:"AP"}),e.jsx("th",{className:"px-2 py-1 text-right",children:"Vitesse"}),e.jsx("th",{className:"px-2 py-1 text-left",children:"Signal"})]})}),e.jsx("tbody",{children:y.map((c,h)=>e.jsxs("tr",{className:h%2===0?"bg-unifi-card/30":"bg-unifi-card/20",children:[e.jsx("td",{className:"px-2 py-1 text-left text-sm font-medium text-gray-200",children:(c.name||c.hostname||c.ip||c.mac||"-").toString()}),e.jsx("td",{className:"px-2 py-1 text-left text-xs font-mono text-sky-300",children:c.ip||"-"}),e.jsx("td",{className:"px-2 py-1 text-left text-xs text-gray-400",children:n(c)||"-"}),e.jsx("td",{className:"px-2 py-1 text-right text-xs font-mono",children:f(c)}),e.jsx("td",{className:"px-2 py-1 text-left text-xs text-gray-400",children:(()=>{const v=i(c);if(v.rssi==null)return"RSSI: -";let L="bg-red-500";return v.rssi>=-60?L="bg-emerald-400":v.rssi>=-70?L="bg-amber-400":v.rssi>=-80&&(L="bg-orange-500"),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${L}`}),e.jsxs("span",{children:["RSSI:Â ",e.jsxs("span",{className:"text-gray-200",children:[v.rssi," dBm"]}),v.quality&&e.jsxs("span",{className:"ml-1 text-gray-500",children:["(",v.quality,")"]})]})]})})()})]},c.id||c.mac||h))})]})]}),e.jsxs("div",{className:"bg-unifi-card rounded-xl px-4 py-3 border border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-white",children:"Trafic par AP / Switch"}),e.jsx("span",{className:"text-[11px] text-gray-500",children:"AgrÃ©gÃ© Ã  partir des clients"})]}),u.length===0?e.jsx("p",{className:"text-xs text-gray-500",children:"Aucun trafic client mesurable pour le moment."}):e.jsxs("table",{className:"min-w-full text-[12px] text-gray-200",children:[e.jsx("thead",{className:"bg-theme-card text-gray-300 text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-1 text-left",children:"AP / Switch"}),e.jsx("th",{className:"px-2 py-1 text-right",children:"DÃ©bit total"})]})}),e.jsx("tbody",{children:u.map(([c,h],v)=>e.jsxs("tr",{className:v%2===0?"bg-unifi-card/30":"bg-unifi-card/20",children:[e.jsx("td",{className:"px-2 py-1 text-left text-sm font-medium text-gray-200",children:c}),e.jsxs("td",{className:"px-2 py-1 text-right text-xs font-mono",children:[m(h.down*1e3)," "]})]},c))})]})]})]})]})})():e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(ae,{size:32,className:"mx-auto mb-2"}),e.jsx("p",{children:"Aucune donnÃ©e de trafic disponible"})]})})}),F==="events"&&e.jsx("div",{className:"col-span-full",children:e.jsx(C,{title:"Ã‰vÃ©nements UniFi",className:"bg-unifi-card border border-gray-800 rounded-xl",children:l!=null&&l.devices?(()=>{const r=l.devices,o=r.filter(x=>(x.type||"").toLowerCase()!=="client"),t=r.filter(x=>(x.type||"").toLowerCase()==="client"),m=l.system||{},f=[],n=new Date,i=o.filter(x=>x.active===!1);i.length>0&&f.push({id:"offline-devices",category:"alert",level:"warning",title:"Ã‰quipements hors ligne",message:`${i.length} Ã©quipement(s) UniFi sont signalÃ©s comme hors ligne.`,time:n}),m.updateAvailable===!0&&f.push({id:"controller-update",category:"alert",level:"warning",title:"Mise Ã  jour du contrÃ´leur disponible",message:`Version actuelle: ${m.version||"inconnue"}. Une nouvelle version est disponible.`,time:n}),(m.unsupportedDeviceCount||0)>0&&f.push({id:"unsupported-devices",category:"alert",level:"critical",title:"Appareils non supportÃ©s dÃ©tectÃ©s",message:`${m.unsupportedDeviceCount} appareil(s) UniFi signalÃ©(s) comme non supportÃ©s.`,time:n}),f.push({id:"controller-ok",category:"system",level:"info",title:"ContrÃ´leur UniFi opÃ©rationnel",message:`ContrÃ´leur ${m.name||"UniFi"} en ligne (hostname: ${m.hostname||"inconnu"}).`,time:n}),t.length>0&&f.push({id:"clients-count",category:"connection",level:"info",title:"Clients connectÃ©s",message:`${t.length} client(s) UniFi sont actuellement suivis comme "clients".`,time:n});const a=f.filter(x=>W==="all"?!0:W==="alerts"?x.category==="alert":W==="system"?x.category==="system":W==="connections"?x.category==="connection":!0),y=x=>x.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),g=x=>x==="critical"?"bg-red-600/20 border-red-500 text-red-300 shadow-[0_0_12px_rgba(248,113,113,0.35)]":x==="warning"?"bg-amber-500/15 border-amber-400 text-amber-200":"bg-sky-500/15 border-sky-400 text-sky-200",u=x=>x==="alert"?"Alerte":x==="system"?"SystÃ¨me":"Connexion";return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 text-xs mb-2",children:[e.jsxs("span",{className:"text-gray-500",children:[a.length," Ã©vÃ©nement(s) affichÃ©(s) sur ",f.length]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-[11px] text-gray-500 mr-1",children:"Type:"}),["alerts","system","connections","all"].map(x=>{const c=W===x;let h="bg-sky-500/20 border-sky-400 text-sky-200";return x==="alerts"?h="bg-amber-500/20 border-amber-400 text-amber-100":x==="system"?h="bg-sky-500/20 border-sky-400 text-sky-200":x==="connections"?h="bg-emerald-500/20 border-emerald-400 text-emerald-100":x==="all"&&(h="bg-purple-500/20 border-purple-400 text-purple-100"),e.jsx("button",{type:"button",onClick:()=>V(x),className:`px-2 py-0.5 rounded-full border text-[11px] transition-colors ${c?h:"bg-transparent border-gray-700 text-gray-400 hover:bg-gray-800"}`,children:x==="alerts"?"Alertes":x==="system"?"SystÃ¨me":x==="connections"?"Connexions":"Tous"},x)})]})]}),f.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(E,{size:32,className:"mx-auto mb-2"}),e.jsx("p",{children:"Aucun Ã©vÃ©nement nâ€™a Ã©tÃ© dÃ©tectÃ© pour lâ€™instant."})]}):a.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500 text-xs",children:"Aucun Ã©vÃ©nement pour ce filtre. Essayez un autre type (Alertes, SystÃ¨me, Connexions ou Tous)."}):e.jsx("div",{className:"divide-y divide-gray-800 border border-gray-800 rounded-lg bg-theme-card",children:a.map(x=>e.jsxs("div",{className:"px-4 py-3 flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:`mt-1 inline-flex items-center justify-center w-6 h-6 rounded-full border text-[10px] ${g(x.level)}`,children:x.level==="critical"||x.level==="warning"?"!":"i"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-semibold text-white",children:x.title}),e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-gray-900 border border-gray-700 text-gray-300",children:u(x.category)})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:x.message})]})]}),e.jsx("div",{className:"text-[11px] text-gray-500 whitespace-nowrap ml-2",children:y(x.time)})]},x.id))})]})})():e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(E,{size:32,className:"mx-auto mb-2"}),e.jsx("p",{children:"Aucune donnÃ©e UniFi disponible pour gÃ©nÃ©rer des Ã©vÃ©nements."})]})})}),F==="debug"&&e.jsxs("div",{className:"col-span-full space-y-6",children:[e.jsx(C,{title:"Informations du Plugin",className:"bg-unifi-card border border-gray-800 rounded-xl",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Plugin ID:"}),e.jsx("span",{className:"text-sm text-white font-mono",children:N.id})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Nom:"}),e.jsx("span",{className:"text-sm text-white",children:N.name})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Version:"}),e.jsx("span",{className:"text-sm text-white",children:N.version})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"ActivÃ©:"}),e.jsx("span",{className:`text-sm ${N.enabled?"text-green-400":"text-red-400"}`,children:N.enabled?"Oui":"Non"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"ConnectÃ©:"}),e.jsx("span",{className:`text-sm ${N.connectionStatus?"text-green-400":"text-red-400"}`,children:N.connectionStatus?"Oui":"Non"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"isActive:"}),e.jsx("span",{className:`text-sm ${D?"text-green-400":"text-red-400"}`,children:D?"Oui":"Non"})]})]})}),e.jsx(C,{title:"Configuration",className:"bg-unifi-card border border-gray-800 rounded-xl",children:e.jsx("pre",{className:"text-xs bg-unifi-card/50 p-4 rounded-lg overflow-auto max-h-96 text-gray-300",children:JSON.stringify(N.settings,null,2)})}),e.jsx(C,{title:"Stats Brutes (pluginStats['unifi'])",className:"bg-unifi-card border border-gray-800 rounded-xl",children:l?e.jsx("pre",{className:"text-xs bg-[#050505] p-4 rounded-lg overflow-auto max-h-96 text-gray-300",children:JSON.stringify(l,null,2)}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(E,{size:32,className:"mx-auto mb-2"}),e.jsx("p",{children:"Aucune donnÃ©e de stats disponible"}),e.jsx("p",{className:"text-xs mt-2 text-gray-600",children:"Les stats sont rÃ©cupÃ©rÃ©es automatiquement toutes les 30 secondes si le plugin est actif."}),e.jsxs("div",{className:"mt-4 text-left text-xs bg-[#050505] p-3 rounded-lg",children:[e.jsx("p",{className:"text-gray-400 mb-2",children:"Debug Info:"}),e.jsxs("p",{className:"text-gray-500",children:["Plugin enabled: ",N!=null&&N.enabled?"Oui":"Non"]}),e.jsxs("p",{className:"text-gray-500",children:["Connection status: ",N!=null&&N.connectionStatus?"Oui":"Non"]}),e.jsxs("p",{className:"text-gray-500",children:["isActive: ",D?"Oui":"Non"]}),e.jsxs("p",{className:"text-gray-500",children:["pluginStats keys: ",Object.keys(R).join(", ")]}),e.jsxs("p",{className:"text-gray-500",children:["unifiStats type: ",typeof l]})]})]})}),(l==null?void 0:l.devices)&&e.jsx(C,{title:"Analyse des Devices",className:"bg-unifi-card border border-gray-800 rounded-xl",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Nombre total de devices:"}),e.jsx("span",{className:"ml-2 text-white font-semibold",children:l.devices.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Types uniques:"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:Array.from(new Set(l.devices.map(r=>r.type||"unknown"))).map(r=>e.jsxs("span",{className:"px-2 py-1 bg-[#050505] rounded text-xs text-gray-300",children:[r," (",l.devices.filter(o=>(o.type||"unknown")===r).length,")"]},r))})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-400",children:"ModÃ¨les uniques:"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:Array.from(new Set(l.devices.map(r=>r.model||"unknown").filter(r=>r!=="unknown"))).map(r=>e.jsxs("span",{className:"px-2 py-1 bg-[#050505] rounded text-xs text-gray-300",children:[r," (",l.devices.filter(o=>(o.model||"unknown")===r).length,")"]},r))})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Devices actifs:"}),e.jsx("span",{className:"ml-2 text-white font-semibold",children:l.devices.filter(r=>r.active!==!1).length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-400",children:"RÃ©sumÃ© Firmware (par version):"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:(()=>{const r=new Map;for(const t of l.devices){if((t.type||"").toString().toLowerCase()==="client")continue;const f=t.firmware_version||t.version||t.firmware||t.cfgversion||t.stable_version,n=f!=null?String(f).trim():"";!n||n==="undefined"||n==="null"||r.set(n,(r.get(n)||0)+1)}const o=Array.from(r.entries());return o.length===0?e.jsxs("span",{className:"text-xs text-gray-500",children:["Aucune information de firmware dÃ©tectÃ©e dans les devices (vÃ©rifiez les champs",e.jsx("code",{className:"ml-1",children:"version"}),", ",e.jsx("code",{children:"firmware"})," ou ",e.jsx("code",{children:"firmware_version"})," dans les stats brutes)."]}):o.map(([t,m])=>e.jsxs("span",{className:"px-2 py-1 bg-[#1a1a1a] rounded text-xs text-gray-200",children:["v",t," (",m,")"]},t))})()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Exemple de device (premier):"}),l.devices.length>0&&e.jsx("pre",{className:"text-xs bg-[#1a1a1a] p-4 rounded-lg overflow-auto max-h-64 text-gray-300 mt-2",children:JSON.stringify(l.devices[0],null,2)})]})]})}),(l==null?void 0:l.network)&&e.jsx(C,{title:"Analyse des Stats RÃ©seau",className:"bg-unifi-card border border-gray-800 rounded-xl",children:e.jsx("pre",{className:"text-xs bg-unifi-card/50 p-4 rounded-lg overflow-auto max-h-64 text-gray-300",children:JSON.stringify(l.network,null,2)})}),(l==null?void 0:l.system)&&e.jsx(C,{title:"Analyse des Stats SystÃ¨me",className:"bg-unifi-card border border-gray-800 rounded-xl",children:e.jsx("pre",{className:"text-xs bg-unifi-card/50 p-4 rounded-lg overflow-auto max-h-64 text-gray-300",children:JSON.stringify(l.system,null,2)})}),e.jsx(C,{title:"Actions de Debug",className:"bg-unifi-card border border-gray-800 rounded-xl",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:Me,disabled:X,className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:opacity-50 text-white rounded-lg transition-colors flex items-center justify-center gap-2",children:[e.jsx(qe,{size:16,className:X?"animate-spin":""}),"Forcer le rafraÃ®chissement des stats"]}),e.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[e.jsx("p",{children:"â€¢ Le polling automatique se fait toutes les 30 secondes si le plugin est actif"}),e.jsx("p",{children:"â€¢ VÃ©rifiez la console du navigateur (F12) pour les erreurs rÃ©seau"}),e.jsx("p",{children:"â€¢ VÃ©rifiez les logs du serveur backend pour les erreurs API"})]})]})})]})]})]})}):e.jsx("div",{className:"text-gray-300",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:A,className:"p-2 hover:bg-[#1a1a1a] rounded transition-colors",children:e.jsx(fe,{size:20})}),e.jsx("h1",{className:"text-2xl font-semibold",children:"UniFi Controller"})]}),e.jsx(C,{title:"Plugin UniFi non connectÃ©",className:"bg-unifi-card border border-gray-800 rounded-xl",children:e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(ie,{size:32,className:"mx-auto mb-2 text-yellow-400"}),e.jsx("p",{className:"mb-2",children:"Le plugin UniFi n'est pas activÃ© ou connectÃ©."}),e.jsx("p",{className:"text-sm text-gray-600",children:'Activez et configurez le plugin depuis la page "Plugins".'})]})})]})}):e.jsx("div",{className:"text-gray-300",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:A,className:"p-2 hover:bg-[#1a1a1a] rounded transition-colors",children:e.jsx(fe,{size:20})}),e.jsx("h1",{className:"text-2xl font-semibold",children:"UniFi Controller"})]}),e.jsx(C,{title:"Plugin UniFi non disponible",className:"bg-unifi-card border border-gray-800 rounded-xl",children:e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(E,{size:32,className:"mx-auto mb-2"}),e.jsx("p",{children:"Le plugin UniFi n'est pas installÃ© ou configurÃ©."})]})})]})})};export{Ze as UniFiPage};
